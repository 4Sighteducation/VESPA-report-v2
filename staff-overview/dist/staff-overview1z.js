(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const l of r.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&o(l)}).observe(document,{childList:!0,subtree:!0});function s(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=s(n);fetch(n.href,r)}})();/**
* @vue/shared v3.5.24
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function fo(e){const t=Object.create(null);for(const s of e.split(","))t[s]=1;return s=>s in t}const Ie={},cs=[],Ct=()=>{},ga=()=>!1,mn=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97),vo=e=>e.startsWith("onUpdate:"),Ge=Object.assign,po=(e,t)=>{const s=e.indexOf(t);s>-1&&e.splice(s,1)},Gr=Object.prototype.hasOwnProperty,xe=(e,t)=>Gr.call(e,t),se=Array.isArray,us=e=>Ls(e)==="[object Map]",hn=e=>Ls(e)==="[object Set]",Fo=e=>Ls(e)==="[object Date]",ce=e=>typeof e=="function",je=e=>typeof e=="string",xt=e=>typeof e=="symbol",$e=e=>e!==null&&typeof e=="object",ya=e=>($e(e)||ce(e))&&ce(e.then)&&ce(e.catch),ba=Object.prototype.toString,Ls=e=>ba.call(e),Yr=e=>Ls(e).slice(8,-1),_a=e=>Ls(e)==="[object Object]",mo=e=>je(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Ss=fo(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),gn=e=>{const t=Object.create(null);return s=>t[s]||(t[s]=e(s))},Wr=/-\w/g,Kt=gn(e=>e.replace(Wr,t=>t.slice(1).toUpperCase())),zr=/\B([A-Z])/g,ss=gn(e=>e.replace(zr,"-$1").toLowerCase()),wa=gn(e=>e.charAt(0).toUpperCase()+e.slice(1)),Hn=gn(e=>e?`on${wa(e)}`:""),Vt=(e,t)=>!Object.is(e,t),Js=(e,...t)=>{for(let s=0;s<e.length;s++)e[s](...t)},ka=(e,t,s,o=!1)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:o,value:s})},yn=e=>{const t=parseFloat(e);return isNaN(t)?e:t},Jr=e=>{const t=je(e)?Number(e):NaN;return isNaN(t)?e:t};let Uo;const bn=()=>Uo||(Uo=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ht(e){if(se(e)){const t={};for(let s=0;s<e.length;s++){const o=e[s],n=je(o)?ei(o):ht(o);if(n)for(const r in n)t[r]=n[r]}return t}else if(je(e)||$e(e))return e}const Xr=/;(?![^(]*\))/g,Qr=/:([^]+)/,Zr=/\/\*[^]*?\*\//g;function ei(e){const t={};return e.replace(Zr,"").split(Xr).forEach(s=>{if(s){const o=s.split(Qr);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function ne(e){let t="";if(je(e))t=e;else if(se(e))for(let s=0;s<e.length;s++){const o=ne(e[s]);o&&(t+=o+" ")}else if($e(e))for(const s in e)e[s]&&(t+=s+" ");return t.trim()}const ti="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",si=fo(ti);function Sa(e){return!!e||e===""}function ni(e,t){if(e.length!==t.length)return!1;let s=!0;for(let o=0;s&&o<e.length;o++)s=_n(e[o],t[o]);return s}function _n(e,t){if(e===t)return!0;let s=Fo(e),o=Fo(t);if(s||o)return s&&o?e.getTime()===t.getTime():!1;if(s=xt(e),o=xt(t),s||o)return e===t;if(s=se(e),o=se(t),s||o)return s&&o?ni(e,t):!1;if(s=$e(e),o=$e(t),s||o){if(!s||!o)return!1;const n=Object.keys(e).length,r=Object.keys(t).length;if(n!==r)return!1;for(const l in e){const c=e.hasOwnProperty(l),u=t.hasOwnProperty(l);if(c&&!u||!c&&u||!_n(e[l],t[l]))return!1}}return String(e)===String(t)}function oi(e,t){return e.findIndex(s=>_n(s,t))}const Ca=e=>!!(e&&e.__v_isRef===!0),S=e=>je(e)?e:e==null?"":se(e)||$e(e)&&(e.toString===ba||!ce(e.toString))?Ca(e)?S(e.value):JSON.stringify(e,xa,2):String(e),xa=(e,t)=>Ca(t)?xa(e,t.value):us(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((s,[o,n],r)=>(s[Bn(o,r)+" =>"]=n,s),{})}:hn(t)?{[`Set(${t.size})`]:[...t.values()].map(s=>Bn(s))}:xt(t)?Bn(t):$e(t)&&!se(t)&&!_a(t)?String(t):t,Bn=(e,t="")=>{var s;return xt(e)?`Symbol(${(s=e.description)!=null?s:t})`:e};/**
* @vue/reactivity v3.5.24
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let ot;class ai{constructor(t=!1){this.detached=t,this._active=!0,this._on=0,this.effects=[],this.cleanups=[],this._isPaused=!1,this.parent=ot,!t&&ot&&(this.index=(ot.scopes||(ot.scopes=[])).push(this)-1)}get active(){return this._active}pause(){if(this._active){this._isPaused=!0;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].pause();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].pause()}}resume(){if(this._active&&this._isPaused){this._isPaused=!1;let t,s;if(this.scopes)for(t=0,s=this.scopes.length;t<s;t++)this.scopes[t].resume();for(t=0,s=this.effects.length;t<s;t++)this.effects[t].resume()}}run(t){if(this._active){const s=ot;try{return ot=this,t()}finally{ot=s}}}on(){++this._on===1&&(this.prevScope=ot,ot=this)}off(){this._on>0&&--this._on===0&&(ot=this.prevScope,this.prevScope=void 0)}stop(t){if(this._active){this._active=!1;let s,o;for(s=0,o=this.effects.length;s<o;s++)this.effects[s].stop();for(this.effects.length=0,s=0,o=this.cleanups.length;s<o;s++)this.cleanups[s]();if(this.cleanups.length=0,this.scopes){for(s=0,o=this.scopes.length;s<o;s++)this.scopes[s].stop(!0);this.scopes.length=0}if(!this.detached&&this.parent&&!t){const n=this.parent.scopes.pop();n&&n!==this&&(this.parent.scopes[this.index]=n,n.index=this.index)}this.parent=void 0}}}function ri(){return ot}let Oe;const Vn=new WeakSet;class Ea{constructor(t){this.fn=t,this.deps=void 0,this.depsTail=void 0,this.flags=5,this.next=void 0,this.cleanup=void 0,this.scheduler=void 0,ot&&ot.active&&ot.effects.push(this)}pause(){this.flags|=64}resume(){this.flags&64&&(this.flags&=-65,Vn.has(this)&&(Vn.delete(this),this.trigger()))}notify(){this.flags&2&&!(this.flags&32)||this.flags&8||$a(this)}run(){if(!(this.flags&1))return this.fn();this.flags|=2,Mo(this),Ta(this);const t=Oe,s=gt;Oe=this,gt=!0;try{return this.fn()}finally{Ia(this),Oe=t,gt=s,this.flags&=-3}}stop(){if(this.flags&1){for(let t=this.deps;t;t=t.nextDep)yo(t);this.deps=this.depsTail=void 0,Mo(this),this.onStop&&this.onStop(),this.flags&=-2}}trigger(){this.flags&64?Vn.add(this):this.scheduler?this.scheduler():this.runIfDirty()}runIfDirty(){Zn(this)&&this.run()}get dirty(){return Zn(this)}}let Aa=0,Cs,xs;function $a(e,t=!1){if(e.flags|=8,t){e.next=xs,xs=e;return}e.next=Cs,Cs=e}function ho(){Aa++}function go(){if(--Aa>0)return;if(xs){let t=xs;for(xs=void 0;t;){const s=t.next;t.next=void 0,t.flags&=-9,t=s}}let e;for(;Cs;){let t=Cs;for(Cs=void 0;t;){const s=t.next;if(t.next=void 0,t.flags&=-9,t.flags&1)try{t.trigger()}catch(o){e||(e=o)}t=s}}if(e)throw e}function Ta(e){for(let t=e.deps;t;t=t.nextDep)t.version=-1,t.prevActiveLink=t.dep.activeLink,t.dep.activeLink=t}function Ia(e){let t,s=e.depsTail,o=s;for(;o;){const n=o.prevDep;o.version===-1?(o===s&&(s=n),yo(o),ii(o)):t=o,o.dep.activeLink=o.prevActiveLink,o.prevActiveLink=void 0,o=n}e.deps=t,e.depsTail=s}function Zn(e){for(let t=e.deps;t;t=t.nextDep)if(t.dep.version!==t.version||t.dep.computed&&(Oa(t.dep.computed)||t.dep.version!==t.version))return!0;return!!e._dirty}function Oa(e){if(e.flags&4&&!(e.flags&16)||(e.flags&=-17,e.globalVersion===Is)||(e.globalVersion=Is,!e.isSSR&&e.flags&128&&(!e.deps&&!e._dirty||!Zn(e))))return;e.flags|=2;const t=e.dep,s=Oe,o=gt;Oe=e,gt=!0;try{Ta(e);const n=e.fn(e._value);(t.version===0||Vt(n,e._value))&&(e.flags|=128,e._value=n,t.version++)}catch(n){throw t.version++,n}finally{Oe=s,gt=o,Ia(e),e.flags&=-3}}function yo(e,t=!1){const{dep:s,prevSub:o,nextSub:n}=e;if(o&&(o.nextSub=n,e.prevSub=void 0),n&&(n.prevSub=o,e.nextSub=void 0),s.subs===e&&(s.subs=o,!o&&s.computed)){s.computed.flags&=-5;for(let r=s.computed.deps;r;r=r.nextDep)yo(r,!0)}!t&&!--s.sc&&s.map&&s.map.delete(s.key)}function ii(e){const{prevDep:t,nextDep:s}=e;t&&(t.nextDep=s,e.prevDep=void 0),s&&(s.prevDep=t,e.nextDep=void 0)}let gt=!0;const Pa=[];function Nt(){Pa.push(gt),gt=!1}function Rt(){const e=Pa.pop();gt=e===void 0?!0:e}function Mo(e){const{cleanup:t}=e;if(e.cleanup=void 0,t){const s=Oe;Oe=void 0;try{t()}finally{Oe=s}}}let Is=0;class li{constructor(t,s){this.sub=t,this.dep=s,this.version=s.version,this.nextDep=this.prevDep=this.nextSub=this.prevSub=this.prevActiveLink=void 0}}class bo{constructor(t){this.computed=t,this.version=0,this.activeLink=void 0,this.subs=void 0,this.map=void 0,this.key=void 0,this.sc=0,this.__v_skip=!0}track(t){if(!Oe||!gt||Oe===this.computed)return;let s=this.activeLink;if(s===void 0||s.sub!==Oe)s=this.activeLink=new li(Oe,this),Oe.deps?(s.prevDep=Oe.depsTail,Oe.depsTail.nextDep=s,Oe.depsTail=s):Oe.deps=Oe.depsTail=s,Fa(s);else if(s.version===-1&&(s.version=this.version,s.nextDep)){const o=s.nextDep;o.prevDep=s.prevDep,s.prevDep&&(s.prevDep.nextDep=o),s.prevDep=Oe.depsTail,s.nextDep=void 0,Oe.depsTail.nextDep=s,Oe.depsTail=s,Oe.deps===s&&(Oe.deps=o)}return s}trigger(t){this.version++,Is++,this.notify(t)}notify(t){ho();try{for(let s=this.subs;s;s=s.prevSub)s.sub.notify()&&s.sub.dep.notify()}finally{go()}}}function Fa(e){if(e.dep.sc++,e.sub.flags&4){const t=e.dep.computed;if(t&&!e.dep.subs){t.flags|=20;for(let o=t.deps;o;o=o.nextDep)Fa(o)}const s=e.dep.subs;s!==e&&(e.prevSub=s,s&&(s.nextSub=e)),e.dep.subs=e}}const eo=new WeakMap,ts=Symbol(""),to=Symbol(""),Os=Symbol("");function We(e,t,s){if(gt&&Oe){let o=eo.get(e);o||eo.set(e,o=new Map);let n=o.get(s);n||(o.set(s,n=new bo),n.map=o,n.key=s),n.track()}}function Ft(e,t,s,o,n,r){const l=eo.get(e);if(!l){Is++;return}const c=u=>{u&&u.trigger()};if(ho(),t==="clear")l.forEach(c);else{const u=se(e),f=u&&mo(s);if(u&&s==="length"){const d=Number(o);l.forEach((w,A)=>{(A==="length"||A===Os||!xt(A)&&A>=d)&&c(w)})}else switch((s!==void 0||l.has(void 0))&&c(l.get(s)),f&&c(l.get(Os)),t){case"add":u?f&&c(l.get("length")):(c(l.get(ts)),us(e)&&c(l.get(to)));break;case"delete":u||(c(l.get(ts)),us(e)&&c(l.get(to)));break;case"set":us(e)&&c(l.get(ts));break}}go()}function rs(e){const t=we(e);return t===e?t:(We(t,"iterate",Os),pt(e)?t:t.map(Ke))}function wn(e){return We(e=we(e),"iterate",Os),e}const ci={__proto__:null,[Symbol.iterator](){return Kn(this,Symbol.iterator,Ke)},concat(...e){return rs(this).concat(...e.map(t=>se(t)?rs(t):t))},entries(){return Kn(this,"entries",e=>(e[1]=Ke(e[1]),e))},every(e,t){return Tt(this,"every",e,t,void 0,arguments)},filter(e,t){return Tt(this,"filter",e,t,s=>s.map(Ke),arguments)},find(e,t){return Tt(this,"find",e,t,Ke,arguments)},findIndex(e,t){return Tt(this,"findIndex",e,t,void 0,arguments)},findLast(e,t){return Tt(this,"findLast",e,t,Ke,arguments)},findLastIndex(e,t){return Tt(this,"findLastIndex",e,t,void 0,arguments)},forEach(e,t){return Tt(this,"forEach",e,t,void 0,arguments)},includes(...e){return Gn(this,"includes",e)},indexOf(...e){return Gn(this,"indexOf",e)},join(e){return rs(this).join(e)},lastIndexOf(...e){return Gn(this,"lastIndexOf",e)},map(e,t){return Tt(this,"map",e,t,void 0,arguments)},pop(){return bs(this,"pop")},push(...e){return bs(this,"push",e)},reduce(e,...t){return No(this,"reduce",e,t)},reduceRight(e,...t){return No(this,"reduceRight",e,t)},shift(){return bs(this,"shift")},some(e,t){return Tt(this,"some",e,t,void 0,arguments)},splice(...e){return bs(this,"splice",e)},toReversed(){return rs(this).toReversed()},toSorted(e){return rs(this).toSorted(e)},toSpliced(...e){return rs(this).toSpliced(...e)},unshift(...e){return bs(this,"unshift",e)},values(){return Kn(this,"values",Ke)}};function Kn(e,t,s){const o=wn(e),n=o[t]();return o!==e&&!pt(e)&&(n._next=n.next,n.next=()=>{const r=n._next();return r.done||(r.value=s(r.value)),r}),n}const ui=Array.prototype;function Tt(e,t,s,o,n,r){const l=wn(e),c=l!==e&&!pt(e),u=l[t];if(u!==ui[t]){const w=u.apply(e,r);return c?Ke(w):w}let f=s;l!==e&&(c?f=function(w,A){return s.call(this,Ke(w),A,e)}:s.length>2&&(f=function(w,A){return s.call(this,w,A,e)}));const d=u.call(l,f,o);return c&&n?n(d):d}function No(e,t,s,o){const n=wn(e);let r=s;return n!==e&&(pt(e)?s.length>3&&(r=function(l,c,u){return s.call(this,l,c,u,e)}):r=function(l,c,u){return s.call(this,l,Ke(c),u,e)}),n[t](r,...o)}function Gn(e,t,s){const o=we(e);We(o,"iterate",Os);const n=o[t](...s);return(n===-1||n===!1)&&ko(s[0])?(s[0]=we(s[0]),o[t](...s)):n}function bs(e,t,s=[]){Nt(),ho();const o=we(e)[t].apply(e,s);return go(),Rt(),o}const di=fo("__proto__,__v_isRef,__isVue"),Ua=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(xt));function fi(e){xt(e)||(e=String(e));const t=we(this);return We(t,"has",e),t.hasOwnProperty(e)}class Ma{constructor(t=!1,s=!1){this._isReadonly=t,this._isShallow=s}get(t,s,o){if(s==="__v_skip")return t.__v_skip;const n=this._isReadonly,r=this._isShallow;if(s==="__v_isReactive")return!n;if(s==="__v_isReadonly")return n;if(s==="__v_isShallow")return r;if(s==="__v_raw")return o===(n?r?ki:ja:r?La:Ra).get(t)||Object.getPrototypeOf(t)===Object.getPrototypeOf(o)?t:void 0;const l=se(t);if(!n){let u;if(l&&(u=ci[s]))return u;if(s==="hasOwnProperty")return fi}const c=Reflect.get(t,s,ze(t)?t:o);if((xt(s)?Ua.has(s):di(s))||(n||We(t,"get",s),r))return c;if(ze(c)){const u=l&&mo(s)?c:c.value;return n&&$e(u)?no(u):u}return $e(c)?n?no(c):Ps(c):c}}class Na extends Ma{constructor(t=!1){super(!1,t)}set(t,s,o,n){let r=t[s];if(!this._isShallow){const u=Gt(r);if(!pt(o)&&!Gt(o)&&(r=we(r),o=we(o)),!se(t)&&ze(r)&&!ze(o))return u||(r.value=o),!0}const l=se(t)&&mo(s)?Number(s)<t.length:xe(t,s),c=Reflect.set(t,s,o,ze(t)?t:n);return t===we(n)&&(l?Vt(o,r)&&Ft(t,"set",s,o):Ft(t,"add",s,o)),c}deleteProperty(t,s){const o=xe(t,s);t[s];const n=Reflect.deleteProperty(t,s);return n&&o&&Ft(t,"delete",s,void 0),n}has(t,s){const o=Reflect.has(t,s);return(!xt(s)||!Ua.has(s))&&We(t,"has",s),o}ownKeys(t){return We(t,"iterate",se(t)?"length":ts),Reflect.ownKeys(t)}}class vi extends Ma{constructor(t=!1){super(!0,t)}set(t,s){return!0}deleteProperty(t,s){return!0}}const pi=new Na,mi=new vi,hi=new Na(!0);const so=e=>e,Ks=e=>Reflect.getPrototypeOf(e);function gi(e,t,s){return function(...o){const n=this.__v_raw,r=we(n),l=us(r),c=e==="entries"||e===Symbol.iterator&&l,u=e==="keys"&&l,f=n[e](...o),d=s?so:t?tn:Ke;return!t&&We(r,"iterate",u?to:ts),{next(){const{value:w,done:A}=f.next();return A?{value:w,done:A}:{value:c?[d(w[0]),d(w[1])]:d(w),done:A}},[Symbol.iterator](){return this}}}}function Gs(e){return function(...t){return e==="delete"?!1:e==="clear"?void 0:this}}function yi(e,t){const s={get(n){const r=this.__v_raw,l=we(r),c=we(n);e||(Vt(n,c)&&We(l,"get",n),We(l,"get",c));const{has:u}=Ks(l),f=t?so:e?tn:Ke;if(u.call(l,n))return f(r.get(n));if(u.call(l,c))return f(r.get(c));r!==l&&r.get(n)},get size(){const n=this.__v_raw;return!e&&We(we(n),"iterate",ts),n.size},has(n){const r=this.__v_raw,l=we(r),c=we(n);return e||(Vt(n,c)&&We(l,"has",n),We(l,"has",c)),n===c?r.has(n):r.has(n)||r.has(c)},forEach(n,r){const l=this,c=l.__v_raw,u=we(c),f=t?so:e?tn:Ke;return!e&&We(u,"iterate",ts),c.forEach((d,w)=>n.call(r,f(d),f(w),l))}};return Ge(s,e?{add:Gs("add"),set:Gs("set"),delete:Gs("delete"),clear:Gs("clear")}:{add(n){!t&&!pt(n)&&!Gt(n)&&(n=we(n));const r=we(this);return Ks(r).has.call(r,n)||(r.add(n),Ft(r,"add",n,n)),this},set(n,r){!t&&!pt(r)&&!Gt(r)&&(r=we(r));const l=we(this),{has:c,get:u}=Ks(l);let f=c.call(l,n);f||(n=we(n),f=c.call(l,n));const d=u.call(l,n);return l.set(n,r),f?Vt(r,d)&&Ft(l,"set",n,r):Ft(l,"add",n,r),this},delete(n){const r=we(this),{has:l,get:c}=Ks(r);let u=l.call(r,n);u||(n=we(n),u=l.call(r,n)),c&&c.call(r,n);const f=r.delete(n);return u&&Ft(r,"delete",n,void 0),f},clear(){const n=we(this),r=n.size!==0,l=n.clear();return r&&Ft(n,"clear",void 0,void 0),l}}),["keys","values","entries",Symbol.iterator].forEach(n=>{s[n]=gi(n,e,t)}),s}function _o(e,t){const s=yi(e,t);return(o,n,r)=>n==="__v_isReactive"?!e:n==="__v_isReadonly"?e:n==="__v_raw"?o:Reflect.get(xe(s,n)&&n in o?s:o,n,r)}const bi={get:_o(!1,!1)},_i={get:_o(!1,!0)},wi={get:_o(!0,!1)};const Ra=new WeakMap,La=new WeakMap,ja=new WeakMap,ki=new WeakMap;function Si(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ci(e){return e.__v_skip||!Object.isExtensible(e)?0:Si(Yr(e))}function Ps(e){return Gt(e)?e:wo(e,!1,pi,bi,Ra)}function xi(e){return wo(e,!1,hi,_i,La)}function no(e){return wo(e,!0,mi,wi,ja)}function wo(e,t,s,o,n){if(!$e(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const r=Ci(e);if(r===0)return e;const l=n.get(e);if(l)return l;const c=new Proxy(e,r===2?o:s);return n.set(e,c),c}function ds(e){return Gt(e)?ds(e.__v_raw):!!(e&&e.__v_isReactive)}function Gt(e){return!!(e&&e.__v_isReadonly)}function pt(e){return!!(e&&e.__v_isShallow)}function ko(e){return e?!!e.__v_raw:!1}function we(e){const t=e&&e.__v_raw;return t?we(t):e}function Ei(e){return!xe(e,"__v_skip")&&Object.isExtensible(e)&&ka(e,"__v_skip",!0),e}const Ke=e=>$e(e)?Ps(e):e,tn=e=>$e(e)?no(e):e;function ze(e){return e?e.__v_isRef===!0:!1}function F(e){return Ai(e,!1)}function Ai(e,t){return ze(e)?e:new $i(e,t)}class $i{constructor(t,s){this.dep=new bo,this.__v_isRef=!0,this.__v_isShallow=!1,this._rawValue=s?t:we(t),this._value=s?t:Ke(t),this.__v_isShallow=s}get value(){return this.dep.track(),this._value}set value(t){const s=this._rawValue,o=this.__v_isShallow||pt(t)||Gt(t);t=o?t:we(t),Vt(t,s)&&(this._rawValue=t,this._value=o?t:Ke(t),this.dep.trigger())}}function Dt(e){return ze(e)?e.value:e}const Ti={get:(e,t,s)=>t==="__v_raw"?e:Dt(Reflect.get(e,t,s)),set:(e,t,s,o)=>{const n=e[t];return ze(n)&&!ze(s)?(n.value=s,!0):Reflect.set(e,t,s,o)}};function qa(e){return ds(e)?e:new Proxy(e,Ti)}class Ii{constructor(t,s,o){this.fn=t,this.setter=s,this._value=void 0,this.dep=new bo(this),this.__v_isRef=!0,this.deps=void 0,this.depsTail=void 0,this.flags=16,this.globalVersion=Is-1,this.next=void 0,this.effect=this,this.__v_isReadonly=!s,this.isSSR=o}notify(){if(this.flags|=16,!(this.flags&8)&&Oe!==this)return $a(this,!0),!0}get value(){const t=this.dep.track();return Oa(this),t&&(t.version=this.dep.version),this._value}set value(t){this.setter&&this.setter(t)}}function Oi(e,t,s=!1){let o,n;return ce(e)?o=e:(o=e.get,n=e.set),new Ii(o,n,s)}const Ys={},sn=new WeakMap;let Qt;function Pi(e,t=!1,s=Qt){if(s){let o=sn.get(s);o||sn.set(s,o=[]),o.push(e)}}function Fi(e,t,s=Ie){const{immediate:o,deep:n,once:r,scheduler:l,augmentJob:c,call:u}=s,f=U=>n?U:pt(U)||n===!1||n===0?Ut(U,1):Ut(U);let d,w,A,E,O=!1,B=!1;if(ze(e)?(w=()=>e.value,O=pt(e)):ds(e)?(w=()=>f(e),O=!0):se(e)?(B=!0,O=e.some(U=>ds(U)||pt(U)),w=()=>e.map(U=>{if(ze(U))return U.value;if(ds(U))return f(U);if(ce(U))return u?u(U,2):U()})):ce(e)?t?w=u?()=>u(e,2):e:w=()=>{if(A){Nt();try{A()}finally{Rt()}}const U=Qt;Qt=d;try{return u?u(e,3,[E]):e(E)}finally{Qt=U}}:w=Ct,t&&n){const U=w,K=n===!0?1/0:n;w=()=>Ut(U(),K)}const ae=ri(),q=()=>{d.stop(),ae&&ae.active&&po(ae.effects,d)};if(r&&t){const U=t;t=(...K)=>{U(...K),q()}}let Y=B?new Array(e.length).fill(Ys):Ys;const Q=U=>{if(!(!(d.flags&1)||!d.dirty&&!U))if(t){const K=d.run();if(n||O||(B?K.some((ie,ke)=>Vt(ie,Y[ke])):Vt(K,Y))){A&&A();const ie=Qt;Qt=d;try{const ke=[K,Y===Ys?void 0:B&&Y[0]===Ys?[]:Y,E];Y=K,u?u(t,3,ke):t(...ke)}finally{Qt=ie}}}else d.run()};return c&&c(Q),d=new Ea(w),d.scheduler=l?()=>l(Q,!1):Q,E=U=>Pi(U,!1,d),A=d.onStop=()=>{const U=sn.get(d);if(U){if(u)u(U,4);else for(const K of U)K();sn.delete(d)}},t?o?Q(!0):Y=d.run():l?l(Q.bind(null,!0),!0):d.run(),q.pause=d.pause.bind(d),q.resume=d.resume.bind(d),q.stop=q,q}function Ut(e,t=1/0,s){if(t<=0||!$e(e)||e.__v_skip||(s=s||new Map,(s.get(e)||0)>=t))return e;if(s.set(e,t),t--,ze(e))Ut(e.value,t,s);else if(se(e))for(let o=0;o<e.length;o++)Ut(e[o],t,s);else if(hn(e)||us(e))e.forEach(o=>{Ut(o,t,s)});else if(_a(e)){for(const o in e)Ut(e[o],t,s);for(const o of Object.getOwnPropertySymbols(e))Object.prototype.propertyIsEnumerable.call(e,o)&&Ut(e[o],t,s)}return e}/**
* @vue/runtime-core v3.5.24
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function js(e,t,s,o){try{return o?e(...o):e()}catch(n){kn(n,t,s)}}function yt(e,t,s,o){if(ce(e)){const n=js(e,t,s,o);return n&&ya(n)&&n.catch(r=>{kn(r,t,s)}),n}if(se(e)){const n=[];for(let r=0;r<e.length;r++)n.push(yt(e[r],t,s,o));return n}}function kn(e,t,s,o=!0){const n=t?t.vnode:null,{errorHandler:r,throwUnhandledErrorInProduction:l}=t&&t.appContext.config||Ie;if(t){let c=t.parent;const u=t.proxy,f=`https://vuejs.org/error-reference/#runtime-${s}`;for(;c;){const d=c.ec;if(d){for(let w=0;w<d.length;w++)if(d[w](e,u,f)===!1)return}c=c.parent}if(r){Nt(),js(r,null,10,[e,u,f]),Rt();return}}Ui(e,s,n,o,l)}function Ui(e,t,s,o=!0,n=!1){if(n)throw e;console.error(e)}const Ze=[];let wt=-1;const fs=[];let Ht=null,ls=0;const Da=Promise.resolve();let nn=null;function Ha(e){const t=nn||Da;return e?t.then(this?e.bind(this):e):t}function Mi(e){let t=wt+1,s=Ze.length;for(;t<s;){const o=t+s>>>1,n=Ze[o],r=Fs(n);r<e||r===e&&n.flags&2?t=o+1:s=o}return t}function So(e){if(!(e.flags&1)){const t=Fs(e),s=Ze[Ze.length-1];!s||!(e.flags&2)&&t>=Fs(s)?Ze.push(e):Ze.splice(Mi(t),0,e),e.flags|=1,Ba()}}function Ba(){nn||(nn=Da.then(Ka))}function Ni(e){se(e)?fs.push(...e):Ht&&e.id===-1?Ht.splice(ls+1,0,e):e.flags&1||(fs.push(e),e.flags|=1),Ba()}function Ro(e,t,s=wt+1){for(;s<Ze.length;s++){const o=Ze[s];if(o&&o.flags&2){if(e&&o.id!==e.uid)continue;Ze.splice(s,1),s--,o.flags&4&&(o.flags&=-2),o(),o.flags&4||(o.flags&=-2)}}}function Va(e){if(fs.length){const t=[...new Set(fs)].sort((s,o)=>Fs(s)-Fs(o));if(fs.length=0,Ht){Ht.push(...t);return}for(Ht=t,ls=0;ls<Ht.length;ls++){const s=Ht[ls];s.flags&4&&(s.flags&=-2),s.flags&8||s(),s.flags&=-2}Ht=null,ls=0}}const Fs=e=>e.id==null?e.flags&2?-1:1/0:e.id;function Ka(e){try{for(wt=0;wt<Ze.length;wt++){const t=Ze[wt];t&&!(t.flags&8)&&(t.flags&4&&(t.flags&=-2),js(t,t.i,t.i?15:14),t.flags&4||(t.flags&=-2))}}finally{for(;wt<Ze.length;wt++){const t=Ze[wt];t&&(t.flags&=-2)}wt=-1,Ze.length=0,Va(),nn=null,(Ze.length||fs.length)&&Ka()}}let vt=null,Ga=null;function on(e){const t=vt;return vt=e,Ga=e&&e.type.__scopeId||null,t}function Ya(e,t=vt,s){if(!t||e._n)return e;const o=(...n)=>{o._d&&ln(-1);const r=on(t);let l;try{l=e(...n)}finally{on(r),o._d&&ln(1)}return l};return o._n=!0,o._c=!0,o._d=!0,o}function Le(e,t){if(vt===null)return e;const s=$n(vt),o=e.dirs||(e.dirs=[]);for(let n=0;n<t.length;n++){let[r,l,c,u=Ie]=t[n];r&&(ce(r)&&(r={mounted:r,updated:r}),r.deep&&Ut(l),o.push({dir:r,instance:s,value:l,oldValue:void 0,arg:c,modifiers:u}))}return e}function Wt(e,t,s,o){const n=e.dirs,r=t&&t.dirs;for(let l=0;l<n.length;l++){const c=n[l];r&&(c.oldValue=r[l].value);let u=c.dir[o];u&&(Nt(),yt(u,s,8,[e.el,c,e,t]),Rt())}}const Ri=Symbol("_vte"),Wa=e=>e.__isTeleport,Pt=Symbol("_leaveCb"),Ws=Symbol("_enterCb");function Li(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return xn(()=>{e.isMounted=!0}),sr(()=>{e.isUnmounting=!0}),e}const dt=[Function,Array],za={mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:dt,onEnter:dt,onAfterEnter:dt,onEnterCancelled:dt,onBeforeLeave:dt,onLeave:dt,onAfterLeave:dt,onLeaveCancelled:dt,onBeforeAppear:dt,onAppear:dt,onAfterAppear:dt,onAppearCancelled:dt},Ja=e=>{const t=e.subTree;return t.component?Ja(t.component):t},ji={name:"BaseTransition",props:za,setup(e,{slots:t}){const s=Sr(),o=Li();return()=>{const n=t.default&&Za(t.default(),!0);if(!n||!n.length)return;const r=Xa(n),l=we(e),{mode:c}=l;if(o.isLeaving)return Yn(r);const u=Lo(r);if(!u)return Yn(r);let f=oo(u,l,o,s,w=>f=w);u.type!==et&&Us(u,f);let d=s.subTree&&Lo(s.subTree);if(d&&d.type!==et&&!Zt(d,u)&&Ja(s).type!==et){let w=oo(d,l,o,s);if(Us(d,w),c==="out-in"&&u.type!==et)return o.isLeaving=!0,w.afterLeave=()=>{o.isLeaving=!1,s.job.flags&8||s.update(),delete w.afterLeave,d=void 0},Yn(r);c==="in-out"&&u.type!==et?w.delayLeave=(A,E,O)=>{const B=Qa(o,d);B[String(d.key)]=d,A[Pt]=()=>{E(),A[Pt]=void 0,delete f.delayedLeave,d=void 0},f.delayedLeave=()=>{O(),delete f.delayedLeave,d=void 0}}:d=void 0}else d&&(d=void 0);return r}}};function Xa(e){let t=e[0];if(e.length>1){for(const s of e)if(s.type!==et){t=s;break}}return t}const qi=ji;function Qa(e,t){const{leavingVNodes:s}=e;let o=s.get(t.type);return o||(o=Object.create(null),s.set(t.type,o)),o}function oo(e,t,s,o,n){const{appear:r,mode:l,persisted:c=!1,onBeforeEnter:u,onEnter:f,onAfterEnter:d,onEnterCancelled:w,onBeforeLeave:A,onLeave:E,onAfterLeave:O,onLeaveCancelled:B,onBeforeAppear:ae,onAppear:q,onAfterAppear:Y,onAppearCancelled:Q}=t,U=String(e.key),K=Qa(s,e),ie=(z,de)=>{z&&yt(z,o,9,de)},ke=(z,de)=>{const fe=de[1];ie(z,de),se(z)?z.every(D=>D.length<=1)&&fe():z.length<=1&&fe()},Se={mode:l,persisted:c,beforeEnter(z){let de=u;if(!s.isMounted)if(r)de=ae||u;else return;z[Pt]&&z[Pt](!0);const fe=K[U];fe&&Zt(e,fe)&&fe.el[Pt]&&fe.el[Pt](),ie(de,[z])},enter(z){let de=f,fe=d,D=w;if(!s.isMounted)if(r)de=q||f,fe=Y||d,D=Q||w;else return;let ve=!1;const Ce=z[Ws]=Ue=>{ve||(ve=!0,Ue?ie(D,[z]):ie(fe,[z]),Se.delayedLeave&&Se.delayedLeave(),z[Ws]=void 0)};de?ke(de,[z,Ce]):Ce()},leave(z,de){const fe=String(e.key);if(z[Ws]&&z[Ws](!0),s.isUnmounting)return de();ie(A,[z]);let D=!1;const ve=z[Pt]=Ce=>{D||(D=!0,de(),Ce?ie(B,[z]):ie(O,[z]),z[Pt]=void 0,K[fe]===e&&delete K[fe])};K[fe]=e,E?ke(E,[z,ve]):ve()},clone(z){const de=oo(z,t,s,o,n);return n&&n(de),de}};return Se}function Yn(e){if(Sn(e))return e=Yt(e),e.children=null,e}function Lo(e){if(!Sn(e))return Wa(e.type)&&e.children?Xa(e.children):e;if(e.component)return e.component.subTree;const{shapeFlag:t,children:s}=e;if(s){if(t&16)return s[0];if(t&32&&ce(s.default))return s.default()}}function Us(e,t){e.shapeFlag&6&&e.component?(e.transition=t,Us(e.component.subTree,t)):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Za(e,t=!1,s){let o=[],n=0;for(let r=0;r<e.length;r++){let l=e[r];const c=s==null?l.key:String(s)+String(l.key!=null?l.key:r);l.type===oe?(l.patchFlag&128&&n++,o=o.concat(Za(l.children,t,c))):(t||l.type!==et)&&o.push(c!=null?Yt(l,{key:c}):l)}if(n>1)for(let r=0;r<o.length;r++)o[r].patchFlag=-2;return o}function er(e){e.ids=[e.ids[0]+e.ids[2]+++"-",0,0]}const an=new WeakMap;function Es(e,t,s,o,n=!1){if(se(e)){e.forEach((O,B)=>Es(O,t&&(se(t)?t[B]:t),s,o,n));return}if(As(o)&&!n){o.shapeFlag&512&&o.type.__asyncResolved&&o.component.subTree.component&&Es(e,t,s,o.component.subTree);return}const r=o.shapeFlag&4?$n(o.component):o.el,l=n?null:r,{i:c,r:u}=e,f=t&&t.r,d=c.refs===Ie?c.refs={}:c.refs,w=c.setupState,A=we(w),E=w===Ie?ga:O=>xe(A,O);if(f!=null&&f!==u){if(jo(t),je(f))d[f]=null,E(f)&&(w[f]=null);else if(ze(f)){f.value=null;const O=t;O.k&&(d[O.k]=null)}}if(ce(u))js(u,c,12,[l,d]);else{const O=je(u),B=ze(u);if(O||B){const ae=()=>{if(e.f){const q=O?E(u)?w[u]:d[u]:u.value;if(n)se(q)&&po(q,r);else if(se(q))q.includes(r)||q.push(r);else if(O)d[u]=[r],E(u)&&(w[u]=d[u]);else{const Y=[r];u.value=Y,e.k&&(d[e.k]=Y)}}else O?(d[u]=l,E(u)&&(w[u]=l)):B&&(u.value=l,e.k&&(d[e.k]=l))};if(l){const q=()=>{ae(),an.delete(e)};q.id=-1,an.set(e,q),rt(q,s)}else jo(e),ae()}}}function jo(e){const t=an.get(e);t&&(t.flags|=8,an.delete(e))}bn().requestIdleCallback;bn().cancelIdleCallback;const As=e=>!!e.type.__asyncLoader,Sn=e=>e.type.__isKeepAlive;function Di(e,t){tr(e,"a",t)}function Hi(e,t){tr(e,"da",t)}function tr(e,t,s=tt){const o=e.__wdc||(e.__wdc=()=>{let n=s;for(;n;){if(n.isDeactivated)return;n=n.parent}return e()});if(Cn(t,o,s),s){let n=s.parent;for(;n&&n.parent;)Sn(n.parent.vnode)&&Bi(o,t,s,n),n=n.parent}}function Bi(e,t,s,o){const n=Cn(t,e,o,!0);nr(()=>{po(o[t],n)},s)}function Cn(e,t,s=tt,o=!1){if(s){const n=s[e]||(s[e]=[]),r=t.__weh||(t.__weh=(...l)=>{Nt();const c=qs(s),u=yt(t,s,e,l);return c(),Rt(),u});return o?n.unshift(r):n.push(r),r}}const Lt=e=>(t,s=tt)=>{(!Ns||e==="sp")&&Cn(e,(...o)=>t(...o),s)},Vi=Lt("bm"),xn=Lt("m"),Ki=Lt("bu"),Gi=Lt("u"),sr=Lt("bum"),nr=Lt("um"),Yi=Lt("sp"),Wi=Lt("rtg"),zi=Lt("rtc");function Ji(e,t=tt){Cn("ec",e,t)}const Xi=Symbol.for("v-ndc");function Pe(e,t,s,o){let n;const r=s,l=se(e);if(l||je(e)){const c=l&&ds(e);let u=!1,f=!1;c&&(u=!pt(e),f=Gt(e),e=wn(e)),n=new Array(e.length);for(let d=0,w=e.length;d<w;d++)n[d]=t(u?f?tn(Ke(e[d])):Ke(e[d]):e[d],d,void 0,r)}else if(typeof e=="number"){n=new Array(e);for(let c=0;c<e;c++)n[c]=t(c+1,c,void 0,r)}else if($e(e))if(e[Symbol.iterator])n=Array.from(e,(c,u)=>t(c,u,void 0,r));else{const c=Object.keys(e);n=new Array(c.length);for(let u=0,f=c.length;u<f;u++){const d=c[u];n[u]=t(e[d],d,u,r)}}else n=[];return n}const ao=e=>e?Cr(e)?$n(e):ao(e.parent):null,$s=Ge(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>ao(e.parent),$root:e=>ao(e.root),$host:e=>e.ce,$emit:e=>e.emit,$options:e=>ar(e),$forceUpdate:e=>e.f||(e.f=()=>{So(e.update)}),$nextTick:e=>e.n||(e.n=Ha.bind(e.proxy)),$watch:e=>bl.bind(e)}),Wn=(e,t)=>e!==Ie&&!e.__isScriptSetup&&xe(e,t),Qi={get({_:e},t){if(t==="__v_skip")return!0;const{ctx:s,setupState:o,data:n,props:r,accessCache:l,type:c,appContext:u}=e;let f;if(t[0]!=="$"){const E=l[t];if(E!==void 0)switch(E){case 1:return o[t];case 2:return n[t];case 4:return s[t];case 3:return r[t]}else{if(Wn(o,t))return l[t]=1,o[t];if(n!==Ie&&xe(n,t))return l[t]=2,n[t];if((f=e.propsOptions[0])&&xe(f,t))return l[t]=3,r[t];if(s!==Ie&&xe(s,t))return l[t]=4,s[t];ro&&(l[t]=0)}}const d=$s[t];let w,A;if(d)return t==="$attrs"&&We(e.attrs,"get",""),d(e);if((w=c.__cssModules)&&(w=w[t]))return w;if(s!==Ie&&xe(s,t))return l[t]=4,s[t];if(A=u.config.globalProperties,xe(A,t))return A[t]},set({_:e},t,s){const{data:o,setupState:n,ctx:r}=e;return Wn(n,t)?(n[t]=s,!0):o!==Ie&&xe(o,t)?(o[t]=s,!0):xe(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(r[t]=s,!0)},has({_:{data:e,setupState:t,accessCache:s,ctx:o,appContext:n,propsOptions:r,type:l}},c){let u,f;return!!(s[c]||e!==Ie&&c[0]!=="$"&&xe(e,c)||Wn(t,c)||(u=r[0])&&xe(u,c)||xe(o,c)||xe($s,c)||xe(n.config.globalProperties,c)||(f=l.__cssModules)&&f[c])},defineProperty(e,t,s){return s.get!=null?e._.accessCache[t]=0:xe(s,"value")&&this.set(e,t,s.value,null),Reflect.defineProperty(e,t,s)}};function qo(e){return se(e)?e.reduce((t,s)=>(t[s]=null,t),{}):e}let ro=!0;function Zi(e){const t=ar(e),s=e.proxy,o=e.ctx;ro=!1,t.beforeCreate&&Do(t.beforeCreate,e,"bc");const{data:n,computed:r,methods:l,watch:c,provide:u,inject:f,created:d,beforeMount:w,mounted:A,beforeUpdate:E,updated:O,activated:B,deactivated:ae,beforeDestroy:q,beforeUnmount:Y,destroyed:Q,unmounted:U,render:K,renderTracked:ie,renderTriggered:ke,errorCaptured:Se,serverPrefetch:z,expose:de,inheritAttrs:fe,components:D,directives:ve,filters:Ce}=t;if(f&&el(f,o,null),l)for(const me in l){const ue=l[me];ce(ue)&&(o[me]=ue.bind(s))}if(n){const me=n.call(s,s);$e(me)&&(e.data=Ps(me))}if(ro=!0,r)for(const me in r){const ue=r[me],Me=ce(ue)?ue.bind(s,s):ce(ue.get)?ue.get.bind(s,s):Ct,be=!ce(ue)&&ce(ue.set)?ue.set.bind(s):Ct,Re=te({get:Me,set:be});Object.defineProperty(o,me,{enumerable:!0,configurable:!0,get:()=>Re.value,set:_e=>Re.value=_e})}if(c)for(const me in c)or(c[me],o,s,me);if(u){const me=ce(u)?u.call(s):u;Reflect.ownKeys(me).forEach(ue=>{rl(ue,me[ue])})}d&&Do(d,e,"c");function Ae(me,ue){se(ue)?ue.forEach(Me=>me(Me.bind(s))):ue&&me(ue.bind(s))}if(Ae(Vi,w),Ae(xn,A),Ae(Ki,E),Ae(Gi,O),Ae(Di,B),Ae(Hi,ae),Ae(Ji,Se),Ae(zi,ie),Ae(Wi,ke),Ae(sr,Y),Ae(nr,U),Ae(Yi,z),se(de))if(de.length){const me=e.exposed||(e.exposed={});de.forEach(ue=>{Object.defineProperty(me,ue,{get:()=>s[ue],set:Me=>s[ue]=Me,enumerable:!0})})}else e.exposed||(e.exposed={});K&&e.render===Ct&&(e.render=K),fe!=null&&(e.inheritAttrs=fe),D&&(e.components=D),ve&&(e.directives=ve),z&&er(e)}function el(e,t,s=Ct){se(e)&&(e=io(e));for(const o in e){const n=e[o];let r;$e(n)?"default"in n?r=Xs(n.from||o,n.default,!0):r=Xs(n.from||o):r=Xs(n),ze(r)?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>r.value,set:l=>r.value=l}):t[o]=r}}function Do(e,t,s){yt(se(e)?e.map(o=>o.bind(t.proxy)):e.bind(t.proxy),t,s)}function or(e,t,s,o){let n=o.includes(".")?yr(s,o):()=>s[o];if(je(e)){const r=t[e];ce(r)&&ct(n,r)}else if(ce(e))ct(n,e.bind(s));else if($e(e))if(se(e))e.forEach(r=>or(r,t,s,o));else{const r=ce(e.handler)?e.handler.bind(s):t[e.handler];ce(r)&&ct(n,r,e)}}function ar(e){const t=e.type,{mixins:s,extends:o}=t,{mixins:n,optionsCache:r,config:{optionMergeStrategies:l}}=e.appContext,c=r.get(t);let u;return c?u=c:!n.length&&!s&&!o?u=t:(u={},n.length&&n.forEach(f=>rn(u,f,l,!0)),rn(u,t,l)),$e(t)&&r.set(t,u),u}function rn(e,t,s,o=!1){const{mixins:n,extends:r}=t;r&&rn(e,r,s,!0),n&&n.forEach(l=>rn(e,l,s,!0));for(const l in t)if(!(o&&l==="expose")){const c=tl[l]||s&&s[l];e[l]=c?c(e[l],t[l]):t[l]}return e}const tl={data:Ho,props:Bo,emits:Bo,methods:ks,computed:ks,beforeCreate:Xe,created:Xe,beforeMount:Xe,mounted:Xe,beforeUpdate:Xe,updated:Xe,beforeDestroy:Xe,beforeUnmount:Xe,destroyed:Xe,unmounted:Xe,activated:Xe,deactivated:Xe,errorCaptured:Xe,serverPrefetch:Xe,components:ks,directives:ks,watch:nl,provide:Ho,inject:sl};function Ho(e,t){return t?e?function(){return Ge(ce(e)?e.call(this,this):e,ce(t)?t.call(this,this):t)}:t:e}function sl(e,t){return ks(io(e),io(t))}function io(e){if(se(e)){const t={};for(let s=0;s<e.length;s++)t[e[s]]=e[s];return t}return e}function Xe(e,t){return e?[...new Set([].concat(e,t))]:t}function ks(e,t){return e?Ge(Object.create(null),e,t):t}function Bo(e,t){return e?se(e)&&se(t)?[...new Set([...e,...t])]:Ge(Object.create(null),qo(e),qo(t??{})):t}function nl(e,t){if(!e)return t;if(!t)return e;const s=Ge(Object.create(null),e);for(const o in t)s[o]=Xe(e[o],t[o]);return s}function rr(){return{app:null,config:{isNativeTag:ga,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let ol=0;function al(e,t){return function(o,n=null){ce(o)||(o=Ge({},o)),n!=null&&!$e(n)&&(n=null);const r=rr(),l=new WeakSet,c=[];let u=!1;const f=r.app={_uid:ol++,_component:o,_props:n,_container:null,_context:r,_instance:null,version:Dl,get config(){return r.config},set config(d){},use(d,...w){return l.has(d)||(d&&ce(d.install)?(l.add(d),d.install(f,...w)):ce(d)&&(l.add(d),d(f,...w))),f},mixin(d){return r.mixins.includes(d)||r.mixins.push(d),f},component(d,w){return w?(r.components[d]=w,f):r.components[d]},directive(d,w){return w?(r.directives[d]=w,f):r.directives[d]},mount(d,w,A){if(!u){const E=f._ceVNode||Fe(o,n);return E.appContext=r,A===!0?A="svg":A===!1&&(A=void 0),e(E,d,A),u=!0,f._container=d,d.__vue_app__=f,$n(E.component)}},onUnmount(d){c.push(d)},unmount(){u&&(yt(c,f._instance,16),e(null,f._container),delete f._container.__vue_app__)},provide(d,w){return r.provides[d]=w,f},runWithContext(d){const w=vs;vs=f;try{return d()}finally{vs=w}}};return f}}let vs=null;function rl(e,t){if(tt){let s=tt.provides;const o=tt.parent&&tt.parent.provides;o===s&&(s=tt.provides=Object.create(o)),s[e]=t}}function Xs(e,t,s=!1){const o=Sr();if(o||vs){let n=vs?vs._context.provides:o?o.parent==null||o.ce?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:void 0;if(n&&e in n)return n[e];if(arguments.length>1)return s&&ce(t)?t.call(o&&o.proxy):t}}const ir={},lr=()=>Object.create(ir),cr=e=>Object.getPrototypeOf(e)===ir;function il(e,t,s,o=!1){const n={},r=lr();e.propsDefaults=Object.create(null),ur(e,t,n,r);for(const l in e.propsOptions[0])l in n||(n[l]=void 0);s?e.props=o?n:xi(n):e.type.props?e.props=n:e.props=r,e.attrs=r}function ll(e,t,s,o){const{props:n,attrs:r,vnode:{patchFlag:l}}=e,c=we(n),[u]=e.propsOptions;let f=!1;if((o||l>0)&&!(l&16)){if(l&8){const d=e.vnode.dynamicProps;for(let w=0;w<d.length;w++){let A=d[w];if(En(e.emitsOptions,A))continue;const E=t[A];if(u)if(xe(r,A))E!==r[A]&&(r[A]=E,f=!0);else{const O=Kt(A);n[O]=lo(u,c,O,E,e,!1)}else E!==r[A]&&(r[A]=E,f=!0)}}}else{ur(e,t,n,r)&&(f=!0);let d;for(const w in c)(!t||!xe(t,w)&&((d=ss(w))===w||!xe(t,d)))&&(u?s&&(s[w]!==void 0||s[d]!==void 0)&&(n[w]=lo(u,c,w,void 0,e,!0)):delete n[w]);if(r!==c)for(const w in r)(!t||!xe(t,w))&&(delete r[w],f=!0)}f&&Ft(e.attrs,"set","")}function ur(e,t,s,o){const[n,r]=e.propsOptions;let l=!1,c;if(t)for(let u in t){if(Ss(u))continue;const f=t[u];let d;n&&xe(n,d=Kt(u))?!r||!r.includes(d)?s[d]=f:(c||(c={}))[d]=f:En(e.emitsOptions,u)||(!(u in o)||f!==o[u])&&(o[u]=f,l=!0)}if(r){const u=we(s),f=c||Ie;for(let d=0;d<r.length;d++){const w=r[d];s[w]=lo(n,u,w,f[w],e,!xe(f,w))}}return l}function lo(e,t,s,o,n,r){const l=e[s];if(l!=null){const c=xe(l,"default");if(c&&o===void 0){const u=l.default;if(l.type!==Function&&!l.skipFactory&&ce(u)){const{propsDefaults:f}=n;if(s in f)o=f[s];else{const d=qs(n);o=f[s]=u.call(null,t),d()}}else o=u;n.ce&&n.ce._setProp(s,o)}l[0]&&(r&&!c?o=!1:l[1]&&(o===""||o===ss(s))&&(o=!0))}return o}const cl=new WeakMap;function dr(e,t,s=!1){const o=s?cl:t.propsCache,n=o.get(e);if(n)return n;const r=e.props,l={},c=[];let u=!1;if(!ce(e)){const d=w=>{u=!0;const[A,E]=dr(w,t,!0);Ge(l,A),E&&c.push(...E)};!s&&t.mixins.length&&t.mixins.forEach(d),e.extends&&d(e.extends),e.mixins&&e.mixins.forEach(d)}if(!r&&!u)return $e(e)&&o.set(e,cs),cs;if(se(r))for(let d=0;d<r.length;d++){const w=Kt(r[d]);Vo(w)&&(l[w]=Ie)}else if(r)for(const d in r){const w=Kt(d);if(Vo(w)){const A=r[d],E=l[w]=se(A)||ce(A)?{type:A}:Ge({},A),O=E.type;let B=!1,ae=!0;if(se(O))for(let q=0;q<O.length;++q){const Y=O[q],Q=ce(Y)&&Y.name;if(Q==="Boolean"){B=!0;break}else Q==="String"&&(ae=!1)}else B=ce(O)&&O.name==="Boolean";E[0]=B,E[1]=ae,(B||xe(E,"default"))&&c.push(w)}}const f=[l,c];return $e(e)&&o.set(e,f),f}function Vo(e){return e[0]!=="$"&&!Ss(e)}const Co=e=>e==="_"||e==="_ctx"||e==="$stable",xo=e=>se(e)?e.map(kt):[kt(e)],ul=(e,t,s)=>{if(t._n)return t;const o=Ya((...n)=>xo(t(...n)),s);return o._c=!1,o},fr=(e,t,s)=>{const o=e._ctx;for(const n in e){if(Co(n))continue;const r=e[n];if(ce(r))t[n]=ul(n,r,o);else if(r!=null){const l=xo(r);t[n]=()=>l}}},vr=(e,t)=>{const s=xo(t);e.slots.default=()=>s},pr=(e,t,s)=>{for(const o in t)(s||!Co(o))&&(e[o]=t[o])},dl=(e,t,s)=>{const o=e.slots=lr();if(e.vnode.shapeFlag&32){const n=t._;n?(pr(o,t,s),s&&ka(o,"_",n,!0)):fr(t,o)}else t&&vr(e,t)},fl=(e,t,s)=>{const{vnode:o,slots:n}=e;let r=!0,l=Ie;if(o.shapeFlag&32){const c=t._;c?s&&c===1?r=!1:pr(n,t,s):(r=!t.$stable,fr(t,n)),l=t}else t&&(vr(e,t),l={default:1});if(r)for(const c in n)!Co(c)&&l[c]==null&&delete n[c]},rt=Al;function vl(e){return pl(e)}function pl(e,t){const s=bn();s.__VUE__=!0;const{insert:o,remove:n,patchProp:r,createElement:l,createText:c,createComment:u,setText:f,setElementText:d,parentNode:w,nextSibling:A,setScopeId:E=Ct,insertStaticContent:O}=e,B=(p,v,h,I=null,P=null,m=null,y=void 0,g=null,$=!!v.dynamicChildren)=>{if(p===v)return;p&&!Zt(p,v)&&(I=W(p),_e(p,P,m,!0),p=null),v.patchFlag===-2&&($=!1,v.dynamicChildren=null);const{type:C,ref:j,shapeFlag:N}=v;switch(C){case An:ae(p,v,h,I);break;case et:q(p,v,h,I);break;case Qs:p==null&&Y(v,h,I,y);break;case oe:D(p,v,h,I,P,m,y,g,$);break;default:N&1?K(p,v,h,I,P,m,y,g,$):N&6?ve(p,v,h,I,P,m,y,g,$):(N&64||N&128)&&C.process(p,v,h,I,P,m,y,g,$,Z)}j!=null&&P?Es(j,p&&p.ref,m,v||p,!v):j==null&&p&&p.ref!=null&&Es(p.ref,null,m,p,!0)},ae=(p,v,h,I)=>{if(p==null)o(v.el=c(v.children),h,I);else{const P=v.el=p.el;v.children!==p.children&&f(P,v.children)}},q=(p,v,h,I)=>{p==null?o(v.el=u(v.children||""),h,I):v.el=p.el},Y=(p,v,h,I)=>{[p.el,p.anchor]=O(p.children,v,h,I,p.el,p.anchor)},Q=({el:p,anchor:v},h,I)=>{let P;for(;p&&p!==v;)P=A(p),o(p,h,I),p=P;o(v,h,I)},U=({el:p,anchor:v})=>{let h;for(;p&&p!==v;)h=A(p),n(p),p=h;n(v)},K=(p,v,h,I,P,m,y,g,$)=>{if(v.type==="svg"?y="svg":v.type==="math"&&(y="mathml"),p==null)ie(v,h,I,P,m,y,g,$);else{const C=p.el&&p.el._isVueCE?p.el:null;try{C&&C._beginPatch(),z(p,v,P,m,y,g,$)}finally{C&&C._endPatch()}}},ie=(p,v,h,I,P,m,y,g)=>{let $,C;const{props:j,shapeFlag:N,transition:H,dirs:X}=p;if($=p.el=l(p.type,m,j&&j.is,j),N&8?d($,p.children):N&16&&Se(p.children,$,null,I,P,zn(p,m),y,g),X&&Wt(p,null,I,"created"),ke($,p,p.scopeId,y,I),j){for(const he in j)he!=="value"&&!Ss(he)&&r($,he,null,j[he],m,I);"value"in j&&r($,"value",null,j.value,m),(C=j.onVnodeBeforeMount)&&bt(C,I,p)}X&&Wt(p,null,I,"beforeMount");const re=ml(P,H);re&&H.beforeEnter($),o($,v,h),((C=j&&j.onVnodeMounted)||re||X)&&rt(()=>{C&&bt(C,I,p),re&&H.enter($),X&&Wt(p,null,I,"mounted")},P)},ke=(p,v,h,I,P)=>{if(h&&E(p,h),I)for(let m=0;m<I.length;m++)E(p,I[m]);if(P){let m=P.subTree;if(v===m||_r(m.type)&&(m.ssContent===v||m.ssFallback===v)){const y=P.vnode;ke(p,y,y.scopeId,y.slotScopeIds,P.parent)}}},Se=(p,v,h,I,P,m,y,g,$=0)=>{for(let C=$;C<p.length;C++){const j=p[C]=g?Bt(p[C]):kt(p[C]);B(null,j,v,h,I,P,m,y,g)}},z=(p,v,h,I,P,m,y)=>{const g=v.el=p.el;let{patchFlag:$,dynamicChildren:C,dirs:j}=v;$|=p.patchFlag&16;const N=p.props||Ie,H=v.props||Ie;let X;if(h&&zt(h,!1),(X=H.onVnodeBeforeUpdate)&&bt(X,h,v,p),j&&Wt(v,p,h,"beforeUpdate"),h&&zt(h,!0),(N.innerHTML&&H.innerHTML==null||N.textContent&&H.textContent==null)&&d(g,""),C?de(p.dynamicChildren,C,g,h,I,zn(v,P),m):y||ue(p,v,g,null,h,I,zn(v,P),m,!1),$>0){if($&16)fe(g,N,H,h,P);else if($&2&&N.class!==H.class&&r(g,"class",null,H.class,P),$&4&&r(g,"style",N.style,H.style,P),$&8){const re=v.dynamicProps;for(let he=0;he<re.length;he++){const ge=re[he],qe=N[ge],He=H[ge];(He!==qe||ge==="value")&&r(g,ge,qe,He,P,h)}}$&1&&p.children!==v.children&&d(g,v.children)}else!y&&C==null&&fe(g,N,H,h,P);((X=H.onVnodeUpdated)||j)&&rt(()=>{X&&bt(X,h,v,p),j&&Wt(v,p,h,"updated")},I)},de=(p,v,h,I,P,m,y)=>{for(let g=0;g<v.length;g++){const $=p[g],C=v[g],j=$.el&&($.type===oe||!Zt($,C)||$.shapeFlag&198)?w($.el):h;B($,C,j,null,I,P,m,y,!0)}},fe=(p,v,h,I,P)=>{if(v!==h){if(v!==Ie)for(const m in v)!Ss(m)&&!(m in h)&&r(p,m,v[m],null,P,I);for(const m in h){if(Ss(m))continue;const y=h[m],g=v[m];y!==g&&m!=="value"&&r(p,m,g,y,P,I)}"value"in h&&r(p,"value",v.value,h.value,P)}},D=(p,v,h,I,P,m,y,g,$)=>{const C=v.el=p?p.el:c(""),j=v.anchor=p?p.anchor:c("");let{patchFlag:N,dynamicChildren:H,slotScopeIds:X}=v;X&&(g=g?g.concat(X):X),p==null?(o(C,h,I),o(j,h,I),Se(v.children||[],h,j,P,m,y,g,$)):N>0&&N&64&&H&&p.dynamicChildren?(de(p.dynamicChildren,H,h,P,m,y,g),(v.key!=null||P&&v===P.subTree)&&mr(p,v,!0)):ue(p,v,h,j,P,m,y,g,$)},ve=(p,v,h,I,P,m,y,g,$)=>{v.slotScopeIds=g,p==null?v.shapeFlag&512?P.ctx.activate(v,h,I,y,$):Ce(v,h,I,P,m,y,$):Ue(p,v,$)},Ce=(p,v,h,I,P,m,y)=>{const g=p.component=Ul(p,I,P);if(Sn(p)&&(g.ctx.renderer=Z),Ml(g,!1,y),g.asyncDep){if(P&&P.registerDep(g,Ae,y),!p.el){const $=g.subTree=Fe(et);q(null,$,v,h),p.placeholder=$.el}}else Ae(g,p,v,h,P,m,y)},Ue=(p,v,h)=>{const I=v.component=p.component;if(xl(p,v,h))if(I.asyncDep&&!I.asyncResolved){me(I,v,h);return}else I.next=v,I.update();else v.el=p.el,I.vnode=v},Ae=(p,v,h,I,P,m,y)=>{const g=()=>{if(p.isMounted){let{next:N,bu:H,u:X,parent:re,vnode:he}=p;{const De=hr(p);if(De){N&&(N.el=he.el,me(p,N,y)),De.asyncDep.then(()=>{p.isUnmounted||g()});return}}let ge=N,qe;zt(p,!1),N?(N.el=he.el,me(p,N,y)):N=he,H&&Js(H),(qe=N.props&&N.props.onVnodeBeforeUpdate)&&bt(qe,re,N,he),zt(p,!0);const He=Go(p),Ye=p.subTree;p.subTree=He,B(Ye,He,w(Ye.el),W(Ye),p,P,m),N.el=He.el,ge===null&&El(p,He.el),X&&rt(X,P),(qe=N.props&&N.props.onVnodeUpdated)&&rt(()=>bt(qe,re,N,he),P)}else{let N;const{el:H,props:X}=v,{bm:re,m:he,parent:ge,root:qe,type:He}=p,Ye=As(v);zt(p,!1),re&&Js(re),!Ye&&(N=X&&X.onVnodeBeforeMount)&&bt(N,ge,v),zt(p,!0);{qe.ce&&qe.ce._def.shadowRoot!==!1&&qe.ce._injectChildStyle(He);const De=p.subTree=Go(p);B(null,De,h,I,p,P,m),v.el=De.el}if(he&&rt(he,P),!Ye&&(N=X&&X.onVnodeMounted)){const De=v;rt(()=>bt(N,ge,De),P)}(v.shapeFlag&256||ge&&As(ge.vnode)&&ge.vnode.shapeFlag&256)&&p.a&&rt(p.a,P),p.isMounted=!0,v=h=I=null}};p.scope.on();const $=p.effect=new Ea(g);p.scope.off();const C=p.update=$.run.bind($),j=p.job=$.runIfDirty.bind($);j.i=p,j.id=p.uid,$.scheduler=()=>So(j),zt(p,!0),C()},me=(p,v,h)=>{v.component=p;const I=p.vnode.props;p.vnode=v,p.next=null,ll(p,v.props,I,h),fl(p,v.children,h),Nt(),Ro(p),Rt()},ue=(p,v,h,I,P,m,y,g,$=!1)=>{const C=p&&p.children,j=p?p.shapeFlag:0,N=v.children,{patchFlag:H,shapeFlag:X}=v;if(H>0){if(H&128){be(C,N,h,I,P,m,y,g,$);return}else if(H&256){Me(C,N,h,I,P,m,y,g,$);return}}X&8?(j&16&&M(C,P,m),N!==C&&d(h,N)):j&16?X&16?be(C,N,h,I,P,m,y,g,$):M(C,P,m,!0):(j&8&&d(h,""),X&16&&Se(N,h,I,P,m,y,g,$))},Me=(p,v,h,I,P,m,y,g,$)=>{p=p||cs,v=v||cs;const C=p.length,j=v.length,N=Math.min(C,j);let H;for(H=0;H<N;H++){const X=v[H]=$?Bt(v[H]):kt(v[H]);B(p[H],X,h,null,P,m,y,g,$)}C>j?M(p,P,m,!0,!1,N):Se(v,h,I,P,m,y,g,$,N)},be=(p,v,h,I,P,m,y,g,$)=>{let C=0;const j=v.length;let N=p.length-1,H=j-1;for(;C<=N&&C<=H;){const X=p[C],re=v[C]=$?Bt(v[C]):kt(v[C]);if(Zt(X,re))B(X,re,h,null,P,m,y,g,$);else break;C++}for(;C<=N&&C<=H;){const X=p[N],re=v[H]=$?Bt(v[H]):kt(v[H]);if(Zt(X,re))B(X,re,h,null,P,m,y,g,$);else break;N--,H--}if(C>N){if(C<=H){const X=H+1,re=X<j?v[X].el:I;for(;C<=H;)B(null,v[C]=$?Bt(v[C]):kt(v[C]),h,re,P,m,y,g,$),C++}}else if(C>H)for(;C<=N;)_e(p[C],P,m,!0),C++;else{const X=C,re=C,he=new Map;for(C=re;C<=H;C++){const Be=v[C]=$?Bt(v[C]):kt(v[C]);Be.key!=null&&he.set(Be.key,C)}let ge,qe=0;const He=H-re+1;let Ye=!1,De=0;const Et=new Array(He);for(C=0;C<He;C++)Et[C]=0;for(C=X;C<=N;C++){const Be=p[C];if(qe>=He){_e(Be,P,m,!0);continue}let at;if(Be.key!=null)at=he.get(Be.key);else for(ge=re;ge<=H;ge++)if(Et[ge-re]===0&&Zt(Be,v[ge])){at=ge;break}at===void 0?_e(Be,P,m,!0):(Et[at-re]=C+1,at>=De?De=at:Ye=!0,B(Be,v[at],h,null,P,m,y,g,$),qe++)}const ms=Ye?hl(Et):cs;for(ge=ms.length-1,C=He-1;C>=0;C--){const Be=re+C,at=v[Be],hs=v[Be+1],Ds=Be+1<j?hs.el||hs.placeholder:I;Et[C]===0?B(null,at,h,Ds,P,m,y,g,$):Ye&&(ge<0||C!==ms[ge]?Re(at,h,Ds,2):ge--)}}},Re=(p,v,h,I,P=null)=>{const{el:m,type:y,transition:g,children:$,shapeFlag:C}=p;if(C&6){Re(p.component.subTree,v,h,I);return}if(C&128){p.suspense.move(v,h,I);return}if(C&64){y.move(p,v,h,Z);return}if(y===oe){o(m,v,h);for(let N=0;N<$.length;N++)Re($[N],v,h,I);o(p.anchor,v,h);return}if(y===Qs){Q(p,v,h);return}if(I!==2&&C&1&&g)if(I===0)g.beforeEnter(m),o(m,v,h),rt(()=>g.enter(m),P);else{const{leave:N,delayLeave:H,afterLeave:X}=g,re=()=>{p.ctx.isUnmounted?n(m):o(m,v,h)},he=()=>{m._isLeaving&&m[Pt](!0),N(m,()=>{re(),X&&X()})};H?H(m,re,he):he()}else o(m,v,h)},_e=(p,v,h,I=!1,P=!1)=>{const{type:m,props:y,ref:g,children:$,dynamicChildren:C,shapeFlag:j,patchFlag:N,dirs:H,cacheIndex:X}=p;if(N===-2&&(P=!1),g!=null&&(Nt(),Es(g,null,h,p,!0),Rt()),X!=null&&(v.renderCache[X]=void 0),j&256){v.ctx.deactivate(p);return}const re=j&1&&H,he=!As(p);let ge;if(he&&(ge=y&&y.onVnodeBeforeUnmount)&&bt(ge,v,p),j&6)L(p.component,h,I);else{if(j&128){p.suspense.unmount(h,I);return}re&&Wt(p,null,v,"beforeUnmount"),j&64?p.type.remove(p,v,h,Z,I):C&&!C.hasOnce&&(m!==oe||N>0&&N&64)?M(C,v,h,!1,!0):(m===oe&&N&384||!P&&j&16)&&M($,v,h),I&&Ve(p)}(he&&(ge=y&&y.onVnodeUnmounted)||re)&&rt(()=>{ge&&bt(ge,v,p),re&&Wt(p,null,v,"unmounted")},h)},Ve=p=>{const{type:v,el:h,anchor:I,transition:P}=p;if(v===oe){Je(h,I);return}if(v===Qs){U(p);return}const m=()=>{n(h),P&&!P.persisted&&P.afterLeave&&P.afterLeave()};if(p.shapeFlag&1&&P&&!P.persisted){const{leave:y,delayLeave:g}=P,$=()=>y(h,m);g?g(p.el,m,$):$()}else m()},Je=(p,v)=>{let h;for(;p!==v;)h=A(p),n(p),p=h;n(v)},L=(p,v,h)=>{const{bum:I,scope:P,job:m,subTree:y,um:g,m:$,a:C}=p;Ko($),Ko(C),I&&Js(I),P.stop(),m&&(m.flags|=8,_e(y,p,v,h)),g&&rt(g,v),rt(()=>{p.isUnmounted=!0},v)},M=(p,v,h,I=!1,P=!1,m=0)=>{for(let y=m;y<p.length;y++)_e(p[y],v,h,I,P)},W=p=>{if(p.shapeFlag&6)return W(p.component.subTree);if(p.shapeFlag&128)return p.suspense.next();const v=A(p.anchor||p.el),h=v&&v[Ri];return h?A(h):v};let le=!1;const J=(p,v,h)=>{p==null?v._vnode&&_e(v._vnode,null,null,!0):B(v._vnode||null,p,v,null,null,null,h),v._vnode=p,le||(le=!0,Ro(),Va(),le=!1)},Z={p:B,um:_e,m:Re,r:Ve,mt:Ce,mc:Se,pc:ue,pbc:de,n:W,o:e};return{render:J,hydrate:void 0,createApp:al(J)}}function zn({type:e,props:t},s){return s==="svg"&&e==="foreignObject"||s==="mathml"&&e==="annotation-xml"&&t&&t.encoding&&t.encoding.includes("html")?void 0:s}function zt({effect:e,job:t},s){s?(e.flags|=32,t.flags|=4):(e.flags&=-33,t.flags&=-5)}function ml(e,t){return(!e||e&&!e.pendingBranch)&&t&&!t.persisted}function mr(e,t,s=!1){const o=e.children,n=t.children;if(se(o)&&se(n))for(let r=0;r<o.length;r++){const l=o[r];let c=n[r];c.shapeFlag&1&&!c.dynamicChildren&&((c.patchFlag<=0||c.patchFlag===32)&&(c=n[r]=Bt(n[r]),c.el=l.el),!s&&c.patchFlag!==-2&&mr(l,c)),c.type===An&&c.patchFlag!==-1&&(c.el=l.el),c.type===et&&!c.el&&(c.el=l.el)}}function hl(e){const t=e.slice(),s=[0];let o,n,r,l,c;const u=e.length;for(o=0;o<u;o++){const f=e[o];if(f!==0){if(n=s[s.length-1],e[n]<f){t[o]=n,s.push(o);continue}for(r=0,l=s.length-1;r<l;)c=r+l>>1,e[s[c]]<f?r=c+1:l=c;f<e[s[r]]&&(r>0&&(t[o]=s[r-1]),s[r]=o)}}for(r=s.length,l=s[r-1];r-- >0;)s[r]=l,l=t[l];return s}function hr(e){const t=e.subTree.component;if(t)return t.asyncDep&&!t.asyncResolved?t:hr(t)}function Ko(e){if(e)for(let t=0;t<e.length;t++)e[t].flags|=8}const gl=Symbol.for("v-scx"),yl=()=>Xs(gl);function ct(e,t,s){return gr(e,t,s)}function gr(e,t,s=Ie){const{immediate:o,deep:n,flush:r,once:l}=s,c=Ge({},s),u=t&&o||!t&&r!=="post";let f;if(Ns){if(r==="sync"){const E=yl();f=E.__watcherHandles||(E.__watcherHandles=[])}else if(!u){const E=()=>{};return E.stop=Ct,E.resume=Ct,E.pause=Ct,E}}const d=tt;c.call=(E,O,B)=>yt(E,d,O,B);let w=!1;r==="post"?c.scheduler=E=>{rt(E,d&&d.suspense)}:r!=="sync"&&(w=!0,c.scheduler=(E,O)=>{O?E():So(E)}),c.augmentJob=E=>{t&&(E.flags|=4),w&&(E.flags|=2,d&&(E.id=d.uid,E.i=d))};const A=Fi(e,t,c);return Ns&&(f?f.push(A):u&&A()),A}function bl(e,t,s){const o=this.proxy,n=je(e)?e.includes(".")?yr(o,e):()=>o[e]:e.bind(o,o);let r;ce(t)?r=t:(r=t.handler,s=t);const l=qs(this),c=gr(n,r.bind(o),s);return l(),c}function yr(e,t){const s=t.split(".");return()=>{let o=e;for(let n=0;n<s.length&&o;n++)o=o[s[n]];return o}}const _l=(e,t)=>t==="modelValue"||t==="model-value"?e.modelModifiers:e[`${t}Modifiers`]||e[`${Kt(t)}Modifiers`]||e[`${ss(t)}Modifiers`];function wl(e,t,...s){if(e.isUnmounted)return;const o=e.vnode.props||Ie;let n=s;const r=t.startsWith("update:"),l=r&&_l(o,t.slice(7));l&&(l.trim&&(n=s.map(d=>je(d)?d.trim():d)),l.number&&(n=s.map(yn)));let c,u=o[c=Hn(t)]||o[c=Hn(Kt(t))];!u&&r&&(u=o[c=Hn(ss(t))]),u&&yt(u,e,6,n);const f=o[c+"Once"];if(f){if(!e.emitted)e.emitted={};else if(e.emitted[c])return;e.emitted[c]=!0,yt(f,e,6,n)}}const kl=new WeakMap;function br(e,t,s=!1){const o=s?kl:t.emitsCache,n=o.get(e);if(n!==void 0)return n;const r=e.emits;let l={},c=!1;if(!ce(e)){const u=f=>{const d=br(f,t,!0);d&&(c=!0,Ge(l,d))};!s&&t.mixins.length&&t.mixins.forEach(u),e.extends&&u(e.extends),e.mixins&&e.mixins.forEach(u)}return!r&&!c?($e(e)&&o.set(e,null),null):(se(r)?r.forEach(u=>l[u]=null):Ge(l,r),$e(e)&&o.set(e,l),l)}function En(e,t){return!e||!mn(t)?!1:(t=t.slice(2).replace(/Once$/,""),xe(e,t[0].toLowerCase()+t.slice(1))||xe(e,ss(t))||xe(e,t))}function Go(e){const{type:t,vnode:s,proxy:o,withProxy:n,propsOptions:[r],slots:l,attrs:c,emit:u,render:f,renderCache:d,props:w,data:A,setupState:E,ctx:O,inheritAttrs:B}=e,ae=on(e);let q,Y;try{if(s.shapeFlag&4){const U=n||o,K=U;q=kt(f.call(K,U,d,w,E,A,O)),Y=c}else{const U=t;q=kt(U.length>1?U(w,{attrs:c,slots:l,emit:u}):U(w,null)),Y=t.props?c:Sl(c)}}catch(U){Ts.length=0,kn(U,e,1),q=Fe(et)}let Q=q;if(Y&&B!==!1){const U=Object.keys(Y),{shapeFlag:K}=Q;U.length&&K&7&&(r&&U.some(vo)&&(Y=Cl(Y,r)),Q=Yt(Q,Y,!1,!0))}return s.dirs&&(Q=Yt(Q,null,!1,!0),Q.dirs=Q.dirs?Q.dirs.concat(s.dirs):s.dirs),s.transition&&Us(Q,s.transition),q=Q,on(ae),q}const Sl=e=>{let t;for(const s in e)(s==="class"||s==="style"||mn(s))&&((t||(t={}))[s]=e[s]);return t},Cl=(e,t)=>{const s={};for(const o in e)(!vo(o)||!(o.slice(9)in t))&&(s[o]=e[o]);return s};function xl(e,t,s){const{props:o,children:n,component:r}=e,{props:l,children:c,patchFlag:u}=t,f=r.emitsOptions;if(t.dirs||t.transition)return!0;if(s&&u>=0){if(u&1024)return!0;if(u&16)return o?Yo(o,l,f):!!l;if(u&8){const d=t.dynamicProps;for(let w=0;w<d.length;w++){const A=d[w];if(l[A]!==o[A]&&!En(f,A))return!0}}}else return(n||c)&&(!c||!c.$stable)?!0:o===l?!1:o?l?Yo(o,l,f):!0:!!l;return!1}function Yo(e,t,s){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let n=0;n<o.length;n++){const r=o[n];if(t[r]!==e[r]&&!En(s,r))return!0}return!1}function El({vnode:e,parent:t},s){for(;t;){const o=t.subTree;if(o.suspense&&o.suspense.activeBranch===e&&(o.el=e.el),o===e)(e=t.vnode).el=s,t=t.parent;else break}}const _r=e=>e.__isSuspense;function Al(e,t){t&&t.pendingBranch?se(e)?t.effects.push(...e):t.effects.push(e):Ni(e)}const oe=Symbol.for("v-fgt"),An=Symbol.for("v-txt"),et=Symbol.for("v-cmt"),Qs=Symbol.for("v-stc"),Ts=[];let lt=null;function b(e=!1){Ts.push(lt=e?null:[])}function $l(){Ts.pop(),lt=Ts[Ts.length-1]||null}let Ms=1;function ln(e,t=!1){Ms+=e,e<0&&lt&&t&&(lt.hasOnce=!0)}function wr(e){return e.dynamicChildren=Ms>0?lt||cs:null,$l(),Ms>0&&lt&&lt.push(e),e}function k(e,t,s,o,n,r){return wr(a(e,t,s,o,n,r,!0))}function cn(e,t,s,o,n){return wr(Fe(e,t,s,o,n,!0))}function un(e){return e?e.__v_isVNode===!0:!1}function Zt(e,t){return e.type===t.type&&e.key===t.key}const kr=({key:e})=>e??null,Zs=({ref:e,ref_key:t,ref_for:s})=>(typeof e=="number"&&(e=""+e),e!=null?je(e)||ze(e)||ce(e)?{i:vt,r:e,k:t,f:!!s}:e:null);function a(e,t=null,s=null,o=0,n=null,r=e===oe?0:1,l=!1,c=!1){const u={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&kr(t),ref:t&&Zs(t),scopeId:Ga,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetStart:null,targetAnchor:null,staticCount:0,shapeFlag:r,patchFlag:o,dynamicProps:n,dynamicChildren:null,appContext:null,ctx:vt};return c?(Eo(u,s),r&128&&e.normalize(u)):s&&(u.shapeFlag|=je(s)?8:16),Ms>0&&!l&&lt&&(u.patchFlag>0||r&6)&&u.patchFlag!==32&&lt.push(u),u}const Fe=Tl;function Tl(e,t=null,s=null,o=0,n=null,r=!1){if((!e||e===Xi)&&(e=et),un(e)){const c=Yt(e,t,!0);return s&&Eo(c,s),Ms>0&&!r&&lt&&(c.shapeFlag&6?lt[lt.indexOf(e)]=c:lt.push(c)),c.patchFlag=-2,c}if(jl(e)&&(e=e.__vccOpts),t){t=Il(t);let{class:c,style:u}=t;c&&!je(c)&&(t.class=ne(c)),$e(u)&&(ko(u)&&!se(u)&&(u=Ge({},u)),t.style=ht(u))}const l=je(e)?1:_r(e)?128:Wa(e)?64:$e(e)?4:ce(e)?2:0;return a(e,t,s,o,n,l,r,!0)}function Il(e){return e?ko(e)||cr(e)?Ge({},e):e:null}function Yt(e,t,s=!1,o=!1){const{props:n,ref:r,patchFlag:l,children:c,transition:u}=e,f=t?Ol(n||{},t):n,d={__v_isVNode:!0,__v_skip:!0,type:e.type,props:f,key:f&&kr(f),ref:t&&t.ref?s&&r?se(r)?r.concat(Zs(t)):[r,Zs(t)]:Zs(t):r,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:c,target:e.target,targetStart:e.targetStart,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==oe?l===-1?16:l|16:l,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:u,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Yt(e.ssContent),ssFallback:e.ssFallback&&Yt(e.ssFallback),placeholder:e.placeholder,el:e.el,anchor:e.anchor,ctx:e.ctx,ce:e.ce};return u&&o&&Us(d,u.clone(d)),d}function G(e=" ",t=0){return Fe(An,null,e,t)}function it(e,t){const s=Fe(Qs,null,e);return s.staticCount=t,s}function V(e="",t=!1){return t?(b(),cn(et,null,e)):Fe(et,null,e)}function kt(e){return e==null||typeof e=="boolean"?Fe(et):se(e)?Fe(oe,null,e.slice()):un(e)?Bt(e):Fe(An,null,String(e))}function Bt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Yt(e)}function Eo(e,t){let s=0;const{shapeFlag:o}=e;if(t==null)t=null;else if(se(t))s=16;else if(typeof t=="object")if(o&65){const n=t.default;n&&(n._c&&(n._d=!1),Eo(e,n()),n._c&&(n._d=!0));return}else{s=32;const n=t._;!n&&!cr(t)?t._ctx=vt:n===3&&vt&&(vt.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else ce(t)?(t={default:t,_ctx:vt},s=32):(t=String(t),o&64?(s=16,t=[G(t)]):s=8);e.children=t,e.shapeFlag|=s}function Ol(...e){const t={};for(let s=0;s<e.length;s++){const o=e[s];for(const n in o)if(n==="class")t.class!==o.class&&(t.class=ne([t.class,o.class]));else if(n==="style")t.style=ht([t.style,o.style]);else if(mn(n)){const r=t[n],l=o[n];l&&r!==l&&!(se(r)&&r.includes(l))&&(t[n]=r?[].concat(r,l):l)}else n!==""&&(t[n]=o[n])}return t}function bt(e,t,s,o=null){yt(e,t,7,[s,o])}const Pl=rr();let Fl=0;function Ul(e,t,s){const o=e.type,n=(t?t.appContext:e.appContext)||Pl,r={uid:Fl++,vnode:e,type:o,parent:t,appContext:n,root:null,next:null,subTree:null,effect:null,update:null,job:null,scope:new ai(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(n.provides),ids:t?t.ids:["",0,0],accessCache:null,renderCache:[],components:null,directives:null,propsOptions:dr(o,n),emitsOptions:br(o,n),emit:null,emitted:null,propsDefaults:Ie,inheritAttrs:o.inheritAttrs,ctx:Ie,data:Ie,props:Ie,attrs:Ie,slots:Ie,refs:Ie,setupState:Ie,setupContext:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return r.ctx={_:r},r.root=t?t.root:r,r.emit=wl.bind(null,r),e.ce&&e.ce(r),r}let tt=null;const Sr=()=>tt||vt;let dn,co;{const e=bn(),t=(s,o)=>{let n;return(n=e[s])||(n=e[s]=[]),n.push(o),r=>{n.length>1?n.forEach(l=>l(r)):n[0](r)}};dn=t("__VUE_INSTANCE_SETTERS__",s=>tt=s),co=t("__VUE_SSR_SETTERS__",s=>Ns=s)}const qs=e=>{const t=tt;return dn(e),e.scope.on(),()=>{e.scope.off(),dn(t)}},Wo=()=>{tt&&tt.scope.off(),dn(null)};function Cr(e){return e.vnode.shapeFlag&4}let Ns=!1;function Ml(e,t=!1,s=!1){t&&co(t);const{props:o,children:n}=e.vnode,r=Cr(e);il(e,o,r,t),dl(e,n,s||t);const l=r?Nl(e,t):void 0;return t&&co(!1),l}function Nl(e,t){const s=e.type;e.accessCache=Object.create(null),e.proxy=new Proxy(e.ctx,Qi);const{setup:o}=s;if(o){Nt();const n=e.setupContext=o.length>1?Ll(e):null,r=qs(e),l=js(o,e,0,[e.props,n]),c=ya(l);if(Rt(),r(),(c||e.sp)&&!As(e)&&er(e),c){if(l.then(Wo,Wo),t)return l.then(u=>{zo(e,u)}).catch(u=>{kn(u,e,0)});e.asyncDep=l}else zo(e,l)}else xr(e)}function zo(e,t,s){ce(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:$e(t)&&(e.setupState=qa(t)),xr(e)}function xr(e,t,s){const o=e.type;e.render||(e.render=o.render||Ct);{const n=qs(e);Nt();try{Zi(e)}finally{Rt(),n()}}}const Rl={get(e,t){return We(e,"get",""),e[t]}};function Ll(e){const t=s=>{e.exposed=s||{}};return{attrs:new Proxy(e.attrs,Rl),slots:e.slots,emit:e.emit,expose:t}}function $n(e){return e.exposed?e.exposeProxy||(e.exposeProxy=new Proxy(qa(Ei(e.exposed)),{get(t,s){if(s in t)return t[s];if(s in $s)return $s[s](e)},has(t,s){return s in t||s in $s}})):e.proxy}function jl(e){return ce(e)&&"__vccOpts"in e}const te=(e,t)=>Oi(e,t,Ns);function ql(e,t,s){try{ln(-1);const o=arguments.length;return o===2?$e(t)&&!se(t)?un(t)?Fe(e,null,[t]):Fe(e,t):Fe(e,null,t):(o>3?s=Array.prototype.slice.call(arguments,2):o===3&&un(s)&&(s=[s]),Fe(e,t,s))}finally{ln(1)}}const Dl="3.5.24";/**
* @vue/runtime-dom v3.5.24
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let uo;const Jo=typeof window<"u"&&window.trustedTypes;if(Jo)try{uo=Jo.createPolicy("vue",{createHTML:e=>e})}catch{}const Er=uo?e=>uo.createHTML(e):e=>e,Hl="http://www.w3.org/2000/svg",Bl="http://www.w3.org/1998/Math/MathML",Ot=typeof document<"u"?document:null,Xo=Ot&&Ot.createElement("template"),Vl={insert:(e,t,s)=>{t.insertBefore(e,s||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,s,o)=>{const n=t==="svg"?Ot.createElementNS(Hl,e):t==="mathml"?Ot.createElementNS(Bl,e):s?Ot.createElement(e,{is:s}):Ot.createElement(e);return e==="select"&&o&&o.multiple!=null&&n.setAttribute("multiple",o.multiple),n},createText:e=>Ot.createTextNode(e),createComment:e=>Ot.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Ot.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,s,o,n,r){const l=s?s.previousSibling:t.lastChild;if(n&&(n===r||n.nextSibling))for(;t.insertBefore(n.cloneNode(!0),s),!(n===r||!(n=n.nextSibling)););else{Xo.innerHTML=Er(o==="svg"?`<svg>${e}</svg>`:o==="mathml"?`<math>${e}</math>`:e);const c=Xo.content;if(o==="svg"||o==="mathml"){const u=c.firstChild;for(;u.firstChild;)c.appendChild(u.firstChild);c.removeChild(u)}t.insertBefore(c,s)}return[l?l.nextSibling:t.firstChild,s?s.previousSibling:t.lastChild]}},qt="transition",_s="animation",Rs=Symbol("_vtc"),Ar={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},Kl=Ge({},za,Ar),Gl=e=>(e.displayName="Transition",e.props=Kl,e),Yl=Gl((e,{slots:t})=>ql(qi,Wl(e),t)),Jt=(e,t=[])=>{se(e)?e.forEach(s=>s(...t)):e&&e(...t)},Qo=e=>e?se(e)?e.some(t=>t.length>1):e.length>1:!1;function Wl(e){const t={};for(const D in e)D in Ar||(t[D]=e[D]);if(e.css===!1)return t;const{name:s="v",type:o,duration:n,enterFromClass:r=`${s}-enter-from`,enterActiveClass:l=`${s}-enter-active`,enterToClass:c=`${s}-enter-to`,appearFromClass:u=r,appearActiveClass:f=l,appearToClass:d=c,leaveFromClass:w=`${s}-leave-from`,leaveActiveClass:A=`${s}-leave-active`,leaveToClass:E=`${s}-leave-to`}=e,O=zl(n),B=O&&O[0],ae=O&&O[1],{onBeforeEnter:q,onEnter:Y,onEnterCancelled:Q,onLeave:U,onLeaveCancelled:K,onBeforeAppear:ie=q,onAppear:ke=Y,onAppearCancelled:Se=Q}=t,z=(D,ve,Ce,Ue)=>{D._enterCancelled=Ue,Xt(D,ve?d:c),Xt(D,ve?f:l),Ce&&Ce()},de=(D,ve)=>{D._isLeaving=!1,Xt(D,w),Xt(D,E),Xt(D,A),ve&&ve()},fe=D=>(ve,Ce)=>{const Ue=D?ke:Y,Ae=()=>z(ve,D,Ce);Jt(Ue,[ve,Ae]),Zo(()=>{Xt(ve,D?u:r),It(ve,D?d:c),Qo(Ue)||ea(ve,o,B,Ae)})};return Ge(t,{onBeforeEnter(D){Jt(q,[D]),It(D,r),It(D,l)},onBeforeAppear(D){Jt(ie,[D]),It(D,u),It(D,f)},onEnter:fe(!1),onAppear:fe(!0),onLeave(D,ve){D._isLeaving=!0;const Ce=()=>de(D,ve);It(D,w),D._enterCancelled?(It(D,A),na(D)):(na(D),It(D,A)),Zo(()=>{D._isLeaving&&(Xt(D,w),It(D,E),Qo(U)||ea(D,o,ae,Ce))}),Jt(U,[D,Ce])},onEnterCancelled(D){z(D,!1,void 0,!0),Jt(Q,[D])},onAppearCancelled(D){z(D,!0,void 0,!0),Jt(Se,[D])},onLeaveCancelled(D){de(D),Jt(K,[D])}})}function zl(e){if(e==null)return null;if($e(e))return[Jn(e.enter),Jn(e.leave)];{const t=Jn(e);return[t,t]}}function Jn(e){return Jr(e)}function It(e,t){t.split(/\s+/).forEach(s=>s&&e.classList.add(s)),(e[Rs]||(e[Rs]=new Set)).add(t)}function Xt(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.remove(o));const s=e[Rs];s&&(s.delete(t),s.size||(e[Rs]=void 0))}function Zo(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Jl=0;function ea(e,t,s,o){const n=e._endId=++Jl,r=()=>{n===e._endId&&o()};if(s!=null)return setTimeout(r,s);const{type:l,timeout:c,propCount:u}=Xl(e,t);if(!l)return o();const f=l+"end";let d=0;const w=()=>{e.removeEventListener(f,A),r()},A=E=>{E.target===e&&++d>=u&&w()};setTimeout(()=>{d<u&&w()},c+1),e.addEventListener(f,A)}function Xl(e,t){const s=window.getComputedStyle(e),o=O=>(s[O]||"").split(", "),n=o(`${qt}Delay`),r=o(`${qt}Duration`),l=ta(n,r),c=o(`${_s}Delay`),u=o(`${_s}Duration`),f=ta(c,u);let d=null,w=0,A=0;t===qt?l>0&&(d=qt,w=l,A=r.length):t===_s?f>0&&(d=_s,w=f,A=u.length):(w=Math.max(l,f),d=w>0?l>f?qt:_s:null,A=d?d===qt?r.length:u.length:0);const E=d===qt&&/\b(?:transform|all)(?:,|$)/.test(o(`${qt}Property`).toString());return{type:d,timeout:w,propCount:A,hasTransform:E}}function ta(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((s,o)=>sa(s)+sa(e[o])))}function sa(e){return e==="auto"?0:Number(e.slice(0,-1).replace(",","."))*1e3}function na(e){return(e?e.ownerDocument:document).body.offsetHeight}function Ql(e,t,s){const o=e[Rs];o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?e.removeAttribute("class"):s?e.setAttribute("class",t):e.className=t}const fn=Symbol("_vod"),$r=Symbol("_vsh"),Tr={name:"show",beforeMount(e,{value:t},{transition:s}){e[fn]=e.style.display==="none"?"":e.style.display,s&&t?s.beforeEnter(e):ws(e,t)},mounted(e,{value:t},{transition:s}){s&&t&&s.enter(e)},updated(e,{value:t,oldValue:s},{transition:o}){!t!=!s&&(o?t?(o.beforeEnter(e),ws(e,!0),o.enter(e)):o.leave(e,()=>{ws(e,!1)}):ws(e,t))},beforeUnmount(e,{value:t}){ws(e,t)}};function ws(e,t){e.style.display=t?e[fn]:"none",e[$r]=!t}const Zl=Symbol(""),ec=/(?:^|;)\s*display\s*:/;function tc(e,t,s){const o=e.style,n=je(s);let r=!1;if(s&&!n){if(t)if(je(t))for(const l of t.split(";")){const c=l.slice(0,l.indexOf(":")).trim();s[c]==null&&en(o,c,"")}else for(const l in t)s[l]==null&&en(o,l,"");for(const l in s)l==="display"&&(r=!0),en(o,l,s[l])}else if(n){if(t!==s){const l=o[Zl];l&&(s+=";"+l),o.cssText=s,r=ec.test(s)}}else t&&e.removeAttribute("style");fn in e&&(e[fn]=r?o.display:"",e[$r]&&(o.display="none"))}const oa=/\s*!important$/;function en(e,t,s){if(se(s))s.forEach(o=>en(e,t,o));else if(s==null&&(s=""),t.startsWith("--"))e.setProperty(t,s);else{const o=sc(e,t);oa.test(s)?e.setProperty(ss(o),s.replace(oa,""),"important"):e[o]=s}}const aa=["Webkit","Moz","ms"],Xn={};function sc(e,t){const s=Xn[t];if(s)return s;let o=Kt(t);if(o!=="filter"&&o in e)return Xn[t]=o;o=wa(o);for(let n=0;n<aa.length;n++){const r=aa[n]+o;if(r in e)return Xn[t]=r}return t}const ra="http://www.w3.org/1999/xlink";function ia(e,t,s,o,n,r=si(t)){o&&t.startsWith("xlink:")?s==null?e.removeAttributeNS(ra,t.slice(6,t.length)):e.setAttributeNS(ra,t,s):s==null||r&&!Sa(s)?e.removeAttribute(t):e.setAttribute(t,r?"":xt(s)?String(s):s)}function la(e,t,s,o,n){if(t==="innerHTML"||t==="textContent"){s!=null&&(e[t]=t==="innerHTML"?Er(s):s);return}const r=e.tagName;if(t==="value"&&r!=="PROGRESS"&&!r.includes("-")){const c=r==="OPTION"?e.getAttribute("value")||"":e.value,u=s==null?e.type==="checkbox"?"on":"":String(s);(c!==u||!("_value"in e))&&(e.value=u),s==null&&e.removeAttribute(t),e._value=s;return}let l=!1;if(s===""||s==null){const c=typeof e[t];c==="boolean"?s=Sa(s):s==null&&c==="string"?(s="",l=!0):c==="number"&&(s=0,l=!0)}try{e[t]=s}catch{}l&&e.removeAttribute(n||t)}function es(e,t,s,o){e.addEventListener(t,s,o)}function nc(e,t,s,o){e.removeEventListener(t,s,o)}const ca=Symbol("_vei");function oc(e,t,s,o,n=null){const r=e[ca]||(e[ca]={}),l=r[t];if(o&&l)l.value=o;else{const[c,u]=ac(t);if(o){const f=r[t]=lc(o,n);es(e,c,f,u)}else l&&(nc(e,c,l,u),r[t]=void 0)}}const ua=/(?:Once|Passive|Capture)$/;function ac(e){let t;if(ua.test(e)){t={};let o;for(;o=e.match(ua);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):ss(e.slice(2)),t]}let Qn=0;const rc=Promise.resolve(),ic=()=>Qn||(rc.then(()=>Qn=0),Qn=Date.now());function lc(e,t){const s=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=s.attached)return;yt(cc(o,s.value),t,5,[o])};return s.value=e,s.attached=ic(),s}function cc(e,t){if(se(t)){const s=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{s.call(e),e._stopped=!0},t.map(o=>n=>!n._stopped&&o&&o(n))}else return t}const da=e=>e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123,uc=(e,t,s,o,n,r)=>{const l=n==="svg";t==="class"?Ql(e,o,l):t==="style"?tc(e,s,o):mn(t)?vo(t)||oc(e,t,s,o,r):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):dc(e,t,o,l))?(la(e,t,o),!e.tagName.includes("-")&&(t==="value"||t==="checked"||t==="selected")&&ia(e,t,o,l,r,t!=="value")):e._isVueCE&&(/[A-Z]/.test(t)||!je(o))?la(e,Kt(t),o,r,t):(t==="true-value"?e._trueValue=o:t==="false-value"&&(e._falseValue=o),ia(e,t,o,l))};function dc(e,t,s,o){if(o)return!!(t==="innerHTML"||t==="textContent"||t in e&&da(t)&&ce(s));if(t==="spellcheck"||t==="draggable"||t==="translate"||t==="autocorrect"||t==="sandbox"&&e.tagName==="IFRAME"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA")return!1;if(t==="width"||t==="height"){const n=e.tagName;if(n==="IMG"||n==="VIDEO"||n==="CANVAS"||n==="SOURCE")return!1}return da(t)&&je(s)?!1:t in e}const vn=e=>{const t=e.props["onUpdate:modelValue"]||!1;return se(t)?s=>Js(t,s):t};function fc(e){e.target.composing=!0}function fa(e){const t=e.target;t.composing&&(t.composing=!1,t.dispatchEvent(new Event("input")))}const ps=Symbol("_assign");function va(e,t,s){return t&&(e=e.trim()),s&&(e=yn(e)),e}const Mt={created(e,{modifiers:{lazy:t,trim:s,number:o}},n){e[ps]=vn(n);const r=o||n.props&&n.props.type==="number";es(e,t?"change":"input",l=>{l.target.composing||e[ps](va(e.value,s,r))}),(s||r)&&es(e,"change",()=>{e.value=va(e.value,s,r)}),t||(es(e,"compositionstart",fc),es(e,"compositionend",fa),es(e,"change",fa))},mounted(e,{value:t}){e.value=t??""},beforeUpdate(e,{value:t,oldValue:s,modifiers:{lazy:o,trim:n,number:r}},l){if(e[ps]=vn(l),e.composing)return;const c=(r||e.type==="number")&&!/^0\d/.test(e.value)?yn(e.value):e.value,u=t??"";c!==u&&(document.activeElement===e&&e.type!=="range"&&(o&&t===s||n&&e.value.trim()===u)||(e.value=u))}},St={deep:!0,created(e,{value:t,modifiers:{number:s}},o){const n=hn(t);es(e,"change",()=>{const r=Array.prototype.filter.call(e.options,l=>l.selected).map(l=>s?yn(pn(l)):pn(l));e[ps](e.multiple?n?new Set(r):r:r[0]),e._assigning=!0,Ha(()=>{e._assigning=!1})}),e[ps]=vn(o)},mounted(e,{value:t}){pa(e,t)},beforeUpdate(e,t,s){e[ps]=vn(s)},updated(e,{value:t}){e._assigning||pa(e,t)}};function pa(e,t){const s=e.multiple,o=se(t);if(!(s&&!o&&!hn(t))){for(let n=0,r=e.options.length;n<r;n++){const l=e.options[n],c=pn(l);if(s)if(o){const u=typeof c;u==="string"||u==="number"?l.selected=t.some(f=>String(f)===String(c)):l.selected=oi(t,c)>-1}else l.selected=t.has(c);else if(_n(pn(l),t)){e.selectedIndex!==n&&(e.selectedIndex=n);return}}!s&&e.selectedIndex!==-1&&(e.selectedIndex=-1)}}function pn(e){return"_value"in e?e._value:e.value}const vc=["ctrl","shift","alt","meta"],pc={stop:e=>e.stopPropagation(),prevent:e=>e.preventDefault(),self:e=>e.target!==e.currentTarget,ctrl:e=>!e.ctrlKey,shift:e=>!e.shiftKey,alt:e=>!e.altKey,meta:e=>!e.metaKey,left:e=>"button"in e&&e.button!==0,middle:e=>"button"in e&&e.button!==1,right:e=>"button"in e&&e.button!==2,exact:(e,t)=>vc.some(s=>e[`${s}Key`]&&!t.includes(s))},ft=(e,t)=>{const s=e._withMods||(e._withMods={}),o=t.join(".");return s[o]||(s[o]=(n,...r)=>{for(let l=0;l<t.length;l++){const c=pc[t[l]];if(c&&c(n,t))return}return e(n,...r)})},mc=Ge({patchProp:uc},Vl);let ma;function hc(){return ma||(ma=vl(mc))}const gc=(...e)=>{const t=hc().createApp(...e),{mount:s}=t;return t.mount=o=>{const n=bc(o);if(!n)return;const r=t._component;!ce(r)&&!r.render&&!r.template&&(r.template=n.innerHTML),n.nodeType===1&&(n.textContent="");const l=s(n,!1,yc(n));return n instanceof Element&&(n.removeAttribute("v-cloak"),n.setAttribute("data-v-app","")),l},t};function yc(e){if(e instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&e instanceof MathMLElement)return"mathml"}function bc(e){return je(e)?document.querySelector(e):e}const ut=(e,t)=>{const s=e.__vccOpts||e;for(const[o,n]of t)s[o]=n;return s},_c={class:"loading-container"},wc={__name:"LoadingState",props:{message:{type:String,default:"Loading student data..."}},setup(e){return(t,s)=>(b(),k("div",_c,[s[0]||(s[0]=a("div",{class:"spinner"},null,-1)),a("p",null,S(e.message),1)]))}},kc=ut(wc,[["__scopeId","data-v-5a5ef9a8"]]),Sc={class:"error-container"},Cc={__name:"ErrorState",props:{title:{type:String,default:"Something went wrong"},message:{type:String,required:!0},showRetry:{type:Boolean,default:!0}},emits:["retry"],setup(e,{emit:t}){return(s,o)=>(b(),k("div",Sc,[o[1]||(o[1]=a("div",{class:"error-icon"},"",-1)),a("h3",null,S(e.title),1),a("p",null,S(e.message),1),e.showRetry?(b(),k("button",{key:0,onClick:o[0]||(o[0]=n=>s.$emit("retry")),class:"retry-button"}," Try Again ")):V("",!0)]))}},xc=ut(Cc,[["__scopeId","data-v-fed208d7"]]),Ec={class:"staff-overview-header"},Ac={class:"header-content"},$c={class:"header-meta"},Tc={class:"staff-name"},Ic={class:"student-count"},Oc={__name:"StaffOverviewHeader",props:{staffMember:{type:Object,required:!0},totalStudents:{type:Number,default:0}},setup(e){const t=e,s={staff_admin:"Staff Admin",tutor:"Tutor",head_of_year:"Head of Year",subject_teacher:"Subject Teacher"},o=te(()=>{var n;return((n=t.staffMember.roles)==null?void 0:n.map(r=>s[r]||r))||[]});return(n,r)=>(b(),k("div",Ec,[a("div",Ac,[r[0]||(r[0]=a("h1",null,"Staff Overview",-1)),a("div",$c,[a("span",Tc,S(e.staffMember.name),1),(b(!0),k(oe,null,Pe(o.value,l=>(b(),k("span",{class:"role-badge",key:l},S(l),1))),128)),a("span",Ic,S(e.totalStudents)+" students",1)])])]))}},Pc=ut(Oc,[["__scopeId","data-v-af34e02e"]]),Fc={class:"filter-bar"},Uc={class:"filter-label-row"},Mc=["title"],Nc=["value"],Rc={class:"filter-label-row"},Lc=["title"],jc=["value"],qc={class:"filter-label-row"},Dc=["title"],Hc=["value"],Bc={class:"filter-label-row"},Vc=["title"],Kc={class:"filter-label-row"},Gc=["title"],Yc={__name:"FilterBar",props:{filters:{type:Object,required:!0},lockedFilters:{type:Object,default:()=>({cycle:!1,group:!1,year:!1,status:!1,search:!1})},preservedValues:{type:Object,default:()=>({})}},emits:["filter-changed","lock-changed"],setup(e,{emit:t}){const s=e,o=t,n=F(String(s.preservedValues.cycle||"1")),r=F(String(s.preservedValues.group||"")),l=F(String(s.preservedValues.year||"")),c=F(String(s.preservedValues.status||"")),u=F(String(s.preservedValues.search||""));ct(()=>s.preservedValues,A=>{A.cycle!==void 0&&n.value!==String(A.cycle||"")&&(n.value=String(A.cycle||"")),A.group!==void 0&&r.value!==(A.group||"")&&(r.value=A.group||""),A.year!==void 0&&l.value!==(A.year||"")&&(l.value=A.year||""),A.status!==void 0&&c.value!==(A.status||"")&&(c.value=A.status||""),A.search!==void 0&&u.value!==(A.search||"")&&(u.value=A.search||"")},{deep:!0,immediate:!1});const f=A=>{const E={...s.lockedFilters};E[A]=!E[A],o("lock-changed",E)},d=()=>{o("filter-changed",{cycle:n.value||"",group:r.value||"",year:l.value||"",status:c.value||"",search:u.value||""})},w=()=>{s.lockedFilters.cycle||(n.value="1"),s.lockedFilters.group||(r.value=""),s.lockedFilters.year||(l.value=""),s.lockedFilters.status||(c.value=""),s.lockedFilters.search||(u.value=""),d()};return(A,E)=>(b(),k("div",Fc,[a("div",{class:ne(["filter-group",{locked:e.lockedFilters.cycle}])},[a("div",Uc,[E[10]||(E[10]=a("label",{for:"cycle-filter"},"Cycle:",-1)),a("button",{onClick:E[0]||(E[0]=O=>f("cycle")),class:"lock-button",title:e.lockedFilters.cycle?"Unlock filter":"Lock filter"},S(e.lockedFilters.cycle?"":""),9,Mc)]),Le(a("select",{id:"cycle-filter","onUpdate:modelValue":E[1]||(E[1]=O=>n.value=O),onChange:d},[(b(!0),k(oe,null,Pe(e.filters.cycles,O=>(b(),k("option",{key:O,value:O}," Cycle "+S(O),9,Nc))),128))],544),[[St,n.value]])],2),a("div",{class:ne(["filter-group",{locked:e.lockedFilters.group}])},[a("div",Rc,[E[11]||(E[11]=a("label",{for:"group-filter"},"Group:",-1)),a("button",{onClick:E[2]||(E[2]=O=>f("group")),class:"lock-button",title:e.lockedFilters.group?"Unlock filter":"Lock filter"},S(e.lockedFilters.group?"":""),9,Lc)]),Le(a("select",{id:"group-filter","onUpdate:modelValue":E[3]||(E[3]=O=>r.value=O),onChange:d},[E[12]||(E[12]=a("option",{value:""},"All Groups",-1)),(b(!0),k(oe,null,Pe(e.filters.groups,O=>(b(),k("option",{key:O,value:O},S(O),9,jc))),128))],544),[[St,r.value]])],2),a("div",{class:ne(["filter-group",{locked:e.lockedFilters.year}])},[a("div",qc,[E[13]||(E[13]=a("label",{for:"year-filter"},"Year:",-1)),a("button",{onClick:E[4]||(E[4]=O=>f("year")),class:"lock-button",title:e.lockedFilters.year?"Unlock filter":"Lock filter"},S(e.lockedFilters.year?"":""),9,Dc)]),Le(a("select",{id:"year-filter","onUpdate:modelValue":E[5]||(E[5]=O=>l.value=O),onChange:d},[E[14]||(E[14]=a("option",{value:""},"All Years",-1)),(b(!0),k(oe,null,Pe(e.filters.yearGroups,O=>(b(),k("option",{key:O,value:O}," Year "+S(O),9,Hc))),128))],544),[[St,l.value]])],2),a("div",{class:ne(["filter-group",{locked:e.lockedFilters.status}])},[a("div",Bc,[E[15]||(E[15]=a("label",{for:"status-filter"},"Status:",-1)),a("button",{onClick:E[6]||(E[6]=O=>f("status")),class:"lock-button",title:e.lockedFilters.status?"Unlock filter":"Lock filter"},S(e.lockedFilters.status?"":""),9,Vc)]),Le(a("select",{id:"status-filter","onUpdate:modelValue":E[7]||(E[7]=O=>c.value=O),onChange:d},[...E[16]||(E[16]=[a("option",{value:""},"All Students",-1),a("option",{value:"completed"},"Completed",-1),a("option",{value:"not_completed"},"Not Completed",-1)])],544),[[St,c.value]])],2),a("div",{class:ne(["filter-group",{locked:e.lockedFilters.search}])},[a("div",Kc,[E[17]||(E[17]=a("label",{for:"search-input"},"Search:",-1)),a("button",{onClick:E[8]||(E[8]=O=>f("search")),class:"lock-button",title:e.lockedFilters.search?"Unlock filter":"Lock filter"},S(e.lockedFilters.search?"":""),9,Gc)]),Le(a("input",{id:"search-input",type:"text","onUpdate:modelValue":E[9]||(E[9]=O=>u.value=O),onInput:d,placeholder:"Search by name...",class:"search-input"},null,544),[[Mt,u.value]])],2),a("button",{onClick:w,class:"clear-button"},"Clear Filters")]))}},Wc=ut(Yc,[["__scopeId","data-v-36a3b4fc"]]),zc={class:"smart-filters-section"},Jc={class:"header-left"},Xc={class:"expand-icon"},Qc={key:0,class:"filter-count-badge"},Zc={class:"smart-filters-content"},eu={key:0,class:"no-filters-message"},tu={key:1,class:"smart-filters-list"},su=["onUpdate:modelValue"],nu=["onUpdate:modelValue"],ou=["onUpdate:modelValue"],au=["onClick"],ru={__name:"SmartFilters",props:{modelValue:{type:Array,default:()=>[]}},emits:["update:modelValue"],setup(e,{emit:t}){const s=F(!1),o=e,n=t,r=F([...o.modelValue]);let l=0;const c=()=>{s.value=!s.value},u=()=>{r.value.push({id:`filter-${Date.now()}-${l++}`,dimension:"vision",operator:"gte",value:5}),s.value=!0,d()},f=w=>{r.value.splice(w,1),d()},d=()=>{n("update:modelValue",r.value)};return(w,A)=>(b(),k("div",zc,[a("div",{class:"smart-filters-header",onClick:c},[a("div",Jc,[a("span",Xc,S(s.value?"":""),1),A[0]||(A[0]=a("h3",null,"Smart Filters",-1)),r.value.length>0?(b(),k("span",Qc,S(r.value.length),1)):V("",!0)]),a("button",{onClick:ft(u,["stop"]),class:ne(["add-filter-button",{compact:!s.value}])}," + ",2)]),Le(a("div",Zc,[r.value.length===0?(b(),k("div",eu,[...A[1]||(A[1]=[a("p",null,'Click "+ Add Filter" to filter by VESPA scores (e.g., Vision  7)',-1)])])):(b(),k("div",tu,[(b(!0),k(oe,null,Pe(r.value,(E,O)=>(b(),k("div",{key:E.id,class:"smart-filter-row"},[Le(a("select",{"onUpdate:modelValue":B=>E.dimension=B,onChange:d,class:"filter-select dimension-select"},[...A[2]||(A[2]=[it('<option value="vision" data-v-1f780447>Vision</option><option value="effort" data-v-1f780447>Effort</option><option value="systems" data-v-1f780447>Systems</option><option value="practice" data-v-1f780447>Practice</option><option value="attitude" data-v-1f780447>Attitude</option><option value="overall" data-v-1f780447>Overall</option>',6)])],40,su),[[St,E.dimension]]),Le(a("select",{"onUpdate:modelValue":B=>E.operator=B,onChange:d,class:"filter-select operator-select"},[...A[3]||(A[3]=[it('<option value="gt" data-v-1f780447>Greater than</option><option value="gte" data-v-1f780447>Greater or equal to</option><option value="lt" data-v-1f780447>Less than</option><option value="lte" data-v-1f780447>Less than or equal to</option><option value="eq" data-v-1f780447>Equal to</option>',5)])],40,nu),[[St,E.operator]]),Le(a("input",{type:"number","onUpdate:modelValue":B=>E.value=B,onInput:d,min:"0",max:"10",step:"0.1",class:"filter-input value-input",placeholder:"0-10"},null,40,ou),[[Mt,E.value,void 0,{number:!0}]]),a("button",{onClick:B=>f(O),class:"remove-filter-button",title:"Remove filter"},"  ",8,au)]))),128))]))],512),[[Tr,s.value]])]))}},iu=ut(ru,[["__scopeId","data-v-1f780447"]]),is=e=>{if(e==null)return"#f5f5f5";const t=parseFloat(e);return t>=9?"#86efac":t>=7?"#bbf7d0":t>=5?"#fed7aa":t>=3?"#fee2e2":"#ffb5bb"},lu={class:"modal-container"},cu={class:"modal-header"},uu={class:"modal-body"},du={class:"text-content"},fu={__name:"TextViewModal",props:{isOpen:{type:Boolean,required:!0},title:{type:String,default:"View Text"},text:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const s=t,o=()=>{s("close")};return(n,r)=>e.isOpen?(b(),k("div",{key:0,class:"modal-overlay",onClick:ft(o,["self"])},[a("div",lu,[a("div",cu,[a("h3",null,S(e.title),1),a("button",{class:"close-button",onClick:o},"")]),a("div",uu,[a("div",du,S(e.text),1)])])])):V("",!0)}},vu=ut(fu,[["__scopeId","data-v-5ffca5e6"]]),pu={class:"modal-container"},mu={class:"modal-header"},hu={class:"modal-body"},gu=["placeholder","disabled"],yu={class:"modal-footer"},bu={key:0,class:"error-text"},_u={class:"button-group"},wu=["disabled"],ku=["disabled"],Su={__name:"EditableTextModal",props:{isOpen:{type:Boolean,required:!0},title:{type:String,default:"Edit Text"},text:{type:String,default:""},placeholder:{type:String,default:"Enter text here..."}},emits:["close","save"],setup(e,{emit:t}){const s=e,o=t,n=F(""),r=F(""),l=F(!1),c=F(null);ct(()=>[s.isOpen,s.text],([w,A])=>{w&&(n.value=A||"",r.value=A||"",c.value=null)},{immediate:!0});const u=te(()=>n.value.trim()!==r.value.trim()),f=async()=>{if(u.value){l.value=!0,c.value=null;try{await o("save",n.value),o("close")}catch(w){c.value=w.message||"Failed to save"}finally{l.value=!1}}},d=()=>{u.value&&!confirm("You have unsaved changes. Close without saving?")||o("close")};return(w,A)=>e.isOpen?(b(),k("div",{key:0,class:"modal-overlay",onClick:ft(d,["self"])},[a("div",pu,[a("div",mu,[a("h3",null,S(e.title),1),a("button",{class:"close-button",onClick:d},"")]),a("div",hu,[Le(a("textarea",{"onUpdate:modelValue":A[0]||(A[0]=E=>n.value=E),class:"edit-textarea",placeholder:e.placeholder,rows:"12",disabled:l.value},null,8,gu),[[Mt,n.value]])]),a("div",yu,[c.value?(b(),k("span",bu,S(c.value),1)):V("",!0),a("div",_u,[a("button",{onClick:d,class:"cancel-button",disabled:l.value}," Cancel ",8,wu),a("button",{onClick:f,class:"save-button",disabled:l.value||!u.value},S(l.value?"Saving...":"Save Changes"),9,ku)])])])])):V("",!0)}},ha=ut(Su,[["__scopeId","data-v-e2fc5fac"]]),mt="https://vespa-dashboard-9a1f84ee5341.herokuapp.com",Qe={async getStaffOverview(e,t=null){try{let s=`${mt}/api/vespa/staff-overview?email=${encodeURIComponent(e)}`;t!=null&&t!==""&&(s+=`&cycle=${t}`);const o=await fetch(s);if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);return await o.json()}catch(s){throw console.error("[Staff API] Error fetching overview:",s),s}},async saveStudentGoals(e,t,s){try{console.log("[Staff API] Saving student goals:",{studentEmail:e,cycle:t,knackRecordId:s.knackRecordId});const o=await fetch(`${mt}/api/vespa/report/save-goals`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentEmail:e,cycle:t,goalText:s.goalText||"",goalSetDate:s.goalSetDate||null,goalDueDate:s.goalDueDate||null,knackRecordId:s.knackRecordId||null})});if(!o.ok){const r=await o.json();throw new Error(r.error||`HTTP error! status: ${o.status}`)}const n=await o.json();return console.log("[Staff API] Goals saved successfully:",n),n}catch(o){throw console.error("[Staff API] Error saving goals:",o),o}},async saveCoachingComments(e,t,s){try{console.log("[Staff API] Saving coaching comments:",{studentEmail:e,cycle:t,knackRecordId:s.knackRecordId});let o=null;if(typeof Knack<"u"&&Knack.getUserAttributes){const l=Knack.getUserAttributes();o=l==null?void 0:l.email}if(!o)throw new Error("Staff email not available");const n=await fetch(`${mt}/api/vespa/report/save-coaching`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({studentEmail:e,staffEmail:o,cycle:t,coachingText:s.coachingText||"",coachingDate:s.coachingDate||null,knackRecordId:s.knackRecordId||null})});if(!n.ok){const l=await n.json();throw new Error(l.error||`HTTP error! status: ${n.status}`)}const r=await n.json();return console.log("[Staff API] Coaching comments saved successfully:",r),r}catch(o){throw console.error("[Staff API] Error saving coaching comments:",o),o}},async getAcademicProfile(e,t="current"){try{let s=`${mt}/api/academic-profile/${encodeURIComponent(e)}`;const o=(t||"").toString().trim();o&&o.toLowerCase()!=="current"&&(s+=`?academic_year=${encodeURIComponent(o)}`);const n=await fetch(s);if(!n.ok){const r=await n.json().catch(()=>null);throw new Error((r==null?void 0:r.error)||`HTTP error! status: ${n.status}`)}return await n.json()}catch(s){throw console.error("[Staff API] Error fetching academic profile:",s),s}},async getUcasApplication(e,t="current"){try{let s=`${mt}/api/academic-profile/${encodeURIComponent(e)}/ucas-application`;const o=(t||"").toString().trim();o&&o.toLowerCase()!=="current"&&(s+=`?academic_year=${encodeURIComponent(o)}`);const n=await fetch(s);if(!n.ok){const r=await n.json().catch(()=>null);throw new Error((r==null?void 0:r.error)||`HTTP error! status: ${n.status}`)}return await n.json()}catch(s){throw console.error("[Staff API] Error fetching UCAS application:",s),s}},async getReferenceFull(e,t="current"){try{let s=`${mt}/api/academic-profile/${encodeURIComponent(e)}/reference/full`;const o=(t||"").toString().trim();o&&o.toLowerCase()!=="current"&&(s+=`?academic_year=${encodeURIComponent(o)}`);const n=await fetch(s);if(!n.ok){const r=await n.json().catch(()=>null);throw new Error((r==null?void 0:r.error)||`HTTP error! status: ${n.status}`)}return await n.json()}catch(s){throw console.error("[Staff API] Error fetching reference full:",s),s}},async saveTutorCompiled(e,t){try{const s=`${mt}/api/academic-profile/${encodeURIComponent(e)}/reference/tutor-compiled`,o=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!o.ok){const n=await o.json().catch(()=>null);throw new Error((n==null?void 0:n.error)||`HTTP error! status: ${o.status}`)}return await o.json()}catch(s){throw console.error("[Staff API] Error saving tutor compiled narrative:",s),s}},async markTutorCompiledComplete(e,t){try{const s=`${mt}/api/academic-profile/${encodeURIComponent(e)}/reference/tutor-compiled/mark-complete`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!o.ok){const n=await o.json().catch(()=>null);throw new Error((n==null?void 0:n.error)||`HTTP error! status: ${o.status}`)}return await o.json()}catch(s){throw console.error("[Staff API] Error marking tutor compiled complete:",s),s}},async unmarkTutorCompiledComplete(e,t){try{const s=`${mt}/api/academic-profile/${encodeURIComponent(e)}/reference/tutor-compiled/unmark-complete`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!o.ok){const n=await o.json().catch(()=>null);throw new Error((n==null?void 0:n.error)||`HTTP error! status: ${o.status}`)}return await o.json()}catch(s){throw console.error("[Staff API] Error unmarking tutor compiled complete:",s),s}},async requestUcasStatementEdits(e,t){try{const s=`${mt}/api/academic-profile/${encodeURIComponent(e)}/ucas-application/request-edits`,o=await fetch(s,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t||{})});if(!o.ok){const n=await o.json().catch(()=>null);throw new Error((n==null?void 0:n.error)||`HTTP error! status: ${o.status}`)}return await o.json()}catch(s){throw console.error("[Staff API] Error requesting UCAS statement edits:",s),s}},async getStudyPlannerContext(e,t={}){const s=String(e||"").trim().toLowerCase();if(!s)throw new Error("Student email is required");const o=(window==null?void 0:window.VESPA_SUPABASE_URL_DEFAULT)||(window==null?void 0:window.VESPA_SUPABASE_URL)||"",n=o?`${String(o).replace(/\/$/,"")}/functions/v1/study-planner-context`:"";if(!n)throw new Error("Supabase study planner endpoint is not configured");const r=(window==null?void 0:window.VESPA_SUPABASE_ANON_DEFAULT)||(window==null?void 0:window.VESPA_SUPABASE_ANON_KEY)||"",l={"Content-Type":"application/json"};r&&(l.Authorization=`Bearer ${r}`,l.apikey=r);const c={email:s,plan_id:(t==null?void 0:t.planId)||null};try{const u=await fetch(n,{method:"POST",headers:l,body:JSON.stringify(c)});if(!u.ok)throw new Error(await u.text().catch(()=>`HTTP error! status: ${u.status}`));const f=await u.json();if(!(f!=null&&f.ok))throw new Error((f==null?void 0:f.error)||"Failed to load study planner");return f}catch(u){throw console.error("[Staff API] Error fetching study planner context:",u),u}},async saveStudyPlannerSessionComment({sessionId:e,studentEmail:t,comment:s,staffEmail:o,staffName:n}){const r=String(e||"").trim(),l=String(t||"").trim().toLowerCase();if(!r)throw new Error("Session id is required");if(!l)throw new Error("Student email is required");const c=(window==null?void 0:window.VESPA_SUPABASE_URL_DEFAULT)||(window==null?void 0:window.VESPA_SUPABASE_URL)||"",u=c?`${String(c).replace(/\/$/,"")}/functions/v1/study-planner-staff-comment`:"";if(!u)throw new Error("Supabase staff comment endpoint is not configured");const f=(window==null?void 0:window.VESPA_SUPABASE_ANON_DEFAULT)||(window==null?void 0:window.VESPA_SUPABASE_ANON_KEY)||"",d={"Content-Type":"application/json"};f&&(d.Authorization=`Bearer ${f}`,d.apikey=f);try{const w=await fetch(u,{method:"POST",headers:d,body:JSON.stringify({session_id:r,student_email:l,comment:String(s||""),staff_email:String(o||"").trim().toLowerCase()||null,staff_name:String(n||"").trim()||null})});if(!w.ok)throw new Error(await w.text().catch(()=>`HTTP error! status: ${w.status}`));const A=await w.json();if(!(A!=null&&A.ok))throw new Error((A==null?void 0:A.error)||"Failed to save session comment");return A}catch(w){throw console.error("[Staff API] Error saving study planner session comment:",w),w}}};async function Cu(e,t,s=null){try{const o=`${t}/api/academic-profile/${encodeURIComponent(e)}/ucas-application`,n=new URLSearchParams;s&&n.append("academic_year",s);const r=await fetch(n.toString()?`${o}?${n.toString()}`:o,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok){if(r.status===404)return{success:!0,data:null};let l=`API error: ${r.status}`;try{const c=await r.json();c&&(c.error||c.message)&&(l=c.error||c.message)}catch{}throw new Error(l)}return await r.json()}catch(o){return console.error("[Academic Profile API] fetchUcasApplication error:",o),{success:!1,error:o.message||"Failed to fetch UCAS Application"}}}async function xu(e,t,s,o=null,n=null){try{const r=`${s}/api/academic-profile/${encodeURIComponent(e)}/ucas-application`;let l=null;const c=n&&typeof n=="object"?n.roleHint:null;c&&(l=String(c).trim().toLowerCase());try{if(typeof Knack<"u"&&Knack.getUserRoles){const d=(Knack.getUserRoles()||[]).some(w=>w&&w.name==="Student"||typeof w=="string"&&w.toLowerCase().includes("student"));l||(l=d?"student":"staff")}}catch{}const u=await fetch(r,{method:"PUT",headers:{"Content-Type":"application/json",...l?{"X-User-Role":l}:{}},body:JSON.stringify({academicYear:o,...t})});if(!u.ok){let f=`API error: ${u.status}`;try{const d=await u.json();d&&(d.error||d.message)&&(f=d.error||d.message)}catch{}throw new Error(f)}return await u.json()}catch(r){return console.error("[Academic Profile API] saveUcasApplication error:",r),{success:!1,error:r.message||"Failed to save UCAS Application"}}}async function Eu(e,t,s,o=null){try{const n=`${s}/api/academic-profile/${encodeURIComponent(e)}/ucas-application/comment`;let r=null;const l=t&&typeof t=="object"?t.__roleHint:null;l&&(r=String(l).trim().toLowerCase());try{if(typeof Knack<"u"&&Knack.getUserRoles){const f=(Knack.getUserRoles()||[]).some(d=>d&&d.name==="Student"||typeof d=="string"&&d.toLowerCase().includes("student"));r||(r=f?"student":"staff")}}catch{}const c=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",...r?{"X-User-Role":r}:{}},body:JSON.stringify({academicYear:o,...t||{}})});if(!c.ok){let u=`API error: ${c.status}`;try{const f=await c.json();f&&(f.error||f.message)&&(u=f.error||f.message)}catch{}throw new Error(u)}return await c.json()}catch(n){return console.error("[Academic Profile API] addUcasApplicationComment error:",n),{success:!1,error:n.message||"Failed to add comment"}}}async function Au(e,t,s,o=null,n=null){try{const r=`${s}/api/academic-profile/${encodeURIComponent(e)}/ucas-application/feedback`;let l=null;const c=n&&typeof n=="object"?n.roleHint:null;c&&(l=String(c).trim().toLowerCase());try{if(typeof Knack<"u"&&Knack.getUserRoles){const d=(Knack.getUserRoles()||[]).some(w=>w&&w.name==="Student"||typeof w=="string"&&w.toLowerCase().includes("student"));l||(l=d?"student":"staff")}}catch{}const u=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...l?{"X-User-Role":l}:{}},body:JSON.stringify({academicYear:o,...t||{}})});if(!u.ok){let f=`API error: ${u.status}`;try{const d=await u.json();d&&(d.error||d.message)&&(f=d.error||d.message)}catch{}throw new Error(f)}return await u.json()}catch(r){return console.error("[Academic Profile API] generateUcasFeedback error:",r),{success:!1,error:r.message||"Failed to generate feedback"}}}async function $u(e,t,s,o=null,n=null){try{const r=`${s}/api/academic-profile/${encodeURIComponent(e)}/ucas-application/virtual-tutor-comment`;let l=null;const c=n&&typeof n=="object"?n.roleHint:null;c&&(l=String(c).trim().toLowerCase());try{if(typeof Knack<"u"&&Knack.getUserRoles){const d=(Knack.getUserRoles()||[]).some(w=>w&&w.name==="Student"||typeof w=="string"&&w.toLowerCase().includes("student"));l||(l=d?"student":"staff")}}catch{}const u=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",...l?{"X-User-Role":l}:{}},body:JSON.stringify({academicYear:o,...t||{}})});if(!u.ok){let f=`API error: ${u.status}`;try{const d=await u.json();d&&(d.error||d.message)&&(f=d.error||d.message)}catch{}throw new Error(f)}return await u.json()}catch(r){return console.error("[Academic Profile API] addVirtualTutorComment error:",r),{success:!1,error:r.message||"Failed to add comment"}}}async function Tu(e,t,s=null){try{const o=s?`?academic_year=${encodeURIComponent(s)}`:"",n=`${t}/api/academic-profile/${encodeURIComponent(e)}/reference/status${o}`,r=await fetch(n,{method:"GET",headers:{"Content-Type":"application/json"}}),l=await r.json().catch(()=>({}));if(!r.ok)throw new Error((l==null?void 0:l.error)||(l==null?void 0:l.message)||`API error: ${r.status}`);return l}catch(o){return console.error("[Academic Profile API] fetchReferenceStatus error:",o),{success:!1,error:o.message||"Failed to fetch reference status"}}}async function Iu(e,t,s,o=null,n=null){try{const r=`${s}/api/academic-profile/${encodeURIComponent(e)}/reference/invite`,l=n&&n.roleHint?String(n.roleHint).trim().toLowerCase():"student",c=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-User-Role":l},body:JSON.stringify({academicYear:o,...t||{}})}),u=await c.json().catch(()=>({}));if(!c.ok)throw new Error((u==null?void 0:u.error)||(u==null?void 0:u.message)||`API error: ${c.status}`);return u}catch(r){return console.error("[Academic Profile API] createReferenceInvite error:",r),{success:!1,error:r.message||"Failed to invite teacher"}}}async function Ou(e,t,s=null,o=null){try{const n=s?`?academic_year=${encodeURIComponent(s)}`:"",r=`${t}/api/academic-profile/${encodeURIComponent(e)}/reference/full${n}`,l=o&&o.roleHint?String(o.roleHint).trim().toLowerCase():"staff",c=await fetch(r,{method:"GET",headers:{"Content-Type":"application/json","X-User-Role":l}}),u=await c.json().catch(()=>({}));if(!c.ok)throw new Error((u==null?void 0:u.error)||(u==null?void 0:u.message)||`API error: ${c.status}`);return u}catch(n){return console.error("[Academic Profile API] fetchReferenceFull error:",n),{success:!1,error:n.message||"Failed to fetch reference"}}}async function Pu(e,t,s,o=null,n=null){try{const r=`${s}/api/academic-profile/${encodeURIComponent(e)}/reference/contribution`,l=n&&n.roleHint?String(n.roleHint).trim().toLowerCase():"staff",c=await fetch(r,{method:"POST",headers:{"Content-Type":"application/json","X-User-Role":l},body:JSON.stringify({academicYear:o,...t||{}})}),u=await c.json().catch(()=>({}));if(!c.ok)throw new Error((u==null?void 0:u.error)||(u==null?void 0:u.message)||`API error: ${c.status}`);return u}catch(r){return console.error("[Academic Profile API] saveReferenceContribution error:",r),{success:!1,error:r.message||"Failed to save contribution"}}}async function Fu(e,t,s=null,o=null){try{const n=`${t}/api/academic-profile/${encodeURIComponent(e)}/ucas-application/mark-complete`,r=o&&o.roleHint?String(o.roleHint).trim().toLowerCase():"student",l=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json","X-User-Role":r},body:JSON.stringify({academicYear:s})}),c=await l.json().catch(()=>({}));if(!l.ok)throw new Error((c==null?void 0:c.error)||(c==null?void 0:c.message)||`API error: ${l.status}`);return c}catch(n){return console.error("[Academic Profile API] markUcasStatementComplete error:",n),{success:!1,error:n.message||"Failed to mark complete"}}}const Uu=["aria-label","title"],Mu={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Nu={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Ru={class:"ucas-header"},Lu={class:"ucas-header-left"},ju={class:"ucas-course-row"},qu=["disabled"],Du={key:0,value:""},Hu=["value"],Bu=["href"],Vu={key:1,class:"ucas-course-meta"},Ku=["title"],Gu={class:"ucas-meta-value"},Yu=["title"],Wu={class:"ucas-meta-value"},zu={class:"ucas-header-right"},Ju={key:0,class:"ucas-refbar"},Xu=["disabled"],Qu={key:0,class:"ucas-refbar-count"},Zu={key:1,class:"ucas-refbar"},ed=["disabled"],td=["disabled","title"],sd=["disabled"],nd=["disabled","title"],od=["disabled","title"],ad={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},rd={key:1,class:"ucas-spinner"},id={class:"ucas-body"},ld={class:"ucas-top-grid"},cd={class:"ucas-card"},ud={key:0,class:"ucas-empty"},dd={key:1,class:"ucas-subjects-grid"},fd=["title"],vd=["disabled","value","onInput"],pd={key:2,class:"ucas-tariff"},md={class:"ucas-tariff-grid"},hd=["title"],gd={class:"ucas-tariff-value"},yd={class:"ucas-tariff-sub"},bd={class:"ucas-tariff-sub-val"},_d=["title"],wd={class:"ucas-tariff-value"},kd={class:"ucas-tariff-sub"},Sd={class:"ucas-tariff-sub-val"},Cd=["title"],xd={class:"ucas-tariff-value"},Ed={class:"ucas-tariff-sub"},Ad={class:"ucas-tariff-sub-val"},$d={key:0,class:"ucas-tariff-note"},Td={class:"ucas-card"},Id={class:"ucas-metrics"},Od={class:"ucas-metric-value"},Pd={class:"ucas-metric-max"},Fd={class:"ucas-progress-bar"},Ud={class:"ucas-metric-status"},Md={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Nd={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Rd={class:"ucas-preview"},Ld={class:"ucas-preview-header"},jd={class:"ucas-preview-box"},qd={class:"ucas-questions"},Dd={class:"ucas-q"},Hd={class:"ucas-q-header"},Bd={class:"ucas-q-actions"},Vd=["title"],Kd=["disabled","value"],Gd={class:"ucas-q"},Yd={class:"ucas-q-header"},Wd={class:"ucas-q-actions"},zd=["title"],Jd=["disabled","value"],Xd={class:"ucas-q"},Qd={class:"ucas-q-header"},Zd={class:"ucas-q-actions"},ef=["title"],tf=["disabled","value"],sf={key:0,class:"ucas-comments"},nf={class:"ucas-comments-shell"},of={class:"ucas-comments-header"},af=["title"],rf={class:"ucas-comments-count-num"},lf={key:0,class:"ucas-comments-compose"},cf={class:"ucas-comments-compose-row"},uf={class:"ucas-comments-avatar ucas-comments-avatar--compose"},df={class:"ucas-comments-compose-main"},ff=["disabled"],vf={class:"ucas-comments-compose-footer"},pf={class:"ucas-comments-compose-actions"},mf=["disabled"],hf=["disabled"],gf={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},yf={class:"ucas-comments-quick"},bf={class:"ucas-comments-quick-chips"},_f=["onClick","disabled"],wf={key:1,class:"ucas-comments-empty"},kf={key:2,class:"ucas-comments-list"},Sf=["aria-label"],Cf={class:"ucas-comments-divider-text"},xf={class:"ucas-comments-item-main"},Ef={class:"ucas-comments-item-content"},Af={class:"ucas-comments-item-header"},$f={class:"ucas-comments-item-author"},Tf={class:"ucas-comments-author"},If={key:0,class:"ucas-comments-role"},Of={class:"ucas-comments-date"},Pf=["onClick"],Ff={class:"ucas-footer"},Uf={class:"ucas-footer-left"},Mf={class:"ucas-footer-stats"},Nf={class:"ucas-footer-total"},Rf={class:"ucas-footer-max"},Lf={class:"ucas-footer-remaining"},jf={key:0,class:"ucas-footer-warning"},qf={key:1,class:"ucas-footer-error"},Df={key:2,class:"ucas-footer-error"},Hf={class:"ucas-footer-right"},Bf={key:0,class:"ucas-toast"},Vf={class:"ucas-feedback-modal",role:"dialog","aria-modal":"true","aria-label":"Feedback"},Kf={class:"ucas-feedback-header"},Gf={class:"ucas-feedback-body"},Yf={key:0,class:"ucas-feedback-loading"},Wf={key:1,class:"ucas-feedback-error"},zf={key:2,class:"ucas-feedback-text"},Jf={class:"ucas-feedback-footer"},Xf=["disabled"],Qf=["disabled","title"],Zf={class:"ucas-expand-modal",role:"dialog","aria-modal":"true","aria-label":"Expanded writing"},ev={class:"ucas-expand-header"},tv={class:"ucas-expand-title"},sv={class:"ucas-expand-meta"},nv={class:"ucas-expand-pill"},ov={class:"ucas-expand-pill"},av={class:"ucas-expand-body"},rv={key:0,class:"ucas-preview-box ucas-preview-box--expanded"},iv=["disabled","value"],lv={class:"ucas-expand-modal",role:"dialog","aria-modal":"true","aria-label":"Expanded reference writing"},cv={class:"ucas-expand-header"},uv={class:"ucas-expand-title"},dv={class:"ucas-expand-meta"},fv={class:"ucas-expand-pill"},vv={class:"ucas-expand-body"},pv=["disabled","value"],mv={class:"ucas-feedback-modal ucas-ref-modal",role:"dialog","aria-modal":"true","aria-label":"Teacher reference"},hv={class:"ucas-ref-header"},gv={class:"ucas-ref-header-left"},yv={class:"ucas-ref-icon","aria-hidden":"true"},bv={width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},_v={key:0,d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"},wv={key:1,cx:"9",cy:"7",r:"4"},kv={key:2,d:"M22 21v-2a4 4 0 0 0-3-3.87"},Sv={key:3,d:"M16 3.13a4 4 0 0 1 0 7.75"},Cv={key:4,d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"},xv={key:5,points:"14 2 14 8 20 8"},Ev={key:6,x1:"16",y1:"13",x2:"8",y2:"13"},Av={key:7,x1:"16",y1:"17",x2:"8",y2:"17"},$v={key:8,x1:"10",y1:"9",x2:"8",y2:"9"},Tv={class:"ucas-ref-title-group"},Iv={class:"ucas-ref-subtitle"},Ov={key:0},Pv={key:1},Fv={class:"ucas-ref-statusbar"},Uv={class:"ucas-ref-statusbar-left"},Mv={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Nv={key:1,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Rv={key:0,class:"ucas-ref-status-count"},Lv={key:1,class:"ucas-ref-status-count"},jv=["disabled"],qv={class:"ucas-ref-body"},Dv={key:0,class:"ucas-ref-student"},Hv={class:"ucas-ref-steps"},Bv={class:"ucas-ref-step"},Vv={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},Kv={key:1},Gv={class:"ucas-ref-step"},Yv={class:"ucas-ref-step"},Wv={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"3"},zv={key:1},Jv={class:"ucas-ref-section"},Xv={class:"ucas-ref-section-head"},Qv={class:"ucas-ref-section-pill"},Zv={key:0,class:"ucas-ref-empty"},ep={key:1,class:"ucas-ref-invite-list"},tp={class:"ucas-ref-invite-left"},sp={class:"ucas-ref-invite-meta"},np={class:"ucas-ref-invite-name"},op={class:"ucas-ref-invite-sub"},ap={class:"ucas-ref-invite-actions"},rp=["onClick","disabled"],ip=["onClick"],lp={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},cp={key:1,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},up={key:2,class:"ucas-ref-hidden-row"},dp={class:"hint"},fp={class:"ucas-ref-section ucas-ref-section--form"},vp={class:"ucas-ref-form-grid"},pp=["value"],mp={class:"ucas-ref-form-actions"},hp=["disabled"],gp=["disabled"],yp={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},bp={key:0,class:"ucas-ref-linkcopy"},_p={class:"ucas-ref-linkcopy-row"},wp=["value"],kp={key:1,class:"ucas-ref-staff"},Sp={class:"ucas-ref-staff-head"},Cp={key:0,class:"ucas-ref-staff-meta"},xp={key:0,class:"ucas-empty ucas-empty--small"},Ep={key:1,class:"ucas-empty ucas-empty--small"},Ap={key:2,class:"ucas-ref-staff-body"},$p={class:"ucas-ref-contrib"},Tp={class:"ucas-ref-contrib-head"},Ip={class:"ucas-ref-badge has-content"},Op={class:"ucas-ref-editor"},Pp={class:"ucas-ref-editor-select"},Fp=["value"],Up={class:"ucas-ref-editor-footer"},Mp={class:"ucas-ref-char"},Np=["disabled"],Rp=["disabled"],Lp={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},jp={key:0,class:"hint"},qp={key:0,class:"ucas-ref-existing"},Dp={class:"ucas-ref-existing-list"},Hp={class:"ucas-ref-existing-meta"},Bp={class:"ucas-ref-existing-author"},Vp={class:"ucas-ref-existing-avatar"},Kp={class:"ucas-ref-existing-name"},Gp={class:"ucas-ref-existing-subject"},Yp={class:"ucas-ref-existing-text"},Wp={class:"ucas-ref-contrib ucas-ref-contrib--accordion"},zp={class:"ucas-ref-accordion-right"},Jp={class:"ucas-ref-accordion-chevron"},Xp={key:0,class:"ucas-ref-accordion-body"},Qp={class:"ucas-ref-editor"},Zp={class:"ucas-ref-editor-footer"},em={class:"ucas-ref-char"},tm=["disabled"],sm=["disabled"],nm={key:0,width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},om={key:0,class:"hint"},am={class:"ucas-ref-section"},rm={class:"ucas-ref-section-body"},im={class:"ucas-ref-section"},lm={class:"ucas-ref-section-head"},cm={class:"ucas-ref-section-pill"},um={key:0,class:"ucas-empty ucas-empty--small"},dm={key:1,class:"ucas-ref-contrib-list"},fm={class:"ucas-ref-contrib-meta"},vm={key:0},pm={class:"ucas-ref-contrib-text"},mm={class:"ucas-ref-section"},hm={class:"ucas-ref-section-head"},gm={class:"ucas-ref-section-pill"},ym={key:0,class:"ucas-empty ucas-empty--small"},bm={key:1,class:"ucas-ref-invite-list"},_m={class:"ucas-ref-invite-left"},wm={class:"ucas-ref-invite-meta"},km={class:"ucas-ref-invite-name"},Sm={class:"ucas-ref-invite-sub"},Cm={class:"ucas-ref-invite-actions"},xm=["onClick","disabled"],Em=["onClick"],Am={key:2,class:"ucas-ref-hidden-row"},$m={class:"hint"},Tm={class:"ucas-ref-footer"},nt=4e3,_t=350,zs=450,Im={__name:"UcasApplicationModal",props:{studentEmail:{type:String,default:""},academicYear:{type:String,default:""},subjects:{type:Array,default:()=>[]},offers:{type:Array,default:()=>[]},topOffer:{type:Object,default:null},apiUrl:{type:String,default:""},canEdit:{type:Boolean,default:!1},commentsEnabled:{type:Boolean,default:!0},canAddComment:{type:Boolean,default:!1},staffEmail:{type:String,default:""},embedded:{type:Boolean,default:!1}},emits:["close"],setup(e,{emit:t}){const s=F(!1);function o(){s.value=!s.value}const n=e,r=t,l=F("");let c=null;function u(x){l.value=x,c&&clearTimeout(c),c=setTimeout(()=>l.value="",2200)}function f(x){return x==null?"":String(x)}function d(x){const i=f(x==null?void 0:x.universityName).trim().toLowerCase(),T=f(x==null?void 0:x.courseTitle).trim().toLowerCase(),_=f(x==null?void 0:x.courseLink).trim().toLowerCase();return`${i}|${T}|${_}`.replace(/\s+/g," ").trim()}const w=te(()=>(Array.isArray(n.offers)?n.offers:[]).map(T=>({key:d(T),ranking:(T==null?void 0:T.ranking)??1,universityName:f(T==null?void 0:T.universityName).trim()||"University",courseTitle:f(T==null?void 0:T.courseTitle).trim(),courseLink:f(T==null?void 0:T.courseLink).trim(),offer:f(T==null?void 0:T.offer).trim(),ucasPoints:(T==null?void 0:T.ucasPoints)===null||(T==null?void 0:T.ucasPoints)===void 0||String(T==null?void 0:T.ucasPoints).trim()===""?null:Number(T==null?void 0:T.ucasPoints)})).filter(T=>T.key).sort((T,_)=>(Number(T.ranking)||999)-(Number(_.ranking)||999))),A=F(""),E=te(()=>w.value.find(x=>x.key===A.value)||null),O=Ps({q1:"",q2:"",q3:""}),B=Ps({}),ae=F([]),q=F(""),Y=F(!1),Q=F(!1),U=F(!1),K=F(!1),ie=F(""),ke=F(""),Se=F(new Set),z=[" Add more specific examples",' Strengthen your "why this course"'," Trim repetition"," Show reflection, not just description"," Link skills to the course"];function de(x){return Se.value.has(String(x||""))}function fe(x){const i=String(x||""),T=new Set(Se.value);T.has(i)?T.delete(i):T.add(i),Se.value=T}function D(x){const i=f(x);return i.length<=zs?i:i.slice(0,zs).trimEnd()+""}function ve(x){const i=f(x).trim();if(!i)return;const T=f(q.value),_=T?T.trimEnd()+`
`+i:i;q.value=_}function Ce(x){const i=f(x).trim();if(!i)return"ST";const _=(i.includes("@")?i.split("@")[0]:i).replace(/[^a-zA-Z0-9]+/g," ").trim().split(/\s+/).filter(Boolean),R=(_[0]||"").slice(0,1),ee=(_[1]||_[0]||"").slice(1,2);return(R+ee).toUpperCase()||"ST"}function Ue(x){const i=f(x).trim().toLowerCase();if(!i)return"ucas-comments-avatar--blue";let T=0;for(let R=0;R<i.length;R++)T=T*31+i.charCodeAt(R)>>>0;const _=T%4;return _===0?"ucas-comments-avatar--green":_===1?"ucas-comments-avatar--blue":_===2?"ucas-comments-avatar--purple":"ucas-comments-avatar--orange"}function Ae(x){try{const i=new Date(x);if(Number.isNaN(i.getTime()))return null;const T=i.getFullYear(),_=String(i.getMonth()+1).padStart(2,"0"),R=String(i.getDate()).padStart(2,"0");return`${T}-${_}-${R}`}catch{return null}}function me(x){try{const i=new Date,T=i.getFullYear(),_=String(i.getMonth()+1).padStart(2,"0"),R=String(i.getDate()).padStart(2,"0"),ee=`${T}-${_}-${R}`,Ee=new Date(ee+"T00:00:00"),pe=new Date(x+"T00:00:00"),ye=Math.round((Ee.getTime()-pe.getTime())/(1e3*60*60*24));return ye===0?"Today":ye===1?"Yesterday":pe.toLocaleDateString(void 0,{day:"2-digit",month:"short",year:"numeric"})}catch{return x}}const ue=te(()=>{const x=Array.isArray(ae.value)?ae.value:[],i=[];let T=null;for(const _ of x){const R=Ae(_==null?void 0:_.createdAt)||"unknown";(!T||T.key!==R)&&(T={key:R,label:R==="unknown"?"Earlier":me(R),items:[]},i.push(T)),T.items.push(_)}return i}),Me=F(!1),be=F("not_started"),Re=F([]),_e=F(new Set),Ve=F(""),Je=F(""),L=F(!1),M=F(""),W=te(()=>{const x=f(n.studentEmail).trim().toLowerCase(),i=f(n.academicYear).trim().toLowerCase();return`ucas_ref_hidden_invites:${x||"unknown"}:${i||"unknown"}`});function le(){try{const x=localStorage.getItem(W.value);if(!x){_e.value=new Set;return}const i=JSON.parse(x);_e.value=new Set(Array.isArray(i)?i.map(T=>String(T)):[])}catch{_e.value=new Set}}function J(){try{localStorage.setItem(W.value,JSON.stringify(Array.from(_e.value)))}catch{}}function Z(x){try{const i=String((x==null?void 0:x.id)||"");if(!i)return;const T=new Set(_e.value);T.add(i),_e.value=T,J(),u("Invite removed from list")}catch{}}function Te(){_e.value=new Set,J(),u("Restored hidden invites")}const p=te(()=>{const x=Array.isArray(Re.value)?Re.value:[],i=_e.value,T=x.filter(R=>R&&!i.has(String(R.id||""))),_=new Map;for(const R of T){const ee=f((R==null?void 0:R.teacherEmail)||(R==null?void 0:R.email)).trim().toLowerCase(),Ee=f(R==null?void 0:R.subjectKey).trim().toLowerCase(),pe=`${ee}__${Ee}`,ye=_.get(pe);if(!ye){_.set(pe,R);continue}const ys=Date.parse((ye==null?void 0:ye.createdAt)||(ye==null?void 0:ye.expiresAt)||"")||0;(Date.parse((R==null?void 0:R.createdAt)||(R==null?void 0:R.expiresAt)||"")||0)>ys&&_.set(pe,R)}return Array.from(_.values())}),v=te(()=>{const x=be.value;return x==="finalised"?"Finalised":x==="completed"?"Completed":x==="in_progress"?"In progress":"Not started"}),h=te(()=>{const x=Array.isArray(p.value)?p.value:[],i=x.length,T=x.filter(_=>_&&_.status==="submitted").length;return{total:i,submitted:T}}),I=F(!1),P=F(!1),m=F(null),y=te(()=>!n.canEdit&&!!f(n.staffEmail).trim()&&!!f(n.apiUrl).trim()&&!!f(n.studentEmail).trim()),g=F(""),$=F(""),C=F(""),j=F(!1),N=F(!1),H=F(!1),X=F(!1),re=F("staff3"),he=F(null),ge=te(()=>re.value==="staff2"?"Section 2: Extenuating circumstances":"Section 3: Subject teacher contribution"),qe=te(()=>re.value==="staff2"?f(g.value):f(C.value)),He=te(()=>f(qe.value).length);function Ye(x){y.value&&(re.value=x==="staff2"?"staff2":"staff3",X.value=!0,setTimeout(()=>{try{he.value&&he.value.focus&&he.value.focus()}catch{}},0))}function De(){X.value=!1}function Et(x,i){const T=f(n.staffEmail).trim().toLowerCase();if(!T)return null;const _=m.value;if(!_)return null;const R=x===2?_.section2||[]:_.section3||[],ee=f(i||"").trim().toLowerCase();for(const Ee of Array.isArray(R)?R:[]){if(!Ee||f(Ee.authorEmail).trim().toLowerCase()!==T)continue;const ye=f(Ee.subjectKey||"").trim().toLowerCase();if(x===3){if(ye===ee)return Ee}else return Ee}return null}async function ms(x){if(!y.value)return;const i=Number(x);if(i!==2&&i!==3)return;const _=f(i===2?g.value:C.value).trim();if(_){i===2?j.value=!0:N.value=!0;try{const R={section:i,text:_,subjectKey:i===3&&f($.value).trim()||null,authorName:null,staffEmail:f(n.staffEmail).trim()},ee=await Pu(n.studentEmail,R,n.apiUrl,n.academicYear||null,{roleHint:"staff"});if(!(ee!=null&&ee.success))throw new Error((ee==null?void 0:ee.error)||"Save failed");u("Saved"),await Be()}catch(R){u((R==null?void 0:R.message)||"Save failed")}finally{i===2?j.value=!1:N.value=!1}}}async function Be(){var x,i,T,_,R;if(!(!n.apiUrl||!n.studentEmail)){Me.value=!0;try{if(le(),n.canEdit){const ye=await Tu(n.studentEmail,n.apiUrl,n.academicYear||null);if(!(ye!=null&&ye.success))throw new Error((ye==null?void 0:ye.error)||"Failed to load reference status");be.value=f(((x=ye==null?void 0:ye.data)==null?void 0:x.status)||"not_started"),Re.value=Array.isArray((i=ye==null?void 0:ye.data)==null?void 0:i.invites)?ye.data.invites:[];return}P.value=!0;const ee=await Ou(n.studentEmail,n.apiUrl,n.academicYear||null,{roleHint:"staff"});if(!(ee!=null&&ee.success))throw new Error((ee==null?void 0:ee.error)||"Failed to load reference");m.value=(ee==null?void 0:ee.data)||null,be.value=f(((T=ee==null?void 0:ee.data)==null?void 0:T.status)||"not_started"),Re.value=Array.isArray((_=ee==null?void 0:ee.data)==null?void 0:_.invites)?ee.data.invites:[];const Ee=Et(2,null);g.value=f((Ee==null?void 0:Ee.text)||""),!f($.value).trim()&&$t.value.length&&($.value=f(((R=$t.value[0])==null?void 0:R.label)||""));const pe=Et(3,$.value);C.value=f((pe==null?void 0:pe.text)||"")}catch(ee){u((ee==null?void 0:ee.message)||"Failed to load reference")}finally{Me.value=!1,P.value=!1}}}ct(()=>$.value,()=>{const x=Et(3,$.value);C.value=f((x==null?void 0:x.text)||"")}),ct(()=>I.value,async x=>{x&&await Be()});async function at(){var i,T;if(!n.canEdit||!n.apiUrl||!n.studentEmail)return;const x=Ve.value.trim();if(x){L.value=!0,M.value="";try{const _=await Iu(n.studentEmail,{teacherEmail:x,subjectKey:Je.value||null,allowedSections:[3]},n.apiUrl,n.academicYear||null,{roleHint:"student"});if(!(_!=null&&_.success))throw new Error((_==null?void 0:_.error)||"Invite failed");const R=f(((i=_==null?void 0:_.data)==null?void 0:i.inboxUrl)||((T=_==null?void 0:_.data)==null?void 0:T.inviteUrl)||"");R.includes("/reference-contribution")&&R.includes("token=")?M.value=R.replace("/reference-contribution","/reference-inbox"):M.value=R,u("Invite created"),Ve.value="",Je.value="",await Be()}catch(_){u((_==null?void 0:_.message)||"Invite failed")}finally{L.value=!1}}}async function hs(x){n.canEdit&&(Ve.value=f((x==null?void 0:x.teacherEmail)||(x==null?void 0:x.email)||"").trim(),Je.value=f((x==null?void 0:x.subjectKey)||"").trim(),Ve.value&&await at())}function Ds(x){try{navigator.clipboard.writeText(String(x||"")),u("Copied")}catch{u("Copy failed")}}const Tn=F(!1),At=F("q1"),Hs=F(null),Or=te(()=>At.value==="preview"?"Preview: Combined statement":At.value==="q2"?"Q2: How studies prepared you":At.value==="q3"?"Q3: Outside education":"Q1: Why this course?"),In=te(()=>At.value==="preview"?gs.value||"":O[At.value]||""),Pr=te(()=>In.value.length),Ao=F(0);function jt(){if(n.canEdit)return;const x=Date.now();x-Ao.value<1500||(Ao.value=x,u("Only students can edit their UCAS statement."))}function Bs(x){At.value=x,Tn.value=!0,setTimeout(()=>{try{At.value!=="preview"&&n.canEdit&&Hs.value&&Hs.value.focus&&Hs.value.focus()}catch{}},0)}function On(){Tn.value=!1}const $t=te(()=>(Array.isArray(n.subjects)?n.subjects:[]).slice(0,5).map((i,T)=>{const _=f((i==null?void 0:i.id)||(i==null?void 0:i.originalRecordId)||(i==null?void 0:i.position)||(i==null?void 0:i.subjectName)||`idx_${T}`),R=f(i==null?void 0:i.subjectName).trim()||"Subject",ee=R.replace(/^\s*(?:[a-z]{1,2}\d?\s*-\s*)+/i,"").trim()||R;return{key:_,label:ee}})),Pn=te(()=>{const x=A.value||"";return x?B[x]||{}:{}});function Fr(x,i){if(!n.canEdit)return;const T=A.value||"";T&&(B[T]||(B[T]={}),B[T][x]=f(i).slice(0,24))}const Ne=te(()=>O.q1.length+O.q2.length+O.q3.length),Fn=te(()=>Math.max(0,nt-Ne.value)),ns=te(()=>Math.max(0,Ne.value-nt)),gs=te(()=>{const x=f(O.q1).trim(),i=f(O.q2).trim(),T=f(O.q3).trim();return[x,i,T].filter(Boolean).join(`

`)});function Vs(x,i){n.canEdit&&(O[x]=f(i))}function Ur(){try{if(!gs.value)return;navigator.clipboard.writeText(gs.value),u("Copied to clipboard")}catch{u("Copy failed (browser blocked)")}}function Mr(x){try{const i=new Date(x);return Number.isNaN(i.getTime())?"":i.toLocaleString()}catch{return""}}const Un=te(()=>`vespa:ucas_application:v1:${(n.studentEmail||"").toLowerCase()}:${n.academicYear||"current"}`);function Nr(){try{const x=localStorage.getItem(Un.value);if(!x)return;const i=JSON.parse(x);if(i!=null&&i.answers&&(O.q1=f(i.answers.q1),O.q2=f(i.answers.q2),O.q3=f(i.answers.q3)),i!=null&&i.requirementsByCourse&&typeof i.requirementsByCourse=="object")for(const[T,_]of Object.entries(i.requirementsByCourse))B[T]=_&&typeof _=="object"?_:{};i!=null&&i.selectedCourseKey&&(A.value=f(i.selectedCourseKey))}catch{}}function Rr(){try{localStorage.setItem(Un.value,JSON.stringify({updatedAt:new Date().toISOString(),selectedCourseKey:A.value,answers:{...O},requirementsByCourse:{...B}}))}catch{}}let Mn=null;ct(()=>[O.q1,O.q2,O.q3,A.value,JSON.stringify(B),Un.value],()=>{Mn&&clearTimeout(Mn),Mn=setTimeout(()=>Rr(),450)});const os=F(!1),as=F(""),Nn=F(!1);async function Lr(){if(!n.apiUrl||!n.studentEmail)return;const x=await Cu(n.studentEmail,n.apiUrl,n.academicYear||null);if(!(x!=null&&x.success))return;const i=x.data||{};if(i.answers&&(O.q1=f(i.answers.q1),O.q2=f(i.answers.q2),O.q3=f(i.answers.q3)),i.requirementsByCourse&&typeof i.requirementsByCourse=="object")for(const[T,_]of Object.entries(i.requirementsByCourse))B[T]=_&&typeof _=="object"?_:{};ae.value=Array.isArray(i.staffComments)?i.staffComments:[],i.selectedCourseKey&&(A.value=f(i.selectedCourseKey)),as.value=f(i.statementCompletedAt||"")}async function jr(){var x;if(!(!n.canEdit||!n.apiUrl||!n.studentEmail)&&!as.value){if(Ne.value>nt){u(`Over the ${nt} character limit  please shorten before marking complete`);return}if(Ne.value<_t){u(`Need at least ${_t} characters before marking complete`);return}Nn.value=!0;try{const i=await Fu(n.studentEmail,n.apiUrl,n.academicYear||null,{roleHint:"student"});if(!(i!=null&&i.success))throw new Error((i==null?void 0:i.error)||"Failed to mark statement complete");as.value=f(((x=i==null?void 0:i.data)==null?void 0:x.statementCompletedAt)||new Date().toISOString()),u("Statement marked complete (staff notified)")}catch(i){u((i==null?void 0:i.message)||"Failed to mark statement complete")}finally{Nn.value=!1}}}async function qr(){if(!n.canEdit){u("Read-only for staff  students can save");return}if(!(!n.apiUrl||!n.studentEmail)){os.value=!0;try{const x={selectedCourseKey:A.value||null,answers:{q1:O.q1,q2:O.q2,q3:O.q3},requirementsByCourse:{...B}},i=await xu(n.studentEmail,x,n.apiUrl,n.academicYear||null,{roleHint:n.canEdit?"student":"staff"});if(!(i!=null&&i.success))throw new Error((i==null?void 0:i.error)||"Save failed");u("Saved")}catch(x){u((x==null?void 0:x.message)||"Save failed")}finally{os.value=!1}}}async function $o(x=!1){if(!n.canEdit){u("Available for students");return}Q.value=!0,!(!x&&ie.value)&&await Dr()}async function Dr(){var x;if(!(!n.apiUrl||!n.studentEmail)){U.value=!0,ke.value="",ie.value="";try{const i={answers:{q1:O.q1,q2:O.q2,q3:O.q3},course:E.value?{...E.value}:null,totals:{totalChars:Ne.value,remainingChars:Fn.value}},T=await Au(n.studentEmail,i,n.apiUrl,n.academicYear||null,{roleHint:"student"});if(!(T!=null&&T.success))throw new Error((T==null?void 0:T.error)||"Failed to generate feedback");const _=f(((x=T==null?void 0:T.data)==null?void 0:x.feedback)||(T==null?void 0:T.data)||"");ie.value=_.trim(),ie.value||(ke.value="No feedback returned.")}catch(i){ke.value=(i==null?void 0:i.message)||"Failed to generate feedback"}finally{U.value=!1}}}async function Hr(){var x;if(!(!ie.value||!n.apiUrl||!n.studentEmail)){K.value=!0;try{const i=await $u(n.studentEmail,{comment:ie.value},n.apiUrl,n.academicYear||null,{roleHint:"student"});if(!(i!=null&&i.success))throw new Error((i==null?void 0:i.error)||"Failed to add comment");ae.value=Array.isArray((x=i.data)==null?void 0:x.staffComments)?i.data.staffComments:ae.value,u("Added to Tutor comments"),Q.value=!1}catch(i){u((i==null?void 0:i.message)||"Failed to add comment")}finally{K.value=!1}}}const Br={"A-Level":{grades:{"A*":56,A:48,B:40,C:32,D:24,E:16}},"AS-Level":{grades:{A:20,B:16,C:12,D:10,E:6}},"BTEC Extended Certificate (1 A-Level)":{grades:{"D*":56,D:48,M:32,P:16}},"EPQ (Extended Project)":{grades:{"A*":28,A:24,B:20,C:16,D:12,E:8}}};function To(x){const i=f(x).trim();if(!i)return"";const T=i.toUpperCase();return T==="DISTINCTION*"||T==="DISTINCTION *"?"D*":T==="DISTINCTION"?"D":T==="MERIT"?"M":T==="PASS"?"P":T.replace(/\s+/g,"")}function Vr(x){const i=f(x==null?void 0:x.examType).toLowerCase();return i.includes("epq")||i.includes("extended project")?"EPQ (Extended Project)":i.includes("as")&&i.includes("level")?"AS-Level":i.includes("a level")||i.includes("a-level")?"A-Level":i.includes("btec")?"BTEC Extended Certificate (1 A-Level)":"A-Level"}function Rn(x,i){var Ee;const T=To(i);if(!T)return{points:0,unknown:0};const _=Vr(x),ee=(((Ee=Br[_])==null?void 0:Ee.grades)||{})[T];return typeof ee=="number"?{points:ee,unknown:0}:{points:0,unknown:1}}function Ln(x){const i=(Array.isArray(x)?x:[]).map(T=>To(T)).filter(Boolean);return i.length?i.join("  "):""}const jn=te(()=>{var ee,Ee;const x=Array.isArray(n.subjects)?n.subjects.slice(0,5):[],i=Ln(x.map(pe=>pe==null?void 0:pe.currentGrade)),T=Ln(x.map(pe=>pe==null?void 0:pe.targetGrade)),_=[];for(let pe=0;pe<x.length;pe++){const ye=(ee=$t.value[pe])==null?void 0:ee.key,ys=ye&&Pn.value[ye]||"";_.push(ys)}let R=Ln(_);return R||(R=f((Ee=E.value)==null?void 0:Ee.offer).trim()||""),{current:i,target:T,required:R}}),st=te(()=>{var ee;const x=Array.isArray(n.subjects)?n.subjects.slice(0,5):[];let i=0,T=0,_=0,R=0;for(let Ee=0;Ee<x.length;Ee++){const pe=x[Ee],ye=(ee=$t.value[Ee])==null?void 0:ee.key,ys=ye&&Pn.value[ye]||"",Dn=Rn(pe,pe==null?void 0:pe.currentGrade),Oo=Rn(pe,pe==null?void 0:pe.targetGrade),Po=Rn(pe,ys);i+=Dn.points,T+=Oo.points,_+=Po.points,R+=Dn.unknown+Oo.unknown+Po.unknown}return{current:i,target:T,required:_,unknownCount:R}});function Io(x,i){const T=Number(x)||0,_=Number(i)||0;return!_||!T?"":T>=_?"ucas-tariff-box--good":T>=Math.ceil(_*.9)?"ucas-tariff-box--warn":"ucas-tariff-box--bad"}function qn(x,i,T,_){const R=Number(T)||0,ee=Number(_)||0,Ee=[`${x} UCAS points`,i,`Total: ${R}`];if(x!=="Required"&&ee){Ee.push(`Required: ${ee}`);const pe=R-ee;Ee.push(pe>=0?`Above by: ${pe}`:`Below by: ${Math.abs(pe)}`)}return Ee.join(`
`)}async function Kr(){var i;if(!n.canAddComment)return;const x=q.value.trim();if(x){Y.value=!0;try{const T=await Eu(n.studentEmail,{comment:x,staffEmail:n.staffEmail||null,__roleHint:n.canAddComment?"staff":"student"},n.apiUrl,n.academicYear||null);if(!(T!=null&&T.success))throw new Error((T==null?void 0:T.error)||"Comment failed");ae.value=Array.isArray((i=T.data)==null?void 0:i.staffComments)?T.data.staffComments:ae.value,q.value="",u("Comment posted")}catch(T){u((T==null?void 0:T.message)||"Comment failed")}finally{Y.value=!1}}}return xn(async()=>{const x=n.topOffer||(n.offers&&n.offers.length?n.offers[0]:null);x&&(A.value=d(x)),Nr(),await Lr(),n.canEdit&&await Be(),!A.value&&x&&(A.value=d(x))}),(x,i)=>{var T;return b(),k("div",{class:ne(["ucas-overlay",[{"ucas-overlay--fullscreen":s.value},e.embedded?"ucas-overlay--embedded":""]]),role:"dialog","aria-modal":"true","aria-label":"UCAS Application",onClick:i[33]||(i[33]=ft(_=>e.embedded?null:r("close"),["self"]))},[a("div",{class:ne(["ucas-modal",{"ucas-modal--fullscreen":s.value}])},[e.embedded?V("",!0):(b(),k(oe,{key:0},[a("button",{class:"ucas-btn-close ucas-btn-close--corner ucas-btn-close--corner-secondary",type:"button",onClick:o,"aria-label":s.value?"Exit full screen":"Full screen UCAS application",title:s.value?"Exit full screen":"Full screen"},[s.value?(b(),k("svg",Nu,[...i[35]||(i[35]=[a("path",{d:"M9 3H3v6"},null,-1),a("path",{d:"M15 21h6v-6"},null,-1),a("path",{d:"M3 3l7 7"},null,-1),a("path",{d:"M21 21l-7-7"},null,-1)])])):(b(),k("svg",Mu,[...i[34]||(i[34]=[a("path",{d:"M15 3h6v6"},null,-1),a("path",{d:"M9 21H3v-6"},null,-1),a("path",{d:"M21 3l-7 7"},null,-1),a("path",{d:"M3 21l7-7"},null,-1)])]))],8,Uu),a("button",{class:"ucas-btn-close ucas-btn-close--corner",type:"button",onClick:i[0]||(i[0]=_=>r("close")),"aria-label":"Close UCAS application"},[...i[36]||(i[36]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])],64)),a("header",Ru,[a("div",Lu,[i[41]||(i[41]=a("div",{class:"ucas-title"},"UCAS Application",-1)),a("div",ju,[i[40]||(i[40]=a("label",{class:"ucas-course-label",for:"course-select"},"Course",-1)),Le(a("select",{id:"course-select","onUpdate:modelValue":i[1]||(i[1]=_=>A.value=_),class:"ucas-select",disabled:w.value.length===0},[w.value.length===0?(b(),k("option",Du,"No offers yet")):V("",!0),(b(!0),k(oe,null,Pe(w.value,_=>(b(),k("option",{key:_.key,value:_.key}," #"+S(_.ranking)+" "+S(_.universityName)+"  "+S(_.courseTitle||"Course"),9,Hu))),128))],8,qu),[[St,A.value]]),(T=E.value)!=null&&T.courseLink?(b(),k("a",{key:0,class:"ucas-btn ucas-btn-outline",href:E.value.courseLink,target:"_blank",rel:"noopener noreferrer",title:"Open course link in a new tab"},[...i[37]||(i[37]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"}),a("polyline",{points:"15 3 21 3 21 9"}),a("line",{x1:"10",y1:"14",x2:"21",y2:"3"})],-1),G(" Course link ",-1)])],8,Bu)):V("",!0),E.value?(b(),k("div",Vu,[E.value.offer?(b(),k("div",{key:0,class:"ucas-meta-pill",title:`Course offer requirement (grade): ${E.value.offer}`},[i[38]||(i[38]=a("span",{class:"ucas-meta-label"},"Required grade",-1)),a("span",Gu,S(E.value.offer),1)],8,Ku)):V("",!0),E.value.ucasPoints!==null&&E.value.ucasPoints!==void 0&&E.value.ucasPoints!==""?(b(),k("div",{key:1,class:"ucas-meta-pill",title:`Course offer requirement (UCAS points): ${E.value.ucasPoints}`},[i[39]||(i[39]=a("span",{class:"ucas-meta-label"},"Required UCAS",-1)),a("span",Wu,S(E.value.ucasPoints),1)],8,Yu)):V("",!0)])):V("",!0)])]),a("div",zu,[e.canEdit?(b(),k("div",Ju,[a("button",{class:"ucas-refbar-btn",type:"button",onClick:i[2]||(i[2]=_=>I.value=!0),disabled:Me.value||!e.studentEmail||!e.apiUrl,title:"Invite a teacher and track reference progress"},[...i[42]||(i[42]=[it('<svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M12 12c2.5 0 4.5-2 4.5-4.5S14.5 3 12 3 7.5 5 7.5 7.5 9.5 12 12 12Z" data-v-c84f3a74></path><path d="M4 21a8 8 0 0 1 16 0" data-v-c84f3a74></path><path d="M19 8h2" data-v-c84f3a74></path><path d="M20 7v2" data-v-c84f3a74></path></svg> Teacher reference ',2)])],8,Xu),a("span",{class:ne(["ucas-refbar-pill",`ucas-refbar--${be.value}`])},[G(S(v.value)+" ",1),h.value.total?(b(),k("span",Qu," ("+S(h.value.submitted)+"/"+S(h.value.total)+") ",1)):V("",!0)],2)])):(b(),k("div",Zu,[a("button",{class:"ucas-refbar-btn",type:"button",onClick:i[3]||(i[3]=_=>I.value=!0),disabled:Me.value||!e.studentEmail||!e.apiUrl,title:"View teacher reference"},[...i[43]||(i[43]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"M12 12c2.5 0 4.5-2 4.5-4.5S14.5 3 12 3 7.5 5 7.5 7.5 9.5 12 12 12Z"}),a("path",{d:"M4 21a8 8 0 0 1 16 0"})],-1),G(" Teacher reference ",-1)])],8,ed),a("span",{class:ne(["ucas-refbar-pill",`ucas-refbar--${be.value}`])},S(v.value),3)])),i[48]||(i[48]=a("a",{class:"ucas-btn ucas-btn-outline",href:"https://www.ucas.com/",target:"_blank",rel:"noopener noreferrer",title:"Open UCAS in a new tab"},[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("circle",{cx:"11",cy:"11",r:"8"}),a("path",{d:"m21 21-4.3-4.3"})]),G(" UCAS ")],-1)),a("button",{class:"ucas-btn ucas-btn-feedback",type:"button",onClick:$o,disabled:!e.canEdit||U.value||!e.studentEmail||!e.apiUrl,title:e.canEdit?"Get feedback to improve your statement":"Available for students"},[...i[44]||(i[44]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("path",{d:"M21 15a4 4 0 0 1-4 4H7l-4 4V7a4 4 0 0 1 4-4h10a4 4 0 0 1 4 4z"}),a("path",{d:"M8 11h8"}),a("path",{d:"M8 15h5"})],-1),G(" Get Feedback ",-1)])],8,td),a("button",{class:"ucas-btn ucas-btn-outline",type:"button",onClick:Ur,disabled:!gs.value},[...i[45]||(i[45]=[a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2"}),a("path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"})],-1),G(" Copy ",-1)])],8,sd),e.canEdit?(b(),k("button",{key:2,class:"ucas-btn ucas-btn-outline",type:"button",onClick:jr,disabled:Nn.value||!!as.value||Ne.value>nt||Ne.value<_t||!e.studentEmail,title:as.value?"Already marked complete":"Mark your personal statement complete and notify staff"},[i[46]||(i[46]=a("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("path",{d:"M20 6 9 17l-5-5"})],-1)),G(" "+S(as.value?"Statement complete":"Mark statement complete"),1)],8,nd)):V("",!0),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:qr,disabled:!e.canEdit||os.value||!e.studentEmail,title:e.canEdit?"Save UCAS application":"Read-only for staff  students can save"},[os.value?V("",!0):(b(),k("svg",ad,[...i[47]||(i[47]=[a("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},null,-1),a("polyline",{points:"17 21 17 13 7 13 7 21"},null,-1),a("polyline",{points:"7 3 7 8 15 8"},null,-1)])])),os.value?(b(),k("span",rd)):V("",!0),G(" "+S(os.value?"Saving":"Save"),1)],8,od)])]),a("main",id,[a("section",ld,[a("div",cd,[i[59]||(i[59]=a("div",{class:"ucas-card-header"},[a("h2",{class:"ucas-card-title"},"Subjects + offer requirements"),a("p",{class:"ucas-card-hint"},"Enter the grades required by the university for this course (max 5 subjects).")],-1)),$t.value.length===0?(b(),k("div",ud,[...i[49]||(i[49]=[a("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5"},[a("path",{d:"M12 9v3.75m9-.75a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9 3.75h.008v.008H12v-.008Z"})],-1),a("span",null,"No subjects found in the academic profile.",-1)])])):(b(),k("div",dd,[i[50]||(i[50]=a("div",{class:"ucas-subjects-head"},"Subject",-1)),i[51]||(i[51]=a("div",{class:"ucas-subjects-head"},"Offer grade",-1)),(b(!0),k(oe,null,Pe($t.value,_=>(b(),k(oe,{key:_.key},[a("div",{class:"ucas-subject-name",title:_.label},S(_.label),9,fd),a("div",null,[a("input",{class:"ucas-input",type:"text",disabled:!e.canEdit,value:Pn.value[_.key]||"",onClick:jt,onFocus:jt,onInput:R=>Fr(_.key,R.target.value),placeholder:"e.g. AAA"},null,40,vd)])],64))),128))])),$t.value.length?(b(),k("div",pd,[i[58]||(i[58]=a("div",{class:"ucas-preview-header"},[a("h3",{class:"ucas-preview-title"},"UCAS points (estimated)"),a("span",{class:"ucas-preview-hint"},"Based on the subjects shown (max 5)")],-1)),a("div",md,[a("div",{class:ne(["ucas-tariff-box",Io(st.value.current,st.value.required)]),title:qn("Current","Calculated from Current grades shown in your Academic Profile.",st.value.current,st.value.required)},[i[53]||(i[53]=a("div",{class:"ucas-tariff-label"},"Current",-1)),a("div",gd,S(st.value.current.toLocaleString()),1),a("div",yd,[i[52]||(i[52]=G("Grades: ",-1)),a("span",bd,S(jn.value.current||""),1)])],10,hd),a("div",{class:ne(["ucas-tariff-box",Io(st.value.target,st.value.required)]),title:qn("Target","Calculated from Target grades shown in your Academic Profile.",st.value.target,st.value.required)},[i[55]||(i[55]=a("div",{class:"ucas-tariff-label"},"Target",-1)),a("div",wd,S(st.value.target.toLocaleString()),1),a("div",kd,[i[54]||(i[54]=G("Grades: ",-1)),a("span",Sd,S(jn.value.target||""),1)])],10,_d),a("div",{class:"ucas-tariff-box ucas-tariff-box--required",title:qn("Required","Calculated from the Offer grade inputs on this page (per subject).",st.value.required,st.value.required)},[i[57]||(i[57]=a("div",{class:"ucas-tariff-label"},"Required",-1)),a("div",xd,S(st.value.required.toLocaleString()),1),a("div",Ed,[i[56]||(i[56]=G("Grades: ",-1)),a("span",Ad,S(jn.value.required||""),1)])],8,Cd)]),st.value.unknownCount>0?(b(),k("div",$d," Some grades couldnt be converted to points (format/qualification not recognised). ")):V("",!0)])):V("",!0)]),a("div",Td,[i[68]||(i[68]=a("div",{class:"ucas-card-header"},[a("h2",{class:"ucas-card-title"},"Character budget")],-1)),a("div",Id,[a("div",{class:ne(["ucas-metric",{"ucas-metric--danger":Ne.value>=nt}])},[i[60]||(i[60]=a("div",{class:"ucas-metric-label"},"Total characters",-1)),a("div",Od,[G(S(Ne.value.toLocaleString())+" ",1),a("span",Pd,"/ "+S(nt.toLocaleString()),1)]),a("div",Fd,[a("div",{class:ne(["ucas-progress-fill",{"ucas-progress--warning":Ne.value>nt*.85,"ucas-progress--danger":Ne.value>=nt}]),style:ht({width:Math.min(100,Ne.value/nt*100)+"%"})},null,6)]),a("div",{class:ne(["ucas-metric-sub",{"ucas-metric-sub--danger":ns.value>0}])},[ns.value>0?(b(),k(oe,{key:0},[G(S(ns.value.toLocaleString())+" over limit",1)],64)):(b(),k(oe,{key:1},[G(S(Fn.value.toLocaleString())+" remaining",1)],64))],2)],2),a("div",{class:ne(["ucas-metric",{"ucas-metric--success":Ne.value>=_t}])},[i[64]||(i[64]=a("div",{class:"ucas-metric-label"},"Minimum required",-1)),a("div",{class:"ucas-metric-value"},[G(S(_t)+" "),i[61]||(i[61]=a("span",{class:"ucas-metric-max"},"characters",-1))]),a("div",Ud,[Ne.value>=_t?(b(),k("svg",Md,[...i[62]||(i[62]=[a("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,-1),a("polyline",{points:"22 4 12 14.01 9 11.01"},null,-1)])])):(b(),k("svg",Nd,[...i[63]||(i[63]=[a("circle",{cx:"12",cy:"12",r:"10"},null,-1),a("line",{x1:"12",y1:"8",x2:"12",y2:"12"},null,-1),a("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"},null,-1)])])),a("span",null,S(Ne.value>=_t?"Minimum met":`Need ${_t-Ne.value} more`),1)])],2)]),a("div",Rd,[a("div",Ld,[i[66]||(i[66]=a("h3",{class:"ucas-preview-title"},"Preview",-1)),i[67]||(i[67]=a("span",{class:"ucas-preview-hint"},"Combined statement as it will appear",-1)),a("button",{class:"ucas-q-expand",type:"button",onClick:i[4]||(i[4]=_=>Bs("preview")),title:"Expand preview to read comfortably"},[...i[65]||(i[65]=[it('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M15 3h6v6" data-v-c84f3a74></path><path d="M9 21H3v-6" data-v-c84f3a74></path><path d="M21 3l-7 7" data-v-c84f3a74></path><path d="M3 21l7-7" data-v-c84f3a74></path></svg> Expand ',2)])])]),a("div",jd,S(gs.value||"Your combined statement will appear here as you type"),1)])])]),a("section",qd,[a("div",Dd,[a("div",Hd,[i[70]||(i[70]=a("label",{class:"ucas-q-label",for:"q1"},[a("span",{class:"ucas-q-number"},"1"),a("span",{class:"ucas-q-title"},"Why do you want to study this course or subject?")],-1)),a("div",Bd,[a("button",{class:"ucas-q-expand",type:"button",onClick:i[5]||(i[5]=_=>Bs("q1")),title:e.canEdit?"Expand for focused writing":"Expand to read comfortably"},[...i[69]||(i[69]=[it('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M15 3h6v6" data-v-c84f3a74></path><path d="M9 21H3v-6" data-v-c84f3a74></path><path d="M21 3l-7 7" data-v-c84f3a74></path><path d="M3 21l7-7" data-v-c84f3a74></path></svg> Expand ',2)])],8,Vd),a("span",{class:ne(["ucas-q-count",{"ucas-q-count--active":O.q1.length>0}])},S(O.q1.length.toLocaleString())+" chars ",3)])]),a("textarea",{id:"q1",class:"ucas-textarea",disabled:!e.canEdit,value:O.q1,onClick:jt,onFocus:jt,onInput:i[6]||(i[6]=_=>Vs("q1",_.target.value)),placeholder:"Be specific. What sparked your interest, and why this course?"},null,40,Kd)]),a("div",Gd,[a("div",Yd,[i[72]||(i[72]=a("label",{class:"ucas-q-label",for:"q2"},[a("span",{class:"ucas-q-number"},"2"),a("span",{class:"ucas-q-title"},"How have your qualifications and studies prepared you?")],-1)),a("div",Wd,[a("button",{class:"ucas-q-expand",type:"button",onClick:i[7]||(i[7]=_=>Bs("q2")),title:e.canEdit?"Expand for focused writing":"Expand to read comfortably"},[...i[71]||(i[71]=[it('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M15 3h6v6" data-v-c84f3a74></path><path d="M9 21H3v-6" data-v-c84f3a74></path><path d="M21 3l-7 7" data-v-c84f3a74></path><path d="M3 21l7-7" data-v-c84f3a74></path></svg> Expand ',2)])],8,zd),a("span",{class:ne(["ucas-q-count",{"ucas-q-count--active":O.q2.length>0}])},S(O.q2.length.toLocaleString())+" chars ",3)])]),a("textarea",{id:"q2",class:"ucas-textarea",disabled:!e.canEdit,value:O.q2,onClick:jt,onFocus:jt,onInput:i[8]||(i[8]=_=>Vs("q2",_.target.value)),placeholder:"Use evidence: topics, projects, what you learned, and how it links."},null,40,Jd)]),a("div",Xd,[a("div",Qd,[i[74]||(i[74]=a("label",{class:"ucas-q-label",for:"q3"},[a("span",{class:"ucas-q-number"},"3"),a("span",{class:"ucas-q-title"},"What have you done outside education to prepare, and why is it useful?")],-1)),a("div",Zd,[a("button",{class:"ucas-q-expand",type:"button",onClick:i[9]||(i[9]=_=>Bs("q3")),title:e.canEdit?"Expand for focused writing":"Expand to read comfortably"},[...i[73]||(i[73]=[it('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M15 3h6v6" data-v-c84f3a74></path><path d="M9 21H3v-6" data-v-c84f3a74></path><path d="M21 3l-7 7" data-v-c84f3a74></path><path d="M3 21l7-7" data-v-c84f3a74></path></svg> Expand ',2)])],8,ef),a("span",{class:ne(["ucas-q-count",{"ucas-q-count--active":O.q3.length>0}])},S(O.q3.length.toLocaleString())+" chars ",3)])]),a("textarea",{id:"q3",class:"ucas-textarea",disabled:!e.canEdit,value:O.q3,onClick:jt,onFocus:jt,onInput:i[10]||(i[10]=_=>Vs("q3",_.target.value)),placeholder:"Super-curricular, work experience, reading, volunteering, clubs what did it develop?"},null,40,tf)])]),e.commentsEnabled?(b(),k("section",sf,[a("div",nf,[a("div",of,[i[76]||(i[76]=it('<div class="ucas-comments-header-left" data-v-c84f3a74><div class="ucas-comments-icon" aria-hidden="true" data-v-c84f3a74><svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" data-v-c84f3a74></path></svg></div><div class="ucas-comments-title-group" data-v-c84f3a74><h2 class="ucas-comments-title" data-v-c84f3a74>Tutor feedback</h2><p class="ucas-comments-subtitle" data-v-c84f3a74>Comments from staff to help improve your statement</p></div></div>',1)),a("div",{class:"ucas-comments-count",title:`${(ae.value||[]).length} comment(s)`},[a("span",rf,S((ae.value||[]).length),1),i[75]||(i[75]=a("span",null,"Comments",-1))],8,af)]),e.canAddComment?(b(),k("div",lf,[a("div",cf,[a("div",uf,S(Ce(e.staffEmail||"Staff")),1),a("div",df,[Le(a("textarea",{"onUpdate:modelValue":i[11]||(i[11]=_=>q.value=_),class:"ucas-comments-textarea",placeholder:"Write feedback for this student's personal statement",disabled:Y.value},null,8,ff),[[Mt,q.value]]),a("div",vf,[i[78]||(i[78]=it('<div class="ucas-comments-compose-hint" data-v-c84f3a74><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><circle cx="12" cy="12" r="10" data-v-c84f3a74></circle><path d="M12 16v-4" data-v-c84f3a74></path><path d="M12 8h.01" data-v-c84f3a74></path></svg><span data-v-c84f3a74>Visible to the student immediately</span></div>',1)),a("div",pf,[a("button",{class:"ucas-btn ucas-btn-ghost",type:"button",onClick:i[12]||(i[12]=_=>q.value=""),disabled:Y.value||!q.value}," Cancel ",8,mf),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:Kr,disabled:Y.value||!q.value.trim()},[Y.value?V("",!0):(b(),k("svg",gf,[...i[77]||(i[77]=[a("path",{d:"m22 2-7 20-4-9-9-4 20-7z"},null,-1),a("path",{d:"M22 2 11 13"},null,-1)])])),G(" "+S(Y.value?"Posting":"Post feedback"),1)],8,hf)])])])]),a("div",yf,[i[79]||(i[79]=a("div",{class:"ucas-comments-quick-label"},"Quick feedback",-1)),a("div",bf,[(b(),k(oe,null,Pe(z,_=>a("button",{key:_,class:"ucas-comments-chip",type:"button",onClick:R=>ve(_),disabled:Y.value},S(_),9,_f)),64))])])])):V("",!0),ue.value.length===0?(b(),k("div",wf,[...i[80]||(i[80]=[it('<div class="ucas-comments-empty-icon" aria-hidden="true" data-v-c84f3a74><svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" data-v-c84f3a74><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" data-v-c84f3a74></path></svg></div><div class="ucas-comments-empty-title" data-v-c84f3a74>No feedback yet</div><div class="ucas-comments-empty-text" data-v-c84f3a74>Staff comments will appear here to help improve your personal statement.</div>',3)])])):(b(),k("div",kf,[(b(!0),k(oe,null,Pe(ue.value,_=>(b(),k(oe,{key:_.key},[a("div",{class:"ucas-comments-divider","aria-label":_.label},[i[81]||(i[81]=a("div",{class:"ucas-comments-divider-line"},null,-1)),a("span",Cf,S(_.label),1),i[82]||(i[82]=a("div",{class:"ucas-comments-divider-line"},null,-1))],8,Sf),(b(!0),k(oe,null,Pe(_.items,R=>(b(),k("div",{key:R.id,class:"ucas-comments-item"},[a("div",xf,[a("div",{class:ne(["ucas-comments-avatar",Ue(R.staffEmail)])},S(Ce(R.staffEmail||"Staff")),3),a("div",Ef,[a("div",Af,[a("div",$f,[a("span",Tf,S(R.staffEmail||"Staff"),1),f(R.staffEmail).trim().toLowerCase()==="virtual tutor"?(b(),k("span",If," Virtual Tutor ")):V("",!0)]),a("span",Of,S(Mr(R.createdAt)),1)]),a("div",{class:ne(["ucas-comments-body",{"ucas-comments-body--collapsed":!de(R.id)&&f(R.comment).length>zs}])},[de(R.id)?(b(),k(oe,{key:0},[G(S(R.comment),1)],64)):(b(),k(oe,{key:1},[G(S(D(R.comment)),1)],64))],2),f(R.comment).length>zs?(b(),k("button",{key:0,class:"ucas-comments-more",type:"button",onClick:ee=>fe(R.id)},S(de(R.id)?"Show less":"Show more"),9,Pf)):V("",!0)])])]))),128))],64))),128))]))])])):V("",!0)]),a("footer",Ff,[a("div",Uf,[a("div",Mf,[a("span",Nf,S(Ne.value.toLocaleString()),1),i[85]||(i[85]=a("span",{class:"ucas-footer-divider"},"/",-1)),a("span",Rf,S(nt.toLocaleString()),1),a("span",Lf,[i[83]||(i[83]=G(" ( ",-1)),ns.value>0?(b(),k(oe,{key:0},[G(S(ns.value.toLocaleString())+" over",1)],64)):(b(),k(oe,{key:1},[G(S(Fn.value.toLocaleString())+" remaining",1)],64)),i[84]||(i[84]=G(" ) ",-1))])]),Ne.value>0&&Ne.value<_t?(b(),k("div",jf,[i[86]||(i[86]=a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z"}),a("line",{x1:"12",y1:"9",x2:"12",y2:"13"}),a("line",{x1:"12",y1:"17",x2:"12.01",y2:"17"})],-1)),G(" Add "+S(_t-Ne.value)+" more characters to reach the minimum. ",1)])):V("",!0),Ne.value>nt?(b(),k("div",qf,[i[87]||(i[87]=a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("circle",{cx:"12",cy:"12",r:"10"}),a("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),a("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1)),G(" Over the limit by "+S(ns.value)+" characters. Shorten your statement before saving or marking complete. ",1)])):Ne.value>=nt?(b(),k("div",Df,[...i[88]||(i[88]=[a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("circle",{cx:"12",cy:"12",r:"10"}),a("line",{x1:"15",y1:"9",x2:"9",y2:"15"}),a("line",{x1:"9",y1:"9",x2:"15",y2:"15"})],-1),G(" Maximum character limit reached. ",-1)])])):V("",!0)]),a("div",Hf,[Fe(Yl,{name:"toast-fade"},{default:Ya(()=>[l.value?(b(),k("span",Bf,[i[89]||(i[89]=a("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a("polyline",{points:"22 4 12 14.01 9 11.01"})],-1)),G(" "+S(l.value),1)])):V("",!0)]),_:1})])]),Q.value?(b(),k("div",{key:1,class:"ucas-feedback-overlay",onClick:i[15]||(i[15]=ft(_=>Q.value=!1,["self"]))},[a("div",Vf,[a("div",Kf,[i[91]||(i[91]=a("div",{class:"ucas-feedback-title"},"Feedback",-1)),a("button",{class:"ucas-btn-close",type:"button",onClick:i[13]||(i[13]=_=>Q.value=!1),"aria-label":"Close feedback"},[...i[90]||(i[90]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),a("div",Gf,[U.value?(b(),k("div",Yf,[...i[92]||(i[92]=[a("span",{class:"ucas-spinner"},null,-1),G(" Generating feedback ",-1)])])):ke.value?(b(),k("div",Wf,S(ke.value),1)):(b(),k("div",zf,S(ie.value||"No feedback available yet."),1))]),a("div",Jf,[a("button",{class:"ucas-btn ucas-btn-outline",type:"button",onClick:i[14]||(i[14]=_=>$o(!0)),disabled:U.value}," Regenerate ",8,Xf),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:Hr,disabled:U.value||K.value||!ie.value,title:ie.value?"Add this feedback into Tutor comments as Virtual Tutor":"Generate feedback first"},S(K.value?"Adding":"Add as a comment"),9,Qf)])])])):V("",!0),Tn.value?(b(),k("div",{key:2,class:"ucas-expand-overlay",onClick:ft(On,["self"])},[a("div",Zf,[a("div",ev,[a("div",tv,S(Or.value),1),a("div",sv,[a("span",nv,S(Pr.value.toLocaleString())+" in this section",1),a("span",ov,S(Ne.value.toLocaleString())+"/"+S(nt.toLocaleString())+" total",1)]),a("button",{class:"ucas-btn-close",type:"button",onClick:On,"aria-label":"Close expanded writing"},[...i[93]||(i[93]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),a("div",av,[At.value==="preview"?(b(),k("div",rv,S(In.value||"Your combined statement will appear here as you type"),1)):(b(),k("textarea",{key:1,ref_key:"expandedTextareaEl",ref:Hs,class:"ucas-textarea ucas-textarea-expanded",disabled:!e.canEdit,value:In.value,onInput:i[16]||(i[16]=_=>Vs(At.value,_.target.value))},null,40,iv))]),a("div",{class:"ucas-expand-footer"},[i[94]||(i[94]=a("div",{class:"ucas-expand-hint"}," Tip: write freely here, then close to see the full page again. ",-1)),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:On},"Done")])])])):V("",!0),X.value?(b(),k("div",{key:3,class:"ucas-expand-overlay",onClick:ft(De,["self"])},[a("div",lv,[a("div",cv,[a("div",uv,S(ge.value),1),a("div",dv,[a("span",fv,S(He.value.toLocaleString())+" characters",1)]),a("button",{class:"ucas-btn-close",type:"button",onClick:De,"aria-label":"Close expanded writing"},[...i[95]||(i[95]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),a("div",vv,[a("textarea",{ref_key:"refExpandedTextareaEl",ref:he,class:"ucas-textarea ucas-textarea-expanded",disabled:!y.value,value:qe.value,onInput:i[17]||(i[17]=_=>{re.value==="staff2"?g.value=_.target.value:C.value=_.target.value})},null,40,pv)]),a("div",{class:"ucas-expand-footer"},[i[96]||(i[96]=a("div",{class:"ucas-expand-hint"}," Tip: write freely here, then close to return to the reference panel. ",-1)),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:De},"Done")])])])):V("",!0),I.value?(b(),k("div",{key:4,class:"ucas-feedback-overlay",onClick:i[32]||(i[32]=ft(_=>I.value=!1,["self"]))},[a("div",mv,[a("div",hv,[a("div",gv,[a("div",yv,[(b(),k("svg",bv,[e.canEdit?(b(),k("path",_v)):V("",!0),e.canEdit?(b(),k("circle",wv)):V("",!0),e.canEdit?(b(),k("path",kv)):V("",!0),e.canEdit?(b(),k("path",Sv)):(b(),k("path",Cv)),e.canEdit?V("",!0):(b(),k("polyline",xv)),e.canEdit?V("",!0):(b(),k("line",Ev)),e.canEdit?V("",!0):(b(),k("line",Av)),e.canEdit?V("",!0):(b(),k("line",$v))]))]),a("div",Tv,[i[97]||(i[97]=a("div",{class:"ucas-ref-title"},"Teacher reference",-1)),a("div",Iv,[e.canEdit?(b(),k("span",Ov,"Invite teachers to contribute to your UCAS reference")):(b(),k("span",Pv,"View and add contributions (Sections 2 & 3)"))])])]),a("button",{class:"ucas-ref-close",type:"button",onClick:i[18]||(i[18]=_=>I.value=!1),"aria-label":"Close"},[...i[98]||(i[98]=[a("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[a("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),a("line",{x1:"6",y1:"6",x2:"18",y2:"18"})],-1)])])]),a("div",Fv,[a("div",Uv,[i[101]||(i[101]=a("span",{class:"ucas-ref-status-label"},"Reference status",-1)),a("span",{class:ne(["ucas-ref-status-pill",`ucas-ref-status--${be.value}`])},[be.value==="completed"||be.value==="finalised"?(b(),k("svg",Mv,[...i[99]||(i[99]=[a("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,-1),a("polyline",{points:"22 4 12 14.01 9 11.01"},null,-1)])])):(b(),k("svg",Nv,[...i[100]||(i[100]=[a("circle",{cx:"12",cy:"12",r:"10"},null,-1),a("polyline",{points:"12 6 12 12 16 14"},null,-1)])])),G(" "+S(v.value),1)],2),h.value.total?(b(),k("span",Rv,S(h.value.submitted)+"/"+S(h.value.total)+" submitted",1)):(b(),k("span",Lv,"No invites yet"))]),a("button",{class:"ucas-ref-refresh",type:"button",onClick:Be,disabled:Me.value},[i[102]||(i[102]=it('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8" data-v-c84f3a74></path><path d="M21 3v5h-5" data-v-c84f3a74></path><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16" data-v-c84f3a74></path><path d="M3 21v-5h5" data-v-c84f3a74></path></svg>',1)),G(" "+S(Me.value?"Refreshing":"Refresh"),1)],8,jv)]),a("div",qv,[e.canEdit?(b(),k("div",Dv,[a("div",Hv,[a("div",Bv,[a("div",{class:ne(["ucas-ref-step-circle",{complete:h.value.total>0}])},[h.value.total>0?(b(),k("svg",Vv,[...i[103]||(i[103]=[a("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(b(),k("span",Kv,"1"))],2),i[104]||(i[104]=a("div",{class:"ucas-ref-step-label"},"Invite teachers",-1))]),a("div",Gv,[a("div",{class:ne(["ucas-ref-step-circle",{active:h.value.total>0&&h.value.submitted<h.value.total,complete:h.value.total>0&&h.value.submitted===h.value.total}])},[...i[105]||(i[105]=[a("span",null,"2",-1)])],2),a("div",{class:ne(["ucas-ref-step-label",{active:h.value.total>0&&h.value.submitted<h.value.total}])},"Awaiting responses",2)]),a("div",Yv,[a("div",{class:ne(["ucas-ref-step-circle",{complete:be.value==="completed"||be.value==="finalised"}])},[be.value==="completed"||be.value==="finalised"?(b(),k("svg",Wv,[...i[106]||(i[106]=[a("polyline",{points:"20 6 9 17 4 12"},null,-1)])])):(b(),k("span",zv,"3"))],2),i[107]||(i[107]=a("div",{class:"ucas-ref-step-label"},"Reference complete",-1))])]),a("div",Jv,[a("div",Xv,[i[108]||(i[108]=a("div",null,[a("div",{class:"ucas-ref-section-title"},"Invited teachers"),a("div",{class:"ucas-ref-section-subtitle"},"Track who has been asked to contribute")],-1)),a("div",Qv,S((p.value||[]).length)+" invited",1)]),p.value.length===0?(b(),k("div",Zv,[...i[109]||(i[109]=[it('<div class="ucas-ref-empty-icon" aria-hidden="true" data-v-c84f3a74><svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" data-v-c84f3a74><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" data-v-c84f3a74></path></svg></div><div data-v-c84f3a74><div class="ucas-ref-empty-title" data-v-c84f3a74>No invitations yet</div><div class="ucas-ref-empty-text" data-v-c84f3a74>Invite a teacher below to get started.</div></div>',2)])])):(b(),k("div",ep,[(b(!0),k(oe,null,Pe(p.value,_=>(b(),k("div",{key:_.id,class:ne(["ucas-ref-invite",{submitted:_.status==="submitted"}])},[a("div",tp,[a("div",{class:ne(["ucas-ref-invite-avatar",Ue(_.teacherEmail)])},S(Ce(_.teacherName||_.teacherEmail)),3),a("div",sp,[a("div",np,S(_.teacherName||_.teacherEmail),1),a("div",op,S(_.subjectKey||"No subject"),1)])]),a("div",ap,[a("button",{class:"ucas-ref-invite-action",type:"button",onClick:R=>hs(_),disabled:L.value}," Reinvite ",8,rp),a("button",{class:"ucas-ref-invite-action ucas-ref-invite-action--danger",type:"button",onClick:R=>Z(_)}," Remove ",8,ip)]),a("div",{class:ne(["ucas-ref-invite-status",_.status==="submitted"?"ok":"wait"])},[_.status==="submitted"?(b(),k("svg",lp,[...i[110]||(i[110]=[a("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,-1),a("polyline",{points:"22 4 12 14.01 9 11.01"},null,-1)])])):(b(),k("svg",cp,[...i[111]||(i[111]=[a("circle",{cx:"12",cy:"12",r:"10"},null,-1),a("polyline",{points:"12 6 12 12 16 14"},null,-1)])])),G(" "+S(_.status==="submitted"?"Submitted":"Pending"),1)],2)],2))),128))])),_e.value.size?(b(),k("div",up,[a("span",dp,S(_e.value.size)+" removed from list",1),a("button",{class:"ucas-btn ucas-btn-ghost",type:"button",onClick:Te},"Restore")])):V("",!0)]),a("div",fp,[i[118]||(i[118]=it('<div class="ucas-ref-form-title" data-v-c84f3a74><svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-c84f3a74><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" data-v-c84f3a74></path><circle cx="9" cy="7" r="4" data-v-c84f3a74></circle><line x1="19" y1="8" x2="19" y2="14" data-v-c84f3a74></line><line x1="22" y1="11" x2="16" y2="11" data-v-c84f3a74></line></svg> Invite another teacher </div>',1)),a("div",vp,[a("div",null,[i[112]||(i[112]=a("div",{class:"ucas-ref-label"},"Teacher email",-1)),Le(a("input",{class:"ucas-ref-input",type:"email","onUpdate:modelValue":i[19]||(i[19]=_=>Ve.value=_),placeholder:"teacher@school.org"},null,512),[[Mt,Ve.value]])]),a("div",null,[i[114]||(i[114]=a("div",{class:"ucas-ref-label"},"Subject (optional)",-1)),Le(a("select",{class:"ucas-ref-select","onUpdate:modelValue":i[20]||(i[20]=_=>Je.value=_)},[i[113]||(i[113]=a("option",{value:""},"No subject",-1)),(b(!0),k(oe,null,Pe($t.value,_=>(b(),k("option",{key:_.key,value:_.label},S(_.label),9,pp))),128))],512),[[St,Je.value]])])]),a("div",mp,[a("button",{class:"ucas-btn ucas-btn-outline",type:"button",onClick:i[21]||(i[21]=_=>{Ve.value="",Je.value=""}),disabled:L.value}," Clear ",8,hp),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:at,disabled:L.value||!Ve.value.trim()},[L.value?V("",!0):(b(),k("svg",yp,[...i[115]||(i[115]=[a("path",{d:"m22 2-7 20-4-9-9-4 20-7z"},null,-1),a("path",{d:"M22 2 11 13"},null,-1)])])),G(" "+S(L.value?"Sending":"Send invitation"),1)],8,gp)]),M.value?(b(),k("div",bp,[i[116]||(i[116]=a("div",{class:"ucas-ref-linkcopy-label"},"Or copy invite link",-1)),a("div",_p,[a("input",{class:"ucas-ref-linkcopy-input",type:"text",value:M.value,readonly:""},null,8,wp),a("button",{class:"ucas-ref-linkcopy-btn",type:"button",onClick:i[22]||(i[22]=_=>Ds(M.value))},"Copy")]),i[117]||(i[117]=a("div",{class:"ucas-ref-linkcopy-hint"},"Share this link directly with your teacher if email doesn't arrive.",-1))])):V("",!0)])])):(b(),k("div",kp,[a("div",Sp,[i[119]||(i[119]=a("div",{class:"ucas-ref-staff-title"},"Reference (staff view)",-1)),m.value&&m.value.updatedAt?(b(),k("div",Cp,"Updated "+S(new Date(m.value.updatedAt).toLocaleString()),1)):V("",!0)]),P.value?(b(),k("div",xp,[...i[120]||(i[120]=[a("span",null,"Loading reference",-1)])])):m.value?(b(),k("div",Ap,[a("div",$p,[a("div",Tp,[i[122]||(i[122]=a("div",{class:"ucas-ref-contrib-title"},[a("span",{class:"ucas-ref-num"},"3"),G(" Subject teacher contributions ")],-1)),a("span",Ip,S((m.value.section3||[]).length)+" contributions",1)]),i[126]||(i[126]=a("div",{class:"ucas-ref-contrib-sub"},"Add specific evidence of academic potential and engagement relevant to the course.",-1)),a("div",Op,[a("div",Pp,[Le(a("select",{class:"ucas-ref-select","onUpdate:modelValue":i[23]||(i[23]=_=>$.value=_)},[i[123]||(i[123]=a("option",{value:""},"No subject",-1)),(b(!0),k(oe,null,Pe($t.value,_=>(b(),k("option",{key:_.key,value:_.label},S(_.label),9,Fp))),128))],512),[[St,$.value]])]),Le(a("textarea",{class:"ucas-ref-textarea","onUpdate:modelValue":i[24]||(i[24]=_=>C.value=_),placeholder:"Describe the student's ability, achievements, and potential in your subject"},null,512),[[Mt,C.value]]),a("div",Up,[a("span",Mp,S((C.value||"").length.toLocaleString())+" characters",1),a("button",{class:"ucas-btn ucas-btn-outline",type:"button",onClick:i[25]||(i[25]=_=>Ye("staff3")),disabled:!y.value}," Expand ",8,Np),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:i[26]||(i[26]=_=>ms(3)),disabled:N.value||!y.value||!C.value.trim()},[N.value?V("",!0):(b(),k("svg",Lp,[...i[124]||(i[124]=[a("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},null,-1),a("polyline",{points:"17 21 17 13 7 13 7 21"},null,-1),a("polyline",{points:"7 3 7 8 15 8"},null,-1)])])),G(" "+S(N.value?"Saving":"Save Section 3"),1)],8,Rp)]),y.value?V("",!0):(b(),k("div",jp,"Saving is unavailable because your staff email is missing in this embedded context."))]),(m.value.section3||[]).length?(b(),k("div",qp,[i[125]||(i[125]=a("div",{class:"ucas-ref-existing-title"},"Existing contributions",-1)),a("div",Dp,[(b(!0),k(oe,null,Pe(m.value.section3,_=>(b(),k("div",{key:_.id,class:"ucas-ref-existing-item"},[a("div",Hp,[a("div",Bp,[a("div",Vp,S(Ce(_.authorName||_.authorEmail)),1),a("span",Kp,S(_.authorName||_.authorEmail),1)]),a("span",Gp,S(_.subjectKey||""),1)]),a("div",Yp,S(_.text),1)]))),128))])])):V("",!0)]),a("div",Wp,[a("button",{class:"ucas-ref-accordion-head",type:"button",onClick:i[27]||(i[27]=_=>H.value=!H.value)},[i[128]||(i[128]=a("div",{class:"ucas-ref-contrib-title"},[a("span",{class:"ucas-ref-num"},"2"),G(" Extenuating circumstances ")],-1)),a("div",zp,[i[127]||(i[127]=a("span",{class:"ucas-ref-badge"},"Optional",-1)),a("span",Jp,S(H.value?"":""),1)])]),H.value?(b(),k("div",Xp,[i[130]||(i[130]=a("div",{class:"ucas-ref-contrib-sub"},"Add factual, course-relevant context (with student permission).",-1)),a("div",Qp,[Le(a("textarea",{class:"ucas-ref-textarea","onUpdate:modelValue":i[28]||(i[28]=_=>g.value=_),placeholder:"Add any relevant extenuating circumstances here"},null,512),[[Mt,g.value]]),a("div",Zp,[a("span",em,S((g.value||"").length.toLocaleString())+" characters",1),a("button",{class:"ucas-btn ucas-btn-outline",type:"button",onClick:i[29]||(i[29]=_=>Ye("staff2")),disabled:!y.value}," Expand ",8,tm),a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:i[30]||(i[30]=_=>ms(2)),disabled:j.value||!y.value||!g.value.trim()},[j.value?V("",!0):(b(),k("svg",nm,[...i[129]||(i[129]=[a("path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},null,-1),a("polyline",{points:"17 21 17 13 7 13 7 21"},null,-1),a("polyline",{points:"7 3 7 8 15 8"},null,-1)])])),G(" "+S(j.value?"Saving":"Save Section 2"),1)],8,sm)]),y.value?V("",!0):(b(),k("div",om,"Saving is unavailable because your staff email is missing in this embedded context."))])])):V("",!0)]),a("div",am,[i[131]||(i[131]=a("div",{class:"ucas-ref-section-head"},[a("div",null,[a("div",{class:"ucas-ref-section-title"},"Section 1  Centre statement"),a("div",{class:"ucas-ref-section-subtitle"},"Standard centre template (usually written once)")])],-1)),a("div",rm,S(f(m.value.section1Text)||"No centre template yet."),1)]),a("div",im,[a("div",lm,[i[132]||(i[132]=a("div",null,[a("div",{class:"ucas-ref-section-title"},"Section 2  Extenuating circumstances"),a("div",{class:"ucas-ref-section-subtitle"},"Existing contributions")],-1)),a("div",cm,S((m.value.section2||[]).length),1)]),(m.value.section2||[]).length===0?(b(),k("div",um,[...i[133]||(i[133]=[a("span",null,"No contributions yet.",-1)])])):(b(),k("div",dm,[(b(!0),k(oe,null,Pe(m.value.section2,_=>(b(),k("div",{key:_.id,class:"ucas-ref-contrib-item"},[a("div",fm,[G(S(_.authorName||_.authorEmail)+" ",1),_.subjectKey?(b(),k("span",vm," "+S(_.subjectKey),1)):V("",!0)]),a("div",pm,S(_.text),1)]))),128))]))]),a("div",mm,[a("div",hm,[i[134]||(i[134]=a("div",null,[a("div",{class:"ucas-ref-section-title"},"Invited teachers"),a("div",{class:"ucas-ref-section-subtitle"},"Status of external invites")],-1)),a("div",gm,S((p.value||[]).length),1)]),p.value.length===0?(b(),k("div",ym,[...i[135]||(i[135]=[a("span",null,"No invitations yet.",-1)])])):(b(),k("div",bm,[(b(!0),k(oe,null,Pe(p.value,_=>(b(),k("div",{key:_.id,class:ne(["ucas-ref-invite",{submitted:_.status==="submitted"}])},[a("div",_m,[a("div",{class:ne(["ucas-ref-invite-avatar",Ue(_.teacherEmail)])},S(Ce(_.teacherName||_.teacherEmail)),3),a("div",wm,[a("div",km,S(_.teacherName||_.teacherEmail),1),a("div",Sm,S(_.subjectKey||"No subject"),1)])]),a("div",Cm,[a("button",{class:"ucas-ref-invite-action",type:"button",onClick:R=>hs(_),disabled:L.value}," Reinvite ",8,xm),a("button",{class:"ucas-ref-invite-action ucas-ref-invite-action--danger",type:"button",onClick:R=>Z(_)}," Remove ",8,Em)]),a("div",{class:ne(["ucas-ref-invite-status",_.status==="submitted"?"ok":"wait"])},S(_.status==="submitted"?"Submitted":"Pending"),3)],2))),128))])),_e.value.size?(b(),k("div",Am,[a("span",$m,S(_e.value.size)+" removed from list",1),a("button",{class:"ucas-btn ucas-btn-ghost",type:"button",onClick:Te},"Restore")])):V("",!0)])])):(b(),k("div",Ep,[...i[121]||(i[121]=[a("span",null,"No reference data found.",-1)])]))]))]),a("div",Tm,[a("button",{class:"ucas-btn ucas-btn-primary",type:"button",onClick:i[31]||(i[31]=_=>I.value=!1)},"Done")])])])):V("",!0)],2)],2)}}},Om=ut(Im,[["__scopeId","data-v-c84f3a74"]]),Pm={class:"tutor-ucas-modal"},Fm={class:"tutor-ucas-header"},Um={class:"tutor-ucas-title"},Mm={class:"tutor-ucas-sub"},Nm={class:"tutor-ucas-body"},Rm={key:0,class:"tutor-ucas-loading"},Lm={key:1,class:"tutor-ucas-error"},jm={class:"tutor-ucas-error-msg"},qm={class:"tutor-ucas-pane tutor-ucas-pane--left"},Dm={class:"tutor-ucas-status-row"},Hm={class:"tutor-ucas-status-card"},Bm={class:"detail"},Vm={class:"tutor-ucas-status-card"},Km={class:"detail"},Gm={key:0},Ym={class:"tutor-ucas-status-card"},Wm={class:"detail"},zm={key:0},Jm={class:"tutor-ucas-actions"},Xm=["disabled"],Qm=["disabled"],Zm={class:"tutor-ucas-section"},eh={class:"tutor-ucas-section-head"},th={class:"muted"},sh={key:0,class:"tutor-ucas-empty"},nh={key:1,class:"tutor-ucas-contribs"},oh={class:"tutor-ucas-contrib-group-title"},ah={class:"tutor-ucas-contrib-meta"},rh={class:"name"},ih={class:"muted"},lh={class:"tutor-ucas-contrib-text"},ch={class:"tutor-ucas-contrib-actions"},uh=["onClick"],dh=["onClick"],fh={class:"tutor-ucas-section"},vh={class:"tutor-ucas-section-head"},ph={class:"muted"},mh=["disabled"],hh={class:"tutor-ucas-editor-footer"},gh={key:0,class:"tutor-ucas-inline-error"},yh={class:"tutor-ucas-editor-actions"},bh=["disabled"],_h=["disabled"],wh=["disabled"],kh={key:0,class:"tutor-ucas-app-error"},Sh={key:1,class:"tutor-ucas-app-body"},Ch={__name:"TutorUcasModal",props:{isOpen:{type:Boolean,required:!0},student:{type:Object,default:null},staffEmail:{type:String,default:""},staffName:{type:String,default:""},academicYear:{type:String,default:"current"},autoOpenApplication:{type:Boolean,default:!0}},emits:["close"],setup(e,{emit:t}){const s=e,o=t,n=F(!1),r=F(""),l=F(null),c=F(null),u=F(!1),f=F(!1),d=F(""),w=F(null),A=mt,E=F(s.academicYear||"current"),O=te(()=>{var h;const v=((h=w.value)==null?void 0:h.data)||w.value||{};return v.academic_year||v.academicYear||E.value||"current"}),B=te(()=>{var h;const v=((h=w.value)==null?void 0:h.data)||w.value||{};return Array.isArray(v.subjects)?v.subjects:[]}),ae=te(()=>{var h;const v=((h=w.value)==null?void 0:h.data)||w.value||{};return Array.isArray(v.offers)?v.offers:[]}),q=F(""),Y=F(""),Q=F(!1),U=F(""),K=F(!1),ie=F(!1),ke=F(null),Se=F(null),z=F(null),de=te(()=>{var m,y;const v=((y=(m=l.value)==null?void 0:m.data)==null?void 0:y.answers)||{},h=(v.q1||"").length,I=(v.q2||"").length,P=(v.q3||"").length;return h+I+P}),fe=te(()=>{var P;const v=((P=l.value)==null?void 0:P.data)||{},h=!!v.selectedCourseKey,I=!!(v.requirementsByCourse&&Object.keys(v.requirementsByCourse).length>0);return h||I}),D=te(()=>z.value?"Completed":de.value>=350?"In progress":"Not started"),ve=te(()=>z.value?"pill--ok":de.value>=350?"pill--warn":"pill--muted"),Ce=te(()=>(q.value||"").trim()),Ue=te(()=>Ce.value.length>0),Ae=te(()=>q.value.trim()!==(Y.value||"").trim()),me=te(()=>{var P,m;const v=((m=(P=c.value)==null?void 0:P.data)==null?void 0:m.section3)||[],h=new Map;for(const y of v){const g=(y.subjectKey||"General").trim()||"General",$=h.get(g)||[];$.push(y),h.set(g,$)}const I=[];for(const[y,g]of h.entries())I.push({subjectKey:y,items:[...g].sort(($,C)=>String(C.updatedAt||C.createdAt||"").localeCompare(String($.updatedAt||$.createdAt||"")))});return I.sort((y,g)=>y.subjectKey.localeCompare(g.subjectKey)),I});async function ue(){var v,h,I,P,m,y,g,$,C,j,N;if((v=s.student)!=null&&v.email){n.value=!0,r.value="",U.value="";try{await be();const[H,X]=await Promise.all([Qe.getUcasApplication(s.student.email,E.value),Qe.getReferenceFull(s.student.email,E.value)]);l.value=H,c.value=X,z.value=((I=(h=l.value)==null?void 0:h.data)==null?void 0:I.statement_completed_at)||((m=(P=l.value)==null?void 0:P.data)==null?void 0:m.statementCompletedAt)||null;const re=((g=(y=c.value)==null?void 0:y.data)==null?void 0:g.tutorCompiledSection3)||"";q.value=re,Y.value=re,ke.value=((C=($=c.value)==null?void 0:$.data)==null?void 0:C.tutorCompiledUpdatedAt)||null,Se.value=((N=(j=c.value)==null?void 0:j.data)==null?void 0:N.tutorCompiledCompletedAt)||null}catch(H){r.value=(H==null?void 0:H.message)||"Failed to load"}finally{n.value=!1}}}ct(()=>{var v;return[s.isOpen,(v=s.student)==null?void 0:v.email,s.academicYear]},([v])=>{v&&ue()});function Me(v){const h=(v??"").toString().trim();return!h||h.toLowerCase()==="current"?"current":h}async function be(){var h;const v=Me(s.academicYear);if(!((h=s.student)!=null&&h.email)){E.value=v;return}if(v!=="current"){E.value=v;return}try{const I=await Qe.getAcademicProfile(s.student.email,"current"),P=(I==null?void 0:I.data)||I||{},m=Me(P.academic_year||P.academicYear||v);E.value=m||v}catch{E.value=v}}function Re(){Ae.value&&!confirm("You have unsaved changes. Close without saving?")||o("close")}async function _e(){var v;if((v=s.student)!=null&&v.email){U.value="",Q.value=!0;try{await Qe.saveTutorCompiled(s.student.email,{academicYear:s.academicYear,staffEmail:s.staffEmail,staffName:s.staffName,text:q.value}),await ue()}catch(h){U.value=(h==null?void 0:h.message)||"Failed to save"}finally{Q.value=!1}}}async function Ve(){var v;if((v=s.student)!=null&&v.email&&Ue.value&&confirm("Mark this tutor reference as READY for UCAS?")){K.value=!0,U.value="";try{Ae.value&&await Qe.saveTutorCompiled(s.student.email,{academicYear:s.academicYear,staffEmail:s.staffEmail,staffName:s.staffName,text:q.value}),await Qe.markTutorCompiledComplete(s.student.email,{academicYear:s.academicYear,staffEmail:s.staffEmail,staffName:s.staffName}),await ue()}catch(h){U.value=(h==null?void 0:h.message)||"Failed to mark complete"}finally{K.value=!1}}}async function Je(){var v;if((v=s.student)!=null&&v.email&&confirm("Send back to tutor (unmark complete)?")){K.value=!0,U.value="";try{await Qe.unmarkTutorCompiledComplete(s.student.email,{academicYear:s.academicYear,staffEmail:s.staffEmail,staffName:s.staffName}),await ue()}catch(h){U.value=(h==null?void 0:h.message)||"Failed to unmark complete"}finally{K.value=!1}}}function L(v){const h=((v==null?void 0:v.text)||"").trim();if(!h)return;const I=q.value||"",P=I.trim().length?`

`:"";q.value=`${I}${P}${h}`.trimStart()}async function M(v){try{await navigator.clipboard.writeText(v||"")}catch{}}async function W(){var h;const v=String(((h=s.student)==null?void 0:h.email)||"").trim();if(v){d.value="",f.value=!0;try{await be();const I=await Qe.getAcademicProfile(v,E.value);w.value=I,u.value=!0}catch(I){d.value=(I==null?void 0:I.message)||"Failed to open UCAS application",r.value=d.value}finally{f.value=!1}}}async function le(){if(u.value){J();return}await W()}function J(){u.value=!1,w.value=null,d.value=""}async function Z(){var v;if((v=s.student)!=null&&v.email&&confirm("Request further edits to the students personal statement?")){ie.value=!0;try{await Qe.requestUcasStatementEdits(s.student.email,{academicYear:s.academicYear,staffEmail:s.staffEmail,staffName:s.staffName}),await ue()}catch(h){r.value=(h==null?void 0:h.message)||"Failed to request edits"}finally{ie.value=!1}}}function Te(){ue()}function p(v){if(!v)return"";try{const h=new Date(v);return Number.isNaN(h.getTime())?String(v):h.toLocaleString()}catch{return String(v)}}return(v,h)=>{var I,P,m,y,g;return e.isOpen?(b(),k("div",{key:0,class:"tutor-ucas-overlay",onClick:ft(Re,["self"])},[a("div",Pm,[a("div",Fm,[a("div",Um,[a("h3",null,S(((I=e.student)==null?void 0:I.name)||"Student")+"  UCAS",1),a("div",Mm,S(((P=e.student)==null?void 0:P.email)||""),1)]),a("button",{class:"tutor-ucas-close",onClick:Re},"")]),a("div",Nm,[n.value?(b(),k("div",Rm,[...h[1]||(h[1]=[a("div",{class:"spinner"},null,-1),a("div",null,"Loading UCAS data",-1)])])):r.value?(b(),k("div",Lm,[h[2]||(h[2]=a("div",{class:"tutor-ucas-error-title"},"Could not load UCAS data",-1)),a("div",jm,S(r.value),1),a("button",{class:"tutor-ucas-btn",onClick:Te},"Try again")])):(b(),k("div",{key:2,class:ne(["tutor-ucas-split",{"tutor-ucas-split--app-open":u.value}])},[a("div",qm,[a("div",Dm,[a("div",Hm,[h[3]||(h[3]=a("div",{class:"label"},"Application",-1)),a("div",{class:ne(["pill",fe.value?"pill--ok":"pill--muted"])},S(fe.value?"Started":"Not started"),3),a("div",Bm,S(fe.value?"Course / offers started":"No course/offers yet"),1)]),a("div",Vm,[h[4]||(h[4]=a("div",{class:"label"},"Personal statement",-1)),a("div",{class:ne(["pill",ve.value])},S(D.value),3),a("div",Km,[G(S(de.value)+" chars ",1),z.value?(b(),k("span",Gm,"  completed")):V("",!0)])]),a("div",Ym,[h[5]||(h[5]=a("div",{class:"label"},"Tutor reference",-1)),a("div",{class:ne(["pill",Se.value?"pill--ok":Ue.value?"pill--warn":"pill--muted"])},S(Se.value?"Complete":Ue.value?"In progress":"Not started"),3),a("div",Wm,[G(S(Ce.value.length)+" chars ",1),Se.value?(b(),k("span",zm,"  marked complete")):V("",!0)])])]),a("div",Jm,[a("button",{class:"tutor-ucas-btn tutor-ucas-btn--primary",disabled:f.value,onClick:le},S(u.value?"Back to tutor reference":f.value?"Opening":"View student application"),9,Xm),a("button",{class:"tutor-ucas-btn",disabled:ie.value,onClick:Z},S(ie.value?"Requesting":"Request edits (statement)"),9,Qm),h[6]||(h[6]=a("div",{class:"tutor-ucas-actions-spacer"},null,-1)),a("button",{class:"tutor-ucas-btn tutor-ucas-btn--ghost",onClick:Te}," Reload ")]),a("div",Zm,[a("div",eh,[h[7]||(h[7]=a("h4",null,"Incoming subject teacher references",-1)),a("div",th,S((((m=c.value)==null?void 0:m.section3)||[]).length)+" contributions",1)]),(((y=c.value)==null?void 0:y.section3)||[]).length===0?(b(),k("div",sh," No subject teacher contributions yet. ")):(b(),k("div",nh,[(b(!0),k(oe,null,Pe(me.value,$=>(b(),k("div",{key:$.subjectKey,class:"tutor-ucas-contrib-group"},[a("div",oh,S($.subjectKey),1),(b(!0),k(oe,null,Pe($.items,C=>(b(),k("div",{key:C.id,class:"tutor-ucas-contrib"},[a("div",ah,[a("div",rh,S(C.authorName||C.authorEmail||"Teacher"),1),a("div",ih,S(p(C.updatedAt||C.createdAt)),1)]),a("div",lh,S(C.text),1),a("div",ch,[a("button",{class:"tutor-ucas-btn tutor-ucas-btn--sm",onClick:j=>L(C)}," Add to compiled ",8,uh),a("button",{class:"tutor-ucas-btn tutor-ucas-btn--sm tutor-ucas-btn--ghost",onClick:j=>M(C.text)}," Copy ",8,dh)])]))),128))]))),128))]))]),a("div",fh,[a("div",vh,[h[8]||(h[8]=a("h4",null,"Tutor compiled reference (final narrative)",-1)),a("div",ph," Saved: "+S(ke.value?p(ke.value):""),1)]),Le(a("textarea",{"onUpdate:modelValue":h[0]||(h[0]=$=>q.value=$),class:"tutor-ucas-textarea",placeholder:"Build the final tutor narrative here",disabled:Q.value||K.value,rows:"10"},null,8,mh),[[Mt,q.value]]),a("div",hh,[U.value?(b(),k("div",gh,S(U.value),1)):V("",!0),a("div",yh,[a("button",{class:"tutor-ucas-btn",disabled:Q.value||!Ae.value,onClick:_e},S(Q.value?"Saving":"Save draft"),9,bh),Se.value?(b(),k("button",{key:1,class:"tutor-ucas-btn tutor-ucas-btn--danger",disabled:K.value,onClick:Je},S(K.value?"Updating":"Send back (unmark complete)"),9,wh)):(b(),k("button",{key:0,class:"tutor-ucas-btn tutor-ucas-btn--primary",disabled:K.value||!Ue.value,onClick:Ve},S(K.value?"Marking":"Mark ready for UCAS"),9,_h))])])]),h[9]||(h[9]=a("div",{class:"tutor-ucas-footnote"}," Students can see status, not the reference content. Subject teachers submit into Incoming above; tutors collate into the final narrative. ",-1))]),a("div",{class:ne(["tutor-ucas-pane tutor-ucas-pane--right",{"is-open":u.value}])},[a("div",{class:"tutor-ucas-app-head"},[h[10]||(h[10]=a("div",{class:"tutor-ucas-app-title"},"Student UCAS application",-1)),a("button",{class:"tutor-ucas-btn tutor-ucas-btn--sm tutor-ucas-btn--ghost",type:"button",onClick:J}," Close ")]),d.value?(b(),k("div",kh,S(d.value),1)):(b(),k("div",Sh,[u.value?(b(),cn(Om,{key:0,embedded:"",studentEmail:((g=e.student)==null?void 0:g.email)||"",academicYear:O.value,subjects:B.value,offers:ae.value,apiUrl:Dt(A),canEdit:!1,staffEmail:e.staffEmail,onClose:J},null,8,["studentEmail","academicYear","subjects","offers","apiUrl","staffEmail"])):V("",!0)]))],2)],2))])])])):V("",!0)}}},xh=ut(Ch,[["__scopeId","data-v-080e9447"]]),Eh={class:"sp-modal"},Ah={class:"sp-header"},$h={class:"sp-sub"},Th={class:"sp-toolbar"},Ih={class:"sp-tabs"},Oh={class:"sp-body"},Ph={key:0,class:"sp-loading"},Fh={key:1,class:"sp-error"},Uh={key:2,class:"sp-empty"},Mh={key:0,class:"sp-week-wrap"},Nh={class:"sp-week-nav"},Rh=["disabled"],Lh={class:"sp-week-label"},jh=["disabled"],qh={key:0,class:"sp-warning"},Dh={key:1,class:"sp-empty"},Hh={key:2,class:"sp-grid"},Bh={class:"sp-time"},Vh=["onClick"],Kh={class:"sp-cell-label"},Gh={class:"sp-cell-type"},Yh={key:1,class:"sp-list-wrap"},Wh={class:"sp-list-col"},zh={key:0,class:"sp-empty-small"},Jh=["onClick"],Xh={class:"sp-list-col"},Qh={key:0,class:"sp-empty-small"},Zh=["onClick"],e1={class:"sp-session-modal"},t1={class:"sp-comment-block"},s1={key:0,class:"sp-comment-meta"},n1={key:0},o1={key:1},a1={class:"sp-session-actions"},r1=["disabled"],i1={__name:"StudyPlannerStaffModal",props:{isOpen:{type:Boolean,required:!0},student:{type:Object,default:null},staffEmail:{type:String,default:""},staffName:{type:String,default:""}},emits:["close"],setup(e,{emit:t}){const s=e,o=t,n=F(!1),r=F(""),l=F("week"),c=F([]),u=F(null),f=F([]),d=F(null),w=F(""),A=F([]),E=F(""),O=F(!1),B=F(""),ae=F(""),q=F(""),Y=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"],Q=te(()=>{const L=de();for(const M of f.value||[]){const W=z(M.start_time);W&&!L.includes(W)&&L.push(W)}return L.sort(),L}),U=te(()=>{var M;if(!((M=u.value)!=null&&M.id))return 0;const L=c.value.findIndex(W=>W.id===u.value.id);return L>=0?L:0}),K=te(()=>{var M;const L=(M=u.value)==null?void 0:M.week_start_date;return L?D(L):"Current week"}),ie=te(()=>fe(new Date)),ke=te(()=>c.value.filter(L=>L.week_start_date>=ie.value)),Se=te(()=>c.value.filter(L=>L.week_start_date<ie.value));function z(L){return String(L||"").slice(0,5)}function de(){const L=[];for(let M=6;M<=23;M+=1)L.push(`${String(M).padStart(2,"0")}:00`);return L}function fe(L){const M=new Date(L),W=M.getDay()||7;return M.setHours(0,0,0,0),M.setDate(M.getDate()-W+1),M.toISOString().slice(0,10)}function D(L){const M=new Date(`${L}T00:00:00`);if(Number.isNaN(M.getTime()))return String(L||"");const W=new Date(M);W.setDate(M.getDate()+6);const le={day:"numeric",month:"short",year:"numeric"};return`${M.toLocaleDateString("en-GB",le)}  ${W.toLocaleDateString("en-GB",le)}`}function ve(L,M){const W=Y.indexOf(M)+1;return f.value.find(le=>Number(le.day_of_week)===W&&z(le.start_time)===L)||null}function Ce(L){return L&&(A.value||[]).find(M=>M.id===L)||null}function Ue(L){const M=Ce(L==null?void 0:L.sprint_type_id);return(M==null?void 0:M.display_name)||"Session"}function Ae(L){if(!L)return{};const M=Ce(L==null?void 0:L.sprint_type_id),W=String((M==null?void 0:M.color_hex)||"").trim();return W?{borderColor:W,background:`${W}22`}:{}}function me(L){L&&(d.value=L,E.value=String(L.staff_comment||""),B.value=ue(L.staff_comment_updated_at),ae.value=String(L.staff_comment_by_name||""),q.value=String(L.staff_comment_by_email||""))}function ue(L){const M=String(L||"").trim();if(!M)return"";const W=new Date(M);return Number.isNaN(W.getTime())?"":W.toLocaleString("en-GB",{day:"2-digit",month:"short",year:"numeric",hour:"2-digit",minute:"2-digit"})}async function Me(){var L,M;if(!(!((L=d.value)!=null&&L.id)||!((M=s.student)!=null&&M.email))){O.value=!0,r.value="";try{const W=await Qe.saveStudyPlannerSessionComment({sessionId:d.value.id,studentEmail:s.student.email,comment:E.value,staffEmail:s.staffEmail||"",staffName:s.staffName||""}),le=String((W==null?void 0:W.staff_comment)||""),J=String((W==null?void 0:W.staff_comment_updated_at)||""),Z=String((W==null?void 0:W.staff_comment_by_name)||""),Te=String((W==null?void 0:W.staff_comment_by_email)||"");E.value=le,B.value=ue(J),ae.value=Z,q.value=Te;const p=f.value.findIndex(v=>String((v==null?void 0:v.id)||"")===String(d.value.id));p>=0&&(f.value[p]={...f.value[p],staff_comment:le||null,staff_comment_updated_at:J||null,staff_comment_by_name:Z||null,staff_comment_by_email:Te||null},d.value={...f.value[p]})}catch(W){r.value=(W==null?void 0:W.message)||"Failed to save teacher comment"}finally{O.value=!1}}}async function be(L){var M,W;if((M=s.student)!=null&&M.email){n.value=!0,r.value="",w.value="";try{const le=await Qe.getStudyPlannerContext(s.student.email,{planId:L});A.value=Array.isArray(le==null?void 0:le.sprintTypes)?le.sprintTypes:[];const J=Je(le==null?void 0:le.plans);c.value=J;const Z=String(L||"").trim(),Te=String(((W=le==null?void 0:le.activePlan)==null?void 0:W.id)||"").trim();let p=null;Z&&(p=J.find(h=>h.id===Z)||null),!p&&Te&&(p=J.find(h=>h.id===Te)||null),p||(p=J[0]||null),u.value=p;let v=Array.isArray(le==null?void 0:le.sessions)?le.sessions:[];if(p!=null&&p.id&&!Z&&Te&&Te!==p.id){const h=await Qe.getStudyPlannerContext(s.student.email,{planId:p.id}),I=Array.isArray(h==null?void 0:h.sessions)?h.sessions:[];I.length?v=I:(p.session_count||0)>0&&(w.value="Selected week has sessions in plan metadata, but no session rows were returned. This usually means the edge function is still on an older version.")}f.value=v}catch(le){r.value=(le==null?void 0:le.message)||"Failed to load study planner"}finally{n.value=!1}}}async function Re(){var L;await be(((L=u.value)==null?void 0:L.id)||null)}async function _e(){const L=U.value;if(L>=c.value.length-1)return;const M=c.value[L+1];M!=null&&M.id&&await be(M.id)}async function Ve(){const L=U.value;if(L<=0)return;const M=c.value[L-1];M!=null&&M.id&&await be(M.id)}ct(()=>{var L;return[s.isOpen,(L=s.student)==null?void 0:L.email]},async([L,M])=>{!L||!M||(l.value="week",d.value=null,await be(null))});function Je(L){const W=(Array.isArray(L)?L:[]).filter(Z=>String((Z==null?void 0:Z.status)||"").trim().toLowerCase()!=="deleted").map(Z=>({...Z,session_count:Number((Z==null?void 0:Z.session_count)||0)})).filter(Z=>Z.session_count>0).sort((Z,Te)=>Z.week_start_date>Te.week_start_date?-1:Z.week_start_date<Te.week_start_date?1:Number(Te.session_count||0)-Number(Z.session_count||0)),le=new Set,J=[];for(const Z of W){const Te=String(Z.week_start_date||"");!Te||le.has(Te)||(le.add(Te),J.push(Z))}return J}return(L,M)=>{var W,le;return e.isOpen?(b(),k("div",{key:0,class:"sp-overlay",onClick:M[6]||(M[6]=ft(J=>o("close"),["self"]))},[a("div",Eh,[a("div",Ah,[a("div",null,[a("h3",null,S(((W=e.student)==null?void 0:W.name)||"Student")+"  Study Planner",1),a("div",$h,S(((le=e.student)==null?void 0:le.email)||""),1)]),a("button",{class:"sp-close",onClick:M[0]||(M[0]=J=>o("close"))},"")]),a("div",Th,[a("div",Ih,[a("button",{class:ne(["sp-tab",{active:l.value==="week"}]),onClick:M[1]||(M[1]=J=>l.value="week")},"Week",2),a("button",{class:ne(["sp-tab",{active:l.value==="list"}]),onClick:M[2]||(M[2]=J=>l.value="list")},"List",2)]),a("div",{class:"sp-actions"},[a("button",{class:"sp-btn",onClick:Re},"Reload")])]),a("div",Oh,[n.value?(b(),k("div",Ph,"Loading study planner")):r.value?(b(),k("div",Fh,S(r.value),1)):c.value.length?(b(),k(oe,{key:3},[l.value==="week"?(b(),k("div",Mh,[a("div",Nh,[a("button",{class:"sp-btn",disabled:U.value>=c.value.length-1,onClick:_e}," Prev",8,Rh),a("div",Lh,S(K.value),1),a("button",{class:"sp-btn",disabled:U.value<=0,onClick:Ve},"Next ",8,jh)]),w.value?(b(),k("div",qh,S(w.value),1)):V("",!0),f.value.length?(b(),k("div",Hh,[M[8]||(M[8]=a("div",{class:"sp-grid-head"},null,-1)),(b(),k(oe,null,Pe(Y,J=>a("div",{key:`h-${J}`,class:"sp-grid-head"},S(J),1)),64)),(b(!0),k(oe,null,Pe(Q.value,J=>(b(),k(oe,{key:`row-${J}`},[a("div",Bh,S(J),1),(b(),k(oe,null,Pe(Y,Z=>a("button",{key:`${J}-${Z}`,class:ne(["sp-cell",{"sp-cell--filled":!!ve(J,Z)}]),style:ht(Ae(ve(J,Z))),onClick:Te=>me(ve(J,Z))},[ve(J,Z)?(b(),k(oe,{key:0},[a("span",Kh,S(ve(J,Z).label||"Session"),1),a("span",Gh,S(Ue(ve(J,Z))),1)],64)):V("",!0)],14,Vh)),64))],64))),128))])):(b(),k("div",Dh,[...M[7]||(M[7]=[G(" No sessions found for this week. ",-1),a("br",null,null,-1),G(" Open the ",-1),a("strong",null,"List",-1),G(" tab and select a different week. ",-1)])]))])):(b(),k("div",Yh,[a("div",Wh,[M[9]||(M[9]=a("h4",null,"Upcoming plans",-1)),ke.value.length===0?(b(),k("div",zh,"No upcoming plans")):V("",!0),(b(!0),k(oe,null,Pe(ke.value,J=>{var Z;return b(),k("button",{key:`u-${J.id}`,class:ne(["sp-plan",{active:J.id===((Z=u.value)==null?void 0:Z.id)}]),onClick:Te=>be(J.id)},[a("div",null,S(D(J.week_start_date)),1),a("small",null,S(J.session_count||0)+" sessions",1)],10,Jh)}),128))]),a("div",Xh,[M[10]||(M[10]=a("h4",null,"Past plans",-1)),Se.value.length===0?(b(),k("div",Qh,"No past plans")):V("",!0),(b(!0),k(oe,null,Pe(Se.value,J=>{var Z;return b(),k("button",{key:`p-${J.id}`,class:ne(["sp-plan",{active:J.id===((Z=u.value)==null?void 0:Z.id)}]),onClick:Te=>be(J.id)},[a("div",null,S(D(J.week_start_date)),1),a("small",null,S(J.session_count||0)+" sessions",1)],10,Zh)}),128))])]))],64)):(b(),k("div",Uh,"No plans found for this student."))])]),d.value?(b(),k("div",{key:0,class:"sp-session-overlay",onClick:M[5]||(M[5]=ft(J=>d.value=null,["self"]))},[a("div",e1,[M[19]||(M[19]=a("h4",null,"Planned session",-1)),a("p",null,[M[11]||(M[11]=a("strong",null,"Day:",-1)),G(" "+S(Y[(d.value.day_of_week||1)-1]),1)]),a("p",null,[M[12]||(M[12]=a("strong",null,"Start:",-1)),G(" "+S(z(d.value.start_time)),1)]),a("p",null,[M[13]||(M[13]=a("strong",null,"Duration:",-1)),G(" "+S(d.value.duration_minutes||0)+" mins",1)]),a("p",null,[M[14]||(M[14]=a("strong",null,"Type:",-1)),G(" "+S(Ue(d.value)),1)]),a("p",null,[M[15]||(M[15]=a("strong",null,"Subject:",-1)),G(" "+S(d.value.subject||"-"),1)]),a("p",null,[M[16]||(M[16]=a("strong",null,"Topic:",-1)),G(" "+S(d.value.topic||"-"),1)]),a("p",null,[M[17]||(M[17]=a("strong",null,"Notes:",-1)),G(" "+S(d.value.notes||"-"),1)]),a("div",t1,[M[18]||(M[18]=a("label",{class:"sp-comment-label"},"Teacher intervention comment",-1)),Le(a("textarea",{"onUpdate:modelValue":M[3]||(M[3]=J=>E.value=J),class:"sp-comment-input",placeholder:"Add optional intervention guidance for this session..."},null,512),[[Mt,E.value]]),B.value?(b(),k("div",s1,[G(" Last updated: "+S(B.value)+" ",1),ae.value?(b(),k("span",n1,"by "+S(ae.value),1)):q.value?(b(),k("span",o1,"by "+S(q.value),1)):V("",!0)])):V("",!0)]),a("div",a1,[a("button",{class:"sp-btn",disabled:O.value,onClick:Me},S(O.value?"Saving":"Save comment"),9,r1),a("button",{class:"sp-btn sp-btn-primary",onClick:M[4]||(M[4]=J=>d.value=null)},"Close")])])])):V("",!0)])):V("",!0)}}},l1=ut(i1,[["__scopeId","data-v-7bae49d9"]]),c1={class:"student-table-container"},u1={class:"table-header"},d1={class:"header-controls"},f1={class:"student-count"},v1={class:"page-size-selector"},p1={key:0,class:"pagination-controls pagination-top"},m1=["disabled"],h1={class:"page-numbers"},g1=["onClick"],y1={key:1,class:"page-ellipsis"},b1=["disabled"],_1={class:"table-wrapper"},w1={class:"student-table"},k1={class:"sort-indicator"},S1={class:"sort-indicator"},C1={class:"sort-indicator"},x1={class:"sort-indicator"},E1={class:"sort-indicator"},A1={class:"sort-indicator"},$1={class:"sort-indicator"},T1={class:"sort-indicator"},I1={class:"student-name"},O1={class:"report-cell"},P1=["onClick"],F1={class:"report-cell"},U1=["onClick","disabled","title"],M1={class:"report-cell"},N1=["onClick","disabled","title"],R1=["onClick","title"],L1={key:0,class:"incomplete"},j1={key:1},q1=["onClick","title"],D1={key:0,class:"incomplete"},H1={key:1},B1=["onClick","title"],V1={key:1,class:"pagination-controls"},K1=["disabled"],G1={class:"page-numbers"},Y1=["onClick"],W1={key:1,class:"page-ellipsis"},z1=["disabled"],J1={key:2,class:"no-results"},X1={__name:"StudentTable",props:{students:{type:Array,required:!0},activeFilters:{type:Object,default:()=>({})},smartFilters:{type:Array,default:()=>[]}},emits:["view-report","data-updated"],setup(e,{emit:t}){const s=e,o=t,n=F("name"),r=F("asc"),l=F(!1),c=F(""),u=F(""),f=F(!1),d=F(""),w=F(""),A=F(null),E=F(!1),O=F(""),B=F(""),ae=F(null),q=F(1),Y=F(50),Q=te(()=>{let m=[...s.students];if(s.activeFilters.group&&(m=m.filter(y=>y.group===s.activeFilters.group)),s.activeFilters.year&&(m=m.filter(y=>y.yearGroup===s.activeFilters.year)),s.activeFilters.status==="completed"?m=m.filter(y=>y.hasCompleted):s.activeFilters.status==="not_completed"&&(m=m.filter(y=>!y.hasCompleted)),s.activeFilters.search){const y=s.activeFilters.search.toLowerCase();m=m.filter(g=>g.name.toLowerCase().includes(y)||g.group&&g.group.toLowerCase().includes(y))}return s.smartFilters&&s.smartFilters.length>0&&(m=m.filter(y=>s.smartFilters.every(g=>{var N;const $=(N=y.scores)==null?void 0:N[g.dimension];if($==null)return!1;const C=parseFloat($),j=parseFloat(g.value);switch(g.operator){case"gt":return C>j;case"gte":return C>=j;case"lt":return C<j;case"lte":return C<=j;case"eq":return Math.abs(C-j)<.01;default:return!0}}))),m}),U=te(()=>{const m=[...Q.value];return m.sort((y,g)=>{var j,N;let $,C;return["vision","effort","systems","practice","attitude","overall"].includes(n.value)?($=(j=y.scores)==null?void 0:j[n.value],C=(N=g.scores)==null?void 0:N[n.value],$==null&&($=-1),C==null&&(C=-1),$=parseFloat($),C=parseFloat(C)):($=y[n.value],C=g[n.value],$==null&&($=""),C==null&&(C=""),typeof $=="string"&&($=$.toLowerCase(),C=C.toLowerCase())),$<C?r.value==="asc"?-1:1:$>C?r.value==="asc"?1:-1:0}),m}),K=te(()=>Math.ceil(Q.value.length/Y.value)),ie=te(()=>{const m=(q.value-1)*Y.value,y=m+Y.value;return U.value.slice(m,y)}),ke=te(()=>{const m=Q.value.length;if(m===0)return"No students";const y=(q.value-1)*Y.value+1,g=Math.min(q.value*Y.value,m);return`Showing ${y}-${g} of ${m} students`}),Se=te(()=>{const m=K.value,y=q.value,g=[];if(m<=7)for(let $=1;$<=m;$++)g.push($);else{g.push(1),y>3&&g.push("...");const $=Math.max(2,y-1),C=Math.min(m-1,y+1);for(let j=$;j<=C;j++)g.push(j);y<m-2&&g.push("..."),m>1&&g.push(m)}return g});ct(()=>[s.activeFilters,Q.value.length],()=>{q.value=1});const z=m=>{if(m>=1&&m<=K.value){q.value=m;const y=document.querySelector(".student-table-container");y&&y.scrollIntoView({behavior:"smooth",block:"start"})}},de=()=>{q.value=1},fe=m=>{console.log("[Table] Sorting by:",m),n.value===m?r.value=r.value==="asc"?"desc":"asc":(n.value=m,r.value=m.includes("score")||["vision","effort","systems","practice","attitude","overall"].includes(m)?"desc":"asc")},D=m=>n.value!==m?"":r.value==="asc"?"":"",ve=(m,y)=>m?m.length<=y?m:m.substring(0,y)+"...":"-",Ce=m=>m==null?"-":Math.round(parseFloat(m)),Ue=m=>{o("view-report",m)};function Ae(m){const g=((m==null?void 0:m.yearGroup)??(m==null?void 0:m.year)??"").toString().match(/(\d{1,2})/),$=g?parseInt(g[1],10):NaN;return Number.isFinite($)?$:null}function me(m){const y=Ae(m);return!!(m!=null&&m.email)&&y!==null&&y>=12}function ue(m){me(m)&&L(m)}const Me=F(!1),be=F(null),Re=F(!1),_e=F(null),Ve=te(()=>{try{const m=typeof Knack<"u"&&Knack.getUserAttributes?Knack.getUserAttributes():null;return((m==null?void 0:m.email)||"").toString().trim().toLowerCase()}catch{return""}}),Je=te(()=>{try{const m=typeof Knack<"u"&&Knack.getUserAttributes?Knack.getUserAttributes():null;return((m==null?void 0:m.name)||(m==null?void 0:m.full_name)||"").toString().trim()}catch{return""}});function L(m){me(m)&&(be.value={name:(m==null?void 0:m.name)||"",email:(m==null?void 0:m.email)||"",group:(m==null?void 0:m.group)||"",yearGroup:(m==null?void 0:m.yearGroup)||(m==null?void 0:m.year)||""},Me.value=!0)}function M(){Me.value=!1,be.value=null}function W(m){m!=null&&m.email&&(_e.value={name:(m==null?void 0:m.name)||"",email:(m==null?void 0:m.email)||""},Re.value=!0)}function le(){Re.value=!1,_e.value=null}const J=(m,y,g)=>{!g||g.trim()===""||g==="-"||(c.value=`${m} - ${y}`,u.value=g,l.value=!0)},Z=()=>{l.value=!1,c.value="",u.value=""},Te=m=>{A.value=m,d.value=`${m.name} - Edit Action Plan`,w.value=m.goals||"",f.value=!0},p=()=>{f.value=!1,d.value="",w.value="",A.value=null},v=async m=>{if(!A.value)return;const y=A.value.email,g=A.value.id,$=A.value.targetCycle;try{console.log("[StudentTable] Saving goals for:",y,"Knack ID:",g);const C=s.students.find(j=>j.id===g);if(C){const j=C.goals,N=C.hasGoals;C.goals=m,C.hasGoals=!!m.trim(),console.log("[StudentTable]  Optimistic update applied - UI updated instantly");const H=await Qe.saveStudentGoals(y,$,{goalText:m,knackRecordId:g});if(H.knackWritten)console.log("[StudentTable]  Goals saved to BOTH Supabase AND Knack");else throw console.warn("[StudentTable]  Goals saved to Supabase ONLY. Knack error:",H.knackError),C.goals=j,C.hasGoals=N,new Error("Failed to save to Knack: "+H.knackError);console.log("[StudentTable] Goals saved successfully - optimistic update persists in table")}else throw console.error("[StudentTable] Could not find student in array for optimistic update"),new Error("Student not found in table")}catch(C){throw console.error("[StudentTable] Error saving goals:",C),C}},h=m=>{ae.value=m,O.value=`${m.name} - Staff Coaching Comments`,B.value=m.coachingComments||"",E.value=!0},I=()=>{E.value=!1,O.value="",B.value="",ae.value=null},P=async m=>{if(!ae.value)return;const y=ae.value.email,g=ae.value.id,$=ae.value.targetCycle;try{console.log("[StudentTable] Saving coaching comments for:",y,"Knack ID:",g);const C=s.students.find(j=>j.id===g);if(C){const j=C.coachingComments,N=C.hasCoaching;C.coachingComments=m,C.hasCoaching=!!m.trim(),console.log("[StudentTable]  Optimistic update applied - UI updated instantly");const H=await Qe.saveCoachingComments(y,$,{coachingText:m,knackRecordId:g});if(H.knackWritten)console.log("[StudentTable]  Coaching saved to BOTH Supabase AND Knack");else throw console.warn("[StudentTable]  Coaching saved to Supabase ONLY. Knack error:",H.knackError),C.coachingComments=j,C.hasCoaching=N,new Error("Failed to save to Knack: "+H.knackError);console.log("[StudentTable] Coaching comments saved successfully - optimistic update persists in table")}else throw console.error("[StudentTable] Could not find student in array for optimistic update"),new Error("Student not found in table")}catch(C){throw console.error("[StudentTable] Error saving coaching comments:",C),C}};return(m,y)=>(b(),k("div",c1,[a("div",u1,[y[15]||(y[15]=a("h3",null,"Student Overview",-1)),a("div",d1,[a("p",f1,S(ke.value),1),a("div",v1,[y[14]||(y[14]=a("label",{for:"page-size"},"Show:",-1)),Le(a("select",{id:"page-size","onUpdate:modelValue":y[0]||(y[0]=g=>Y.value=g),onChange:de},[...y[13]||(y[13]=[a("option",{value:10},"10",-1),a("option",{value:50},"50",-1),a("option",{value:100},"100",-1),a("option",{value:500},"500",-1)])],544),[[St,Y.value]])])])]),Q.value.length>0?(b(),k("div",p1,[a("button",{onClick:y[1]||(y[1]=g=>z(q.value-1)),disabled:q.value===1,class:"pagination-button"}," Previous ",8,m1),a("div",h1,[(b(!0),k(oe,null,Pe(Se.value,g=>(b(),k(oe,{key:g},[g!=="..."?(b(),k("button",{key:0,onClick:$=>z(g),class:ne(["page-button",{active:g===q.value}])},S(g),11,g1)):(b(),k("span",y1,"..."))],64))),128))]),a("button",{onClick:y[2]||(y[2]=g=>z(q.value+1)),disabled:q.value===K.value,class:"pagination-button"}," Next ",8,b1)])):V("",!0),a("div",_1,[a("table",w1,[a("thead",null,[a("tr",null,[a("th",{onClick:y[3]||(y[3]=g=>fe("name")),class:"sortable"},[y[16]||(y[16]=G(" Student Name ",-1)),a("span",k1,S(D("name")),1)]),a("th",{onClick:y[4]||(y[4]=g=>fe("group")),class:"sortable"},[y[17]||(y[17]=G(" Group ",-1)),a("span",S1,S(D("group")),1)]),y[24]||(y[24]=a("th",{class:"report-col"},"Report",-1)),y[25]||(y[25]=a("th",{class:"ucas-col",title:"UCAS Application (Year 12+)"},"UCAS",-1)),y[26]||(y[26]=a("th",{class:"planner-col",title:"Read-only Study Planner"},"Planner",-1)),a("th",{onClick:y[5]||(y[5]=g=>fe("vision")),class:"score-cell sortable",title:"Vision"},[y[18]||(y[18]=G(" V ",-1)),a("span",C1,S(D("vision")),1)]),a("th",{onClick:y[6]||(y[6]=g=>fe("effort")),class:"score-cell sortable",title:"Effort"},[y[19]||(y[19]=G(" E ",-1)),a("span",x1,S(D("effort")),1)]),a("th",{onClick:y[7]||(y[7]=g=>fe("systems")),class:"score-cell sortable",title:"Systems"},[y[20]||(y[20]=G(" S ",-1)),a("span",E1,S(D("systems")),1)]),a("th",{onClick:y[8]||(y[8]=g=>fe("practice")),class:"score-cell sortable",title:"Practice"},[y[21]||(y[21]=G(" P ",-1)),a("span",A1,S(D("practice")),1)]),a("th",{onClick:y[9]||(y[9]=g=>fe("attitude")),class:"score-cell sortable",title:"Attitude"},[y[22]||(y[22]=G(" A ",-1)),a("span",$1,S(D("attitude")),1)]),a("th",{onClick:y[10]||(y[10]=g=>fe("overall")),class:"score-cell sortable",title:"Overall"},[y[23]||(y[23]=G(" O ",-1)),a("span",T1,S(D("overall")),1)]),y[27]||(y[27]=a("th",null,"Response",-1)),y[28]||(y[28]=a("th",null,"Action Plan",-1)),y[29]||(y[29]=a("th",null,"Staff Comments",-1))])]),a("tbody",null,[(b(!0),k(oe,null,Pe(ie.value,g=>{var $,C,j,N,H,X,re,he,ge,qe,He,Ye;return b(),k("tr",{key:g.id},[a("td",I1,S(g.name),1),a("td",null,S(g.group||"-"),1),a("td",O1,[a("button",{onClick:De=>Ue(g),class:"report-button",title:"View Full Report"},"  ",8,P1)]),a("td",F1,[a("button",{class:"ucas-button",type:"button",onClick:De=>ue(g),disabled:!me(g),title:me(g)?"Open UCAS Application":"UCAS available for Year 12+ only"},"  ",8,U1)]),a("td",M1,[a("button",{class:"planner-button",type:"button",onClick:De=>W(g),disabled:!(g!=null&&g.email),title:g!=null&&g.email?"Open Study Planner":"Student email missing"},"  ",8,N1)]),a("td",{class:"score-cell",style:ht({background:Dt(is)(($=g.scores)==null?void 0:$.vision)})},S(((C=g.scores)==null?void 0:C.vision)||"-"),5),a("td",{class:"score-cell",style:ht({background:Dt(is)((j=g.scores)==null?void 0:j.effort)})},S(((N=g.scores)==null?void 0:N.effort)||"-"),5),a("td",{class:"score-cell",style:ht({background:Dt(is)((H=g.scores)==null?void 0:H.systems)})},S(((X=g.scores)==null?void 0:X.systems)||"-"),5),a("td",{class:"score-cell",style:ht({background:Dt(is)((re=g.scores)==null?void 0:re.practice)})},S(((he=g.scores)==null?void 0:he.practice)||"-"),5),a("td",{class:"score-cell",style:ht({background:Dt(is)((ge=g.scores)==null?void 0:ge.attitude)})},S(((qe=g.scores)==null?void 0:qe.attitude)||"-"),5),a("td",{class:"score-cell overall-cell",style:ht({background:Dt(is)((He=g.scores)==null?void 0:He.overall)})},S(Ce((Ye=g.scores)==null?void 0:Ye.overall)),5),a("td",{class:ne(["text-preview clickable view-only",{"has-content":g.hasResponse,"no-content":!g.hasResponse}]),onClick:De=>J(g.name,"Response",g.response),title:g.hasResponse?"Click to view full response":"No response yet"},[g.hasResponse?(b(),k("span",j1,S(ve(g.response,40)),1)):(b(),k("span",L1,"Incomplete"))],10,R1),a("td",{class:ne(["text-preview clickable editable",{"has-content":g.hasGoals,"no-content":!g.hasGoals}]),onClick:De=>Te(g),title:g.hasGoals?"Click to edit action plan":"No action plan yet - Click to add"},[g.hasGoals?(b(),k("span",H1,S(ve(g.goals,40)),1)):(b(),k("span",D1,"Incomplete"))],10,q1),a("td",{class:ne(["text-preview clickable editable",{"has-content":g.hasCoaching,"no-content-blank":!g.hasCoaching}]),onClick:De=>h(g),title:g.hasCoaching?"Click to edit coaching comments":"No coaching comments - Click to add"},S(ve(g.coachingComments,40)),11,B1)])}),128))])])]),Q.value.length>0?(b(),k("div",V1,[a("button",{onClick:y[11]||(y[11]=g=>z(q.value-1)),disabled:q.value===1,class:"pagination-button"}," Previous ",8,K1),a("div",G1,[(b(!0),k(oe,null,Pe(Se.value,g=>(b(),k(oe,{key:g},[g!=="..."?(b(),k("button",{key:0,onClick:$=>z(g),class:ne(["page-button",{active:g===q.value}])},S(g),11,Y1)):(b(),k("span",W1,"..."))],64))),128))]),a("button",{onClick:y[12]||(y[12]=g=>z(q.value+1)),disabled:q.value===K.value,class:"pagination-button"}," Next ",8,z1)])):V("",!0),Q.value.length===0?(b(),k("div",J1,[...y[30]||(y[30]=[a("p",null,"No students match the current filters.",-1)])])):V("",!0),Fe(vu,{isOpen:l.value,title:c.value,text:u.value,onClose:Z},null,8,["isOpen","title","text"]),Fe(ha,{isOpen:f.value,title:d.value,text:w.value,placeholder:"Enter action plan / study goals here...",onClose:p,onSave:v},null,8,["isOpen","title","text"]),Fe(ha,{isOpen:E.value,title:O.value,text:B.value,placeholder:"Enter coaching comments and observations here...",onClose:I,onSave:P},null,8,["isOpen","title","text"]),Fe(xh,{isOpen:Me.value,student:be.value,staffEmail:Ve.value,staffName:Je.value,academicYear:"current",onClose:M},null,8,["isOpen","student","staffEmail","staffName"]),Fe(l1,{isOpen:Re.value,student:_e.value,staffEmail:Ve.value,staffName:Je.value,onClose:le},null,8,["isOpen","student","staffEmail","staffName"])]))}},Q1=ut(X1,[["__scopeId","data-v-378cbceb"]]),Z1={class:"report-modal-container"},eg={class:"report-modal-header"},tg={class:"report-modal-body"},sg=["src"],ng={class:"iframe-loading"},og={__name:"StudentReportModal",props:{isOpen:{type:Boolean,required:!0},studentEmail:{type:String,default:null},studentName:{type:String,default:"Student"}},emits:["close"],setup(e,{emit:t}){const s=e,o=t,n=F(null),r=F(!0),l=F(null);ct(()=>[s.isOpen,s.studentEmail],([d,w])=>{d&&w?(n.value=`https://vespaacademy.knack.com/vespa-academy#vespa-coaching-report?email=${encodeURIComponent(w)}`,r.value=!0,console.log("[Report Modal] Opening report for:",w)):n.value=null},{immediate:!0});const c=()=>{try{const d=l.value;if(d&&d.contentDocument){const w=d.contentDocument.createElement("style");w.textContent=`
        /* Hide Knack default headers and navigation */
        .knHeader,
        .kn-menu,
        .kn-info,
        .kn-current_user,
        #kn-app-menu,
        .kn-back,
        .breadcrumb-back,
        .header-breadcrumb {
          display: none !important;
        }
        
        /* Adjust body padding to account for hidden header */
        body {
          padding-top: 0 !important;
        }
        
        /* Ensure content starts at top */
        .kn-scene,
        #kn-app-container {
          padding-top: 0 !important;
          margin-top: 0 !important;
        }
      `,d.contentDocument.head.appendChild(w),console.log("[Report Modal] Hid Knack headers in iframe")}}catch(d){console.log("[Report Modal] Could not hide headers (cross-origin):",d.message)}setTimeout(()=>{r.value=!1,console.log("[Report Modal] Report loaded")},500)},u=()=>{r.value=!0,o("close")},f=d=>{d.key==="Escape"&&s.isOpen&&u()};return ct(()=>s.isOpen,d=>{d?(document.addEventListener("keydown",f),document.body.style.overflow="hidden"):(document.removeEventListener("keydown",f),document.body.style.overflow="")}),(d,w)=>e.isOpen?(b(),k("div",{key:0,class:"report-modal-overlay",onClick:ft(u,["self"])},[a("div",Z1,[a("div",eg,[a("h2",null,S(e.studentName)+" - VESPA Report",1),a("button",{class:"close-button",onClick:u},[...w[0]||(w[0]=[a("span",{class:"close-icon"},"",-1)])])]),a("div",tg,[n.value?(b(),k("iframe",{key:0,ref_key:"reportIframe",ref:l,src:n.value,class:"report-iframe",onLoad:c,frameborder:"0",allowfullscreen:""},null,40,sg)):V("",!0),Le(a("div",ng,[...w[1]||(w[1]=[a("div",{class:"spinner"},null,-1),a("p",null,"Loading report...",-1)])],512),[[Tr,r.value]])])])])):V("",!0)}},ag=ut(og,[["__scopeId","data-v-9df7cb70"]]),rg=["object_5","object_7","object_18","object_78"],ig=["tutor","staff","admin","head","teacher","subject"],Ir=e=>Array.isArray(e)?e.flatMap(t=>{if(!t)return[];if(typeof t=="string")return[t];const s=[];return t.identifier&&s.push(t.identifier),t.id&&s.push(t.id),t.key&&s.push(t.key),t.name&&s.push(t.name),s}).map(t=>String(t).trim().toLowerCase()).filter(Boolean):[],lg=e=>{const t=Ir(e),s=rg.map(o=>o.toLowerCase());return t.some(o=>s.includes(o))||t.some(o=>ig.some(n=>o.includes(n)))},cg={getUser(){try{if(typeof Knack>"u"||!Knack.getUserAttributes)return console.warn("[Knack Auth] Knack not available"),null;const e=Knack.getUserAttributes(),t=Knack.getUserRoles?Knack.getUserRoles():[];if(!e||!e.email)return console.warn("[Knack Auth] No user logged in"),null;const s=lg(t),o=Ir(t);return{email:e.email,name:e.name||e.full_name||"",roles:t,roleTokens:o,isStaff:s,attributes:e}}catch(e){return console.error("[Knack Auth] Error getting user:",e),null}},isStaff(){const e=this.getUser();return e?e.isStaff:!1},getUserEmail(){const e=this.getUser();return e?e.email:null}},ug={id:"staff-overview-app"},dg={key:2,class:"overview-container"},fg={__name:"App",setup(e){const t=F(null),s=F({}),o=F(!0),n=F(null),r=F(null),l=F(!1),c=F(null),u=F(null),f=F({cycle:!1,group:!1,year:!1,status:!1,search:!1}),d=F({}),w=F(null),A=F(!1),E=F([]),O=async(U=1)=>{w.value=U,o.value=!0,n.value=null;try{if(r.value=cg.getUser(),!r.value||!r.value.email)throw new Error("Please log in to view the staff overview");if(!r.value.isStaff)throw new Error("This page is only accessible to staff members");console.log("[Staff Overview] Loading data for:",r.value.email,"cycle filter:",U);const K=await Qe.getStaffOverview(r.value.email,U);if(!K.success)throw new Error(K.error||"Failed to load staff overview");t.value=K,console.log("[Staff Overview] Data loaded successfully:",K),A.value=!0}catch(K){console.error("[Staff Overview] Error loading data:",K),n.value=K.message||"Failed to load overview. Please try again."}finally{o.value=!1}},B=U=>{s.value=U,d.value.cycle=U.cycle||"",U.group&&(d.value.group=U.group),U.year&&(d.value.year=U.year),U.status&&(d.value.status=U.status),U.search&&(d.value.search=U.search),f.value.group&&U.group&&(d.value.group=U.group),f.value.year&&U.year&&(d.value.year=U.year),f.value.status&&U.status&&(d.value.status=U.status),f.value.search&&U.search&&(d.value.search=U.search);const K=U.cycle&&U.cycle!==""?parseInt(U.cycle):null,ie=K!==w.value;ie&&A.value?(console.log("[Staff Overview] Cycle filter changed, re-fetching data for cycle:",K),w.value=K,O(K)):ie&&!A.value?(console.log("[Staff Overview] Initial filter sync, skipping reload"),w.value=K):console.log("[Staff Overview] Filter changed (non-cycle), updating local state only")},ae=U=>{f.value=U,U.group&&s.value.group&&(d.value.group=s.value.group),U.year&&s.value.year&&(d.value.year=s.value.year),U.status&&s.value.status&&(d.value.status=s.value.status),U.search&&s.value.search&&(d.value.search=s.value.search),U.group||delete d.value.group,U.year||delete d.value.year,U.status||delete d.value.status,U.search||delete d.value.search},q=U=>{console.log("[Staff Overview] Opening report modal for:",U.name,U.email),c.value=U.email,u.value=U.name,l.value=!0},Y=()=>{l.value=!1,c.value=null,u.value=null,console.log("[Staff Overview] Refreshing data after report modal closed"),O(w.value)},Q=()=>{console.log("[Staff Overview] Data updated, refreshing from Knack"),O(w.value)};return xn(()=>{O(1)}),(U,K)=>(b(),k("div",ug,[o.value?(b(),cn(kc,{key:0,message:"Loading student data..."})):n.value?(b(),cn(xc,{key:1,message:n.value,onRetry:O},null,8,["message"])):t.value?(b(),k("div",dg,[Fe(Pc,{staffMember:t.value.staffMember,totalStudents:t.value.students.length},null,8,["staffMember","totalStudents"]),Fe(Wc,{filters:t.value.filters,lockedFilters:f.value,preservedValues:d.value,onFilterChanged:B,onLockChanged:ae},null,8,["filters","lockedFilters","preservedValues"]),Fe(iu,{modelValue:E.value,"onUpdate:modelValue":K[0]||(K[0]=ie=>E.value=ie)},null,8,["modelValue"]),Fe(Q1,{students:t.value.students,activeFilters:s.value,smartFilters:E.value,onViewReport:q,onDataUpdated:Q},null,8,["students","activeFilters","smartFilters"])])):V("",!0),Fe(ag,{isOpen:l.value,studentEmail:c.value,studentName:u.value,onClose:Y},null,8,["isOpen","studentEmail","studentName"])]))}},vg=ut(fg,[["__scopeId","data-v-245d25d6"]]);function pg(){console.log("[Staff Overview V2] Initializing...");try{const e=window.STAFF_OVERVIEW_V2_CONFIG||{},t=document.querySelector(e.elementSelector||"#view_3258");if(!t){console.error("[Staff Overview V2] Mount element not found:",e.elementSelector);return}gc(vg).mount(t),console.log("[Staff Overview V2] Successfully initialized!")}catch(e){console.error("[Staff Overview V2] Initialization error:",e)}}typeof window<"u"&&(window.initializeStaffOverviewV2=pg);
